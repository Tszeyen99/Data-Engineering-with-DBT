[0m18:14:39.355814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d8c232e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e89c32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e89c3a90>]}


============================== 18:14:39.361308 | 1ea034e0-e640-44ee-93bc-6c81e1dddc76 ==============================
[0m18:14:39.361308 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:14:39.362091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:14:39.375292 [info ] [MainThread]: dbt version: 1.8.3
[0m18:14:39.375811 [info ] [MainThread]: python version: 3.9.0
[0m18:14:39.376182 [info ] [MainThread]: python path: /Users/tszeyenthen/anaconda3/envs/dbt/bin/python
[0m18:14:39.376538 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m18:14:40.552466 [info ] [MainThread]: Using profiles dir at /Users/tszeyenthen/.dbt
[0m18:14:40.553033 [info ] [MainThread]: Using profiles.yml file at /Users/tszeyenthen/.dbt/profiles.yml
[0m18:14:40.553545 [info ] [MainThread]: Using dbt_project.yml file at /Users/tszeyenthen/dbt-test/dbt_test/dbt_project.yml
[0m18:14:40.554077 [info ] [MainThread]: adapter type: bigquery
[0m18:14:40.554521 [info ] [MainThread]: adapter version: 1.8.2
[0m18:14:40.651159 [info ] [MainThread]: Configuration:
[0m18:14:40.651709 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:14:40.652089 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:14:40.652449 [info ] [MainThread]: Required dependencies:
[0m18:14:40.652870 [debug] [MainThread]: Executing "git --help"
[0m18:14:40.693996 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:14:40.695193 [debug] [MainThread]: STDERR: "b''"
[0m18:14:40.695695 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:14:40.696171 [info ] [MainThread]: Connection:
[0m18:14:40.696688 [info ] [MainThread]:   method: service-account
[0m18:14:40.697046 [info ] [MainThread]:   database: dbt-test-427409
[0m18:14:40.697358 [info ] [MainThread]:   execution_project: dbt-test-427409
[0m18:14:40.697670 [info ] [MainThread]:   schema: dbt-test
[0m18:14:40.698074 [info ] [MainThread]:   location: US
[0m18:14:40.698557 [info ] [MainThread]:   priority: interactive
[0m18:14:40.698924 [info ] [MainThread]:   maximum_bytes_billed: None
[0m18:14:40.699258 [info ] [MainThread]:   impersonate_service_account: None
[0m18:14:40.699588 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m18:14:40.699906 [info ] [MainThread]:   job_retries: 1
[0m18:14:40.700223 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m18:14:40.700530 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m18:14:40.700837 [info ] [MainThread]:   timeout_seconds: 300
[0m18:14:40.701144 [info ] [MainThread]:   client_id: None
[0m18:14:40.701452 [info ] [MainThread]:   token_uri: None
[0m18:14:40.701762 [info ] [MainThread]:   dataproc_region: None
[0m18:14:40.702413 [info ] [MainThread]:   dataproc_cluster_name: None
[0m18:14:40.702888 [info ] [MainThread]:   gcs_bucket: None
[0m18:14:40.703261 [info ] [MainThread]:   dataproc_batch: None
[0m18:14:40.704072 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:14:40.715735 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m18:14:40.718007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:40.721477 [debug] [MainThread]: On debug: select 1 as id
[0m18:14:42.676602 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:d730aee4-a6a6-412b-9314-9cf7f67091ae&page=queryresults
[0m18:14:43.510958 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:14:43.513034 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:14:43.521689 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.2559457, "process_user_time": 3.896216, "process_kernel_time": 0.337556, "process_mem_max_rss": "186793984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:14:43.524783 [debug] [MainThread]: Command `dbt debug` succeeded at 18:14:43.524365 after 4.26 seconds
[0m18:14:43.525983 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:14:43.527117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d8c232e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d84e1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d9a837c0>]}
[0m18:14:43.528278 [debug] [MainThread]: Flushing usage events
[0m18:33:48.898929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e0e132e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c0985d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c09854f0>]}


============================== 18:33:48.904244 | 5e8b5d75-6b60-4f73-aa5b-fcdb20d1222c ==============================
[0m18:33:48.904244 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:33:48.904993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:33:50.207388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e8b5d75-6b60-4f73-aa5b-fcdb20d1222c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c116fc70>]}
[0m18:33:50.264000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e8b5d75-6b60-4f73-aa5b-fcdb20d1222c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e26c8dc0>]}
[0m18:33:50.264681 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:33:50.291373 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:33:50.292555 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:33:50.293153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e8b5d75-6b60-4f73-aa5b-fcdb20d1222c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c1199790>]}
[0m18:33:51.790731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e8b5d75-6b60-4f73-aa5b-fcdb20d1222c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c15fa130>]}
[0m18:33:51.906086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e8b5d75-6b60-4f73-aa5b-fcdb20d1222c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c16970d0>]}
[0m18:33:51.906714 [info ] [MainThread]: Found 2 models, 4 data tests, 471 macros
[0m18:33:51.907138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e8b5d75-6b60-4f73-aa5b-fcdb20d1222c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c1637220>]}
[0m18:33:51.908786 [info ] [MainThread]: 
[0m18:33:51.909526 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:33:51.914497 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m18:33:51.915002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:52.886956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now create_dbt-test-427409_dbt-test)
[0m18:33:52.889266 [debug] [ThreadPool]: Creating schema "database: "dbt-test-427409"
schema: "dbt-test"
"
[0m18:33:52.906609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:52.908825 [debug] [ThreadPool]: On create_dbt-test-427409_dbt-test: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt-test-427409_dbt-test"} */
create schema if not exists `dbt-test-427409`.`dbt-test`
  
[0m18:33:53.726940 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:e89247c9-95f8-4eb3-afb8-d3ca0944fc1b&page=queryresults
[0m18:33:54.090808 [debug] [ThreadPool]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid dataset ID "dbt-test". Dataset IDs must be alphanumeric (plus underscores) and must be at most 1024 characters long.; reason: invalid, message: Invalid dataset ID "dbt-test". Dataset IDs must be alphanumeric (plus underscores) and must be at most 1024 characters long.')
[0m18:33:55.630402 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:0a8b65e0-2277-4c7d-8958-c1e774423152&page=queryresults
[0m18:33:56.029848 [error] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:0a8b65e0-2277-4c7d-8958-c1e774423152&page=queryresults
[0m18:33:56.032061 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
macro create_schema
[0m18:33:56.035210 [debug] [ThreadPool]: BigQuery adapter: Database Error
  Invalid dataset ID "dbt-test". Dataset IDs must be alphanumeric (plus underscores) and must be at most 1024 characters long.
[0m18:33:56.040282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:56.042136 [debug] [MainThread]: Connection 'create_dbt-test-427409_dbt-test' was properly closed.
[0m18:33:56.043152 [info ] [MainThread]: 
[0m18:33:56.044454 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m18:33:56.045845 [error] [MainThread]: Encountered an error:
Database Error
  Invalid dataset ID "dbt-test". Dataset IDs must be alphanumeric (plus underscores) and must be at most 1024 characters long.
[0m18:33:56.051451 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.2431993, "process_user_time": 5.595687, "process_kernel_time": 0.361028, "process_mem_max_rss": "196501504", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:33:56.053293 [debug] [MainThread]: Command `dbt run` failed at 18:33:56.053027 after 7.25 seconds
[0m18:33:56.054198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e0e132e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c1637e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c8040130>]}
[0m18:33:56.055021 [debug] [MainThread]: Flushing usage events
[0m18:34:58.484733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f90ea32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f92060f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f70bec310>]}


============================== 18:34:58.490245 | 48542086-aa46-463b-ab41-63e62b9a4ae3 ==============================
[0m18:34:58.490245 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:34:58.491027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:34:58.495264 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |       type: bigquery
    14 |   target: dev
    15 | pwd
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 15, column 1
    could not find expected ':'
      in "<unicode string>", line 16, column 1
  
[0m18:34:58.497570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.050372332, "process_user_time": 2.921849, "process_kernel_time": 0.169903, "process_mem_max_rss": "100409344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:34:58.498588 [debug] [MainThread]: Command `dbt run` failed at 18:34:58.498244 after 0.05 seconds
[0m18:34:58.499050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f90ea32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f70bec790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f70beccd0>]}
[0m18:34:58.499486 [debug] [MainThread]: Flushing usage events
[0m18:37:14.284973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8720d732e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871060ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871060e4f0>]}


============================== 18:37:14.290741 | c142721a-4513-4fb7-94a8-7972e6b819b7 ==============================
[0m18:37:14.290741 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:37:14.291603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:37:15.614805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c142721a-4513-4fb7-94a8-7972e6b819b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8721ec8970>]}
[0m18:37:15.674486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c142721a-4513-4fb7-94a8-7972e6b819b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8722217dc0>]}
[0m18:37:15.675320 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:37:15.709391 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:37:15.830978 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:37:15.831664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c142721a-4513-4fb7-94a8-7972e6b819b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f870091ba90>]}
[0m18:37:17.271692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c142721a-4513-4fb7-94a8-7972e6b819b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f0480130>]}
[0m18:37:17.385592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c142721a-4513-4fb7-94a8-7972e6b819b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f04474f0>]}
[0m18:37:17.386282 [info ] [MainThread]: Found 2 models, 4 data tests, 471 macros
[0m18:37:17.386724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c142721a-4513-4fb7-94a8-7972e6b819b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f0447bb0>]}
[0m18:37:17.388512 [info ] [MainThread]: 
[0m18:37:17.389222 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:37:17.394177 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m18:37:17.394713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:20.322808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now create_dbt-test-427409_dbt_test)
[0m18:37:20.327850 [debug] [ThreadPool]: Creating schema "database: "dbt-test-427409"
schema: "dbt_test"
"
[0m18:37:20.351944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:20.354354 [debug] [ThreadPool]: On create_dbt-test-427409_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt-test-427409_dbt_test"} */
create schema if not exists `dbt-test-427409`.`dbt_test`
  
[0m18:37:22.170953 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:126a58e2-c72c-41aa-83a7-f27e0fa510d9&page=queryresults
[0m18:37:23.359751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt-test-427409_dbt_test, now list_dbt-test-427409_dbt_test)
[0m18:37:23.361296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:24.221689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c142721a-4513-4fb7-94a8-7972e6b819b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8720d61fd0>]}
[0m18:37:24.223897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:24.224994 [info ] [MainThread]: 
[0m18:37:24.234802 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m18:37:24.238055 [info ] [Thread-1  ]: 1 of 2 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m18:37:24.240248 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.my_first_dbt_model)
[0m18:37:24.241506 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m18:37:24.336968 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m18:37:24.338290 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m18:37:24.380281 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m18:37:24.381330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:24.383170 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m18:37:25.439012 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:4ba236c7-3cd8-4c0c-b94e-1cd0cddf7ba8&page=queryresults
[0m18:37:28.217089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c142721a-4513-4fb7-94a8-7972e6b819b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87108f5b50>]}
[0m18:37:28.218371 [info ] [Thread-1  ]: 1 of 2 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.98s]
[0m18:37:28.219214 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m18:37:28.220221 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m18:37:28.220893 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt_test.my_second_dbt_model ....................... [RUN]
[0m18:37:28.221469 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m18:37:28.221904 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m18:37:28.226068 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m18:37:28.227083 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m18:37:28.249941 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m18:37:28.250754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:28.252545 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */


  create or replace view `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1;


[0m18:37:29.238019 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:6c7ac432-c7ab-42b8-ba7c-6710ca9c0d44&page=queryresults
[0m18:37:30.125901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c142721a-4513-4fb7-94a8-7972e6b819b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87235149d0>]}
[0m18:37:30.128257 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dbt_test.my_second_dbt_model .................. [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m18:37:30.129797 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m18:37:30.132295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:30.133099 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m18:37:30.133864 [info ] [MainThread]: 
[0m18:37:30.134858 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.74 seconds (12.74s).
[0m18:37:30.136430 [debug] [MainThread]: Command end result
[0m18:37:30.182621 [info ] [MainThread]: 
[0m18:37:30.183488 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:37:30.183993 [info ] [MainThread]: 
[0m18:37:30.184419 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:37:30.187054 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.989733, "process_user_time": 5.922783, "process_kernel_time": 0.412202, "process_mem_max_rss": "197136384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:37:30.187835 [debug] [MainThread]: Command `dbt run` succeeded at 18:37:30.187672 after 15.99 seconds
[0m18:37:30.188411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8720d732e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8723c007c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87013cc430>]}
[0m18:37:30.188919 [debug] [MainThread]: Flushing usage events
[0m18:40:54.021496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb410ddb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0a46d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0a46400>]}


============================== 18:40:54.029733 | f0a59a55-010f-476c-85a8-b3f44a612af0 ==============================
[0m18:40:54.029733 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:40:54.030917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:40:55.379760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0a59a55-010f-476c-85a8-b3f44a612af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0730c70>]}
[0m18:40:55.436401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0a59a55-010f-476c-85a8-b3f44a612af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f11bca00>]}
[0m18:40:55.437147 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:40:55.467465 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:40:55.584631 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:40:55.585296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0a59a55-010f-476c-85a8-b3f44a612af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e05e33d0>]}
[0m18:40:57.249840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0a59a55-010f-476c-85a8-b3f44a612af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb413678130>]}
[0m18:40:57.370527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0a59a55-010f-476c-85a8-b3f44a612af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41368bd30>]}
[0m18:40:57.371214 [info ] [MainThread]: Found 2 models, 4 data tests, 471 macros
[0m18:40:57.371663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0a59a55-010f-476c-85a8-b3f44a612af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4136c88e0>]}
[0m18:40:57.373735 [info ] [MainThread]: 
[0m18:40:57.374562 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:40:57.379716 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m18:40:57.380225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:58.410479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m18:40:58.412046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:02.643066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0a59a55-010f-476c-85a8-b3f44a612af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e02b2670>]}
[0m18:41:02.645902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:02.647213 [info ] [MainThread]: 
[0m18:41:02.655585 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m18:41:02.657603 [info ] [Thread-1  ]: 1 of 2 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m18:41:02.659555 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.my_first_dbt_model)
[0m18:41:02.660774 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m18:41:02.679374 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m18:41:02.680546 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m18:41:02.779297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:41:03.502839 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m18:41:03.504213 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m18:41:04.099420 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:5f46a871-47a2-491a-a0d1-55780207dcad&page=queryresults
[0m18:41:07.809454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0a59a55-010f-476c-85a8-b3f44a612af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4134678b0>]}
[0m18:41:07.810846 [info ] [Thread-1  ]: 1 of 2 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 5.15s]
[0m18:41:07.812090 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m18:41:07.813410 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m18:41:07.814232 [info ] [Thread-1  ]: 2 of 2 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m18:41:07.815095 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m18:41:07.815720 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m18:41:07.820429 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m18:41:07.822204 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m18:41:07.825886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:41:08.927067 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m18:41:08.929268 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m18:41:09.542167 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:edcf1733-3370-4fd8-a8f3-6641f7fa4079&page=queryresults
[0m18:41:12.397057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0a59a55-010f-476c-85a8-b3f44a612af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb413743460>]}
[0m18:41:12.399225 [info ] [Thread-1  ]: 2 of 2 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.58s]
[0m18:41:12.401064 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m18:41:12.406355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:12.407536 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m18:41:12.408744 [info ] [MainThread]: 
[0m18:41:12.409654 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 15.03 seconds (15.03s).
[0m18:41:12.411776 [debug] [MainThread]: Command end result
[0m18:41:12.519307 [info ] [MainThread]: 
[0m18:41:12.524132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:12.529276 [info ] [MainThread]: 
[0m18:41:12.530480 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:41:12.548098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.639322, "process_user_time": 6.307619, "process_kernel_time": 0.451535, "process_mem_max_rss": "195932160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:41:12.551610 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:12.551279 after 18.64 seconds
[0m18:41:12.552776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb410ddb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41368bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4135bd850>]}
[0m18:41:12.560433 [debug] [MainThread]: Flushing usage events
[0m23:16:03.499413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824924b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824ad1ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824ad1e4f0>]}


============================== 23:16:03.503509 | a93677f4-5515-4d12-821c-9eb95705edee ==============================
[0m23:16:03.503509 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:16:03.504010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:16:04.540442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a93677f4-5515-4d12-821c-9eb95705edee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824ab23550>]}
[0m23:16:04.573268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a93677f4-5515-4d12-821c-9eb95705edee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824acd4280>]}
[0m23:16:04.573696 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:16:04.593197 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:16:04.663355 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:16:04.663783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a93677f4-5515-4d12-821c-9eb95705edee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8249a83a90>]}
[0m23:16:05.505702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a93677f4-5515-4d12-821c-9eb95705edee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81f8b37130>]}
[0m23:16:05.574275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a93677f4-5515-4d12-821c-9eb95705edee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81f8b44100>]}
[0m23:16:05.574653 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:16:05.574915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a93677f4-5515-4d12-821c-9eb95705edee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81f8ab1a90>]}
[0m23:16:05.576016 [info ] [MainThread]: 
[0m23:16:05.576511 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:16:05.579675 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:16:05.580007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:06.554678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:16:06.556480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:16:07.224471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a93677f4-5515-4d12-821c-9eb95705edee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824acd4f40>]}
[0m23:16:07.225664 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:16:07.226243 [info ] [MainThread]: 
[0m23:16:07.230378 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:16:07.231261 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m23:16:07.232031 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:16:07.232611 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:16:07.243447 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:16:07.244807 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:16:07.332696 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:16:07.333344 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:16:07.334506 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from 'bigquery-public-data'.thelook_eccomerce.users
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from 'bigquery-public-data'.thelook_eccomerce.orders
),

customer_orders as (
    select
        user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        cutomers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customers_orders
    on customers.id = customer_order.user_id
)

select * from final
    );
  
[0m23:16:07.983056 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:46345cc0-5ffd-45e9-8d28-5318ea61fccd&page=queryresults
[0m23:16:07.984158 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]")
[0m23:16:08.791688 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:79264b0a-5c06-481d-a1a8-9c79920a86b0&page=queryresults
[0m23:16:08.793948 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:79264b0a-5c06-481d-a1a8-9c79920a86b0&page=queryresults
[0m23:16:08.807239 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:16:08.810408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a93677f4-5515-4d12-821c-9eb95705edee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824c945f70>]}
[0m23:16:08.811594 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dbt_test.customers ....................... [[31mERROR[0m in 1.58s]
[0m23:16:08.812576 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:16:08.813259 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:16:08.814218 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:16:08.815090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:16:08.815702 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:16:08.820520 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:16:08.821509 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:16:08.824878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:16:09.545331 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:16:09.550097 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:16:10.099226 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:f1c05da7-c024-40ba-baa9-475d81fb5a55&page=queryresults
[0m23:16:14.967064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f70b332e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f808ded60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f808de460>]}


============================== 23:16:14.970199 | ecc3a889-b38d-4e11-bbe2-6fcb355b4d43 ==============================
[0m23:16:14.970199 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:16:14.970655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:16:15.609949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecc3a889-b38d-4e11-bbe2-6fcb355b4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f70dc8130>]}
[0m23:16:15.642992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecc3a889-b38d-4e11-bbe2-6fcb355b4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8086c340>]}
[0m23:16:15.643429 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:16:15.660229 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:16:15.754058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:16:15.754378 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:16:15.782663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecc3a889-b38d-4e11-bbe2-6fcb355b4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f73c7ef40>]}
[0m23:16:15.849953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecc3a889-b38d-4e11-bbe2-6fcb355b4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f73ca2760>]}
[0m23:16:15.850318 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:16:15.850585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc3a889-b38d-4e11-bbe2-6fcb355b4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f73c5b610>]}
[0m23:16:15.851688 [info ] [MainThread]: 
[0m23:16:15.852123 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:16:15.855219 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:16:15.855567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:16.485284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:16:16.487029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:16:17.136171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc3a889-b38d-4e11-bbe2-6fcb355b4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f70e2a430>]}
[0m23:16:17.137731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:16:17.138612 [info ] [MainThread]: 
[0m23:16:17.143787 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:16:17.145067 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m23:16:17.146313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:16:17.147012 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:16:17.160999 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:16:17.162044 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:16:17.200760 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:16:17.201345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:16:17.202571 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from 'bigquery-public-data'.thelook_eccomerce.users
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from 'bigquery-public-data'.thelook_eccomerce.orders
),

customer_orders as (
    select
        user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        cutomers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customers_orders
    on customers.id = customer_order.user_id
)

select * from final
    );
  
[0m23:16:17.889982 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:73ab2734-17d4-44b2-b388-1cd5b87faaa0&page=queryresults
[0m23:16:17.892328 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]")
[0m23:16:18.691883 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:d5d7ff27-2739-4a7a-b468-52056f14ad3e&page=queryresults
[0m23:16:18.694257 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:d5d7ff27-2739-4a7a-b468-52056f14ad3e&page=queryresults
[0m23:16:18.708210 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:16:18.710946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc3a889-b38d-4e11-bbe2-6fcb355b4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f81308880>]}
[0m23:16:18.712151 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dbt_test.customers ....................... [[31mERROR[0m in 1.56s]
[0m23:16:18.713159 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:16:18.713826 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:16:18.714680 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:16:18.715459 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:16:18.715976 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:16:18.721517 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:16:18.722549 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:16:18.725599 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:16:19.426519 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:16:19.430343 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:16:20.017666 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:6fcbb6fe-9613-4435-b607-40f782f18eab&page=queryresults
[0m23:16:22.803001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc3a889-b38d-4e11-bbe2-6fcb355b4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f73d81280>]}
[0m23:16:22.803762 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.09s]
[0m23:16:22.804463 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m23:16:22.805300 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m23:16:22.805848 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m23:16:22.806329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m23:16:22.806712 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m23:16:22.810048 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m23:16:22.810750 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m23:16:22.813148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:16:23.463307 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m23:16:23.465475 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m23:16:24.118056 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:c1b45460-f274-4e03-a9c9-81dcc25277e3&page=queryresults
[0m23:16:27.035827 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc3a889-b38d-4e11-bbe2-6fcb355b4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f73d81c10>]}
[0m23:16:27.038288 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.23s]
[0m23:16:27.040696 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m23:16:27.044198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:27.045421 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m23:16:27.046734 [info ] [MainThread]: 
[0m23:16:27.047856 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.19 seconds (11.19s).
[0m23:16:27.051819 [debug] [MainThread]: Command end result
[0m23:16:27.097082 [info ] [MainThread]: 
[0m23:16:27.097600 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:16:27.097917 [info ] [MainThread]: 
[0m23:16:27.098303 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:16:27.098597 [info ] [MainThread]: 
[0m23:16:27.098895 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:16:27.102318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.185538, "process_user_time": 3.347403, "process_kernel_time": 0.238084, "process_mem_max_rss": "196550656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:16:27.102970 [debug] [MainThread]: Command `dbt run` failed at 23:16:27.102879 after 12.19 seconds
[0m23:16:27.103349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f70b332e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f7068f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8086c340>]}
[0m23:16:27.103683 [debug] [MainThread]: Flushing usage events
[0m23:18:03.115363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a8fe32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9888ced30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9888ce430>]}


============================== 23:18:03.118985 | c13168e3-edfa-42a4-87b7-0046fe1e15fb ==============================
[0m23:18:03.118985 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:18:03.119508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:18:03.784046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c13168e3-edfa-42a4-87b7-0046fe1e15fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9888983a0>]}
[0m23:18:03.816417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c13168e3-edfa-42a4-87b7-0046fe1e15fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb98882ecd0>]}
[0m23:18:03.816831 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:18:03.842559 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:18:03.940222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:18:03.940682 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/customers.sql
[0m23:18:04.082237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c13168e3-edfa-42a4-87b7-0046fe1e15fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ac1eb130>]}
[0m23:18:04.149569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c13168e3-edfa-42a4-87b7-0046fe1e15fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ac1f5c40>]}
[0m23:18:04.149941 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:18:04.150208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c13168e3-edfa-42a4-87b7-0046fe1e15fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ac21a070>]}
[0m23:18:04.151308 [info ] [MainThread]: 
[0m23:18:04.151842 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:18:04.154910 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:18:04.155238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:04.802092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:18:04.803375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:05.532057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c13168e3-edfa-42a4-87b7-0046fe1e15fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb989081b50>]}
[0m23:18:05.533960 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:05.535380 [info ] [MainThread]: 
[0m23:18:05.541157 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:18:05.542567 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m23:18:05.543614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:18:05.544356 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:18:05.558057 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:18:05.559136 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:18:05.598454 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:18:05.599079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:18:05.600374 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from 'bigquery-public-data'.thelook_ecommerce.users
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from 'bigquery-public-data'.thelook_ecommerce.orders
),

customer_orders as (
    select
        user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        cutomers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m23:18:06.288301 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:52eda588-e714-4de2-bb98-e4d7d92a910b&page=queryresults
[0m23:18:06.290647 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]")
[0m23:18:07.032292 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:20b172d0-20df-4f7e-a5c2-8df7bd5c8a6e&page=queryresults
[0m23:18:07.034475 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:20b172d0-20df-4f7e-a5c2-8df7bd5c8a6e&page=queryresults
[0m23:18:07.048743 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:18:07.051483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13168e3-edfa-42a4-87b7-0046fe1e15fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ac35a4c0>]}
[0m23:18:07.052679 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dbt_test.customers ....................... [[31mERROR[0m in 1.51s]
[0m23:18:07.053797 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:18:07.054548 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:18:07.055478 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:18:07.056261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:18:07.056833 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:18:07.061635 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:18:07.062499 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:18:07.067911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:18:07.812303 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:18:07.815086 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:18:08.370921 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:de5e11b3-2da0-41da-9d43-8b783b95efb3&page=queryresults
[0m23:18:11.228000 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13168e3-edfa-42a4-87b7-0046fe1e15fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9aba97b50>]}
[0m23:18:11.228653 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.17s]
[0m23:18:11.229223 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m23:18:11.229882 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m23:18:11.230360 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m23:18:11.230830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m23:18:11.231180 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m23:18:11.233856 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m23:18:11.234414 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m23:18:11.236534 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:18:11.912568 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m23:18:11.914116 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m23:18:12.543545 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:86dfa284-a52b-46e1-864c-ea6142db99e2&page=queryresults
[0m23:18:15.322309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13168e3-edfa-42a4-87b7-0046fe1e15fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ac35c850>]}
[0m23:18:15.323633 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.09s]
[0m23:18:15.324313 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m23:18:15.325367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:15.325631 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m23:18:15.326266 [info ] [MainThread]: 
[0m23:18:15.326794 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.17 seconds (11.17s).
[0m23:18:15.327583 [debug] [MainThread]: Command end result
[0m23:18:15.354589 [info ] [MainThread]: 
[0m23:18:15.355020 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:18:15.355332 [info ] [MainThread]: 
[0m23:18:15.355716 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:18:15.355999 [info ] [MainThread]: 
[0m23:18:15.356265 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:18:15.358563 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.296661, "process_user_time": 3.790911, "process_kernel_time": 0.249936, "process_mem_max_rss": "201502720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:18:15.359149 [debug] [MainThread]: Command `dbt run` failed at 23:18:15.359068 after 12.30 seconds
[0m23:18:15.359501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a8fe32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ac1f5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ac1903a0>]}
[0m23:18:15.359810 [debug] [MainThread]: Flushing usage events
[0m23:21:09.929157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7958bfb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79687c6d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79687c6430>]}


============================== 23:21:09.932806 | 2d3198e2-9708-4dee-8b13-97492e58cdec ==============================
[0m23:21:09.932806 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:21:09.933383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:21:10.607884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d3198e2-9708-4dee-8b13-97492e58cdec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79691a4bb0>]}
[0m23:21:10.640655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d3198e2-9708-4dee-8b13-97492e58cdec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79691cd250>]}
[0m23:21:10.641084 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:21:10.665019 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:21:10.760510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:21:10.760956 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/customers.sql
[0m23:21:10.904507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d3198e2-9708-4dee-8b13-97492e58cdec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79694eb130>]}
[0m23:21:10.972769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d3198e2-9708-4dee-8b13-97492e58cdec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79694f73a0>]}
[0m23:21:10.973138 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:21:10.973496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d3198e2-9708-4dee-8b13-97492e58cdec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f796951a0d0>]}
[0m23:21:10.974658 [info ] [MainThread]: 
[0m23:21:10.975096 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:21:10.978135 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:21:10.978441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:11.695520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:21:11.696547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:12.363142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d3198e2-9708-4dee-8b13-97492e58cdec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7958be93a0>]}
[0m23:21:12.365202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:21:12.366143 [info ] [MainThread]: 
[0m23:21:12.372552 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:21:12.374203 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m23:21:12.375310 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:21:12.376100 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:21:12.389830 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:21:12.391279 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:21:12.430321 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:21:12.430937 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:21:12.432247 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from 'bigquery-public-data'.thelook_ecommerce.users
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from 'bigquery-public-data'.thelook_ecommerce.orders
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        cutomers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m23:21:13.100973 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:6fc92fc7-7913-4206-82f4-187e10b05152&page=queryresults
[0m23:21:13.103180 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]")
[0m23:21:14.153253 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:e44f9089-ddab-488c-875b-e1e8299c6053&page=queryresults
[0m23:21:14.155550 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:e44f9089-ddab-488c-875b-e1e8299c6053&page=queryresults
[0m23:21:14.169256 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:21:14.171847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3198e2-9708-4dee-8b13-97492e58cdec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79485f10d0>]}
[0m23:21:14.173015 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dbt_test.customers ....................... [[31mERROR[0m in 1.80s]
[0m23:21:14.174005 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:21:14.174692 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:21:14.175595 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:21:14.176494 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:21:14.177204 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:21:14.181745 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:21:14.182577 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:21:14.185921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:21:14.871383 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:21:14.873674 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:21:15.463987 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:bc9bce0a-9227-42b8-8939-643abd9d1975&page=queryresults
[0m23:21:18.315281 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3198e2-9708-4dee-8b13-97492e58cdec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7968f94250>]}
[0m23:21:18.316473 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.14s]
[0m23:21:18.317237 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m23:21:18.317994 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m23:21:18.318657 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m23:21:18.319149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m23:21:18.319582 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m23:21:18.322730 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m23:21:18.323402 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m23:21:18.326061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:21:19.096520 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m23:21:19.100417 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m23:21:19.820953 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:d852345c-b7ff-4a5a-a4a4-58d2fb398f79&page=queryresults
[0m23:21:22.610529 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3198e2-9708-4dee-8b13-97492e58cdec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79485f31f0>]}
[0m23:21:22.612388 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.29s]
[0m23:21:22.614165 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m23:21:22.616948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:22.617722 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m23:21:22.618772 [info ] [MainThread]: 
[0m23:21:22.619734 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.64 seconds (11.64s).
[0m23:21:22.621646 [debug] [MainThread]: Command end result
[0m23:21:22.661921 [info ] [MainThread]: 
[0m23:21:22.662424 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:21:22.662785 [info ] [MainThread]: 
[0m23:21:22.663172 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:21:22.663463 [info ] [MainThread]: 
[0m23:21:22.663763 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:21:22.666001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.796636, "process_user_time": 3.840791, "process_kernel_time": 0.247057, "process_mem_max_rss": "195383296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:21:22.666583 [debug] [MainThread]: Command `dbt run` failed at 23:21:22.666499 after 12.80 seconds
[0m23:21:22.666967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7958bfb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7959018a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79691a4bb0>]}
[0m23:21:22.667309 [debug] [MainThread]: Flushing usage events
[0m23:24:15.262975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa038c632e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02824dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02824d460>]}


============================== 23:24:15.266621 | b70f3fff-61b6-4588-8198-10d7a77a25cf ==============================
[0m23:24:15.266621 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:24:15.267105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:24:15.934892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b70f3fff-61b6-4588-8198-10d7a77a25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa038f3bf40>]}
[0m23:24:15.967643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b70f3fff-61b6-4588-8198-10d7a77a25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa03a5ac5e0>]}
[0m23:24:15.968074 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:24:15.985886 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:24:16.080455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:24:16.080902 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/customers.sql
[0m23:24:16.222647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b70f3fff-61b6-4588-8198-10d7a77a25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa028ce0eb0>]}
[0m23:24:16.288662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b70f3fff-61b6-4588-8198-10d7a77a25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa028d3ba90>]}
[0m23:24:16.289022 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:24:16.289289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70f3fff-61b6-4588-8198-10d7a77a25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa03c116700>]}
[0m23:24:16.290372 [info ] [MainThread]: 
[0m23:24:16.290841 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:24:16.294036 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:24:16.294364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:17.017279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:24:17.019276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:24:17.662387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70f3fff-61b6-4588-8198-10d7a77a25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa03c155310>]}
[0m23:24:17.664378 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:24:17.665392 [info ] [MainThread]: 
[0m23:24:17.672086 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:24:17.673527 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m23:24:17.674722 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:24:17.675657 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:24:17.689044 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:24:17.690145 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:24:17.729014 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:24:17.729621 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:24:17.730945 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with users as (
    select id,
        first_name,
        last_name
    from 'bigquery-public-data'.thelook_ecommerce.users
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from 'bigquery-public-data'.thelook_ecommerce.orders
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        users.id,
        users.first_name,
        users.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from users
    left join customer_orders
    on users.id = customer_orders.user_id
)

select * from final
    );
  
[0m23:24:18.368338 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:5dd24aff-3638-4ed9-98d9-99bc42f41069&page=queryresults
[0m23:24:18.370727 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]")
[0m23:24:19.263935 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:b5951969-7281-4c5e-b46f-5837bad28c3e&page=queryresults
[0m23:24:19.266048 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:b5951969-7281-4c5e-b46f-5837bad28c3e&page=queryresults
[0m23:24:19.280169 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:24:19.283091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70f3fff-61b6-4588-8198-10d7a77a25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa048811a90>]}
[0m23:24:19.284332 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dbt_test.customers ....................... [[31mERROR[0m in 1.61s]
[0m23:24:19.285344 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:24:19.286024 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:24:19.286968 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:24:19.287857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:24:19.288467 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:24:19.293214 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:24:19.294439 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:24:19.297748 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:24:19.982330 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:24:19.984932 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:24:20.536019 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:2b39947e-e383-4f6a-9128-a515ad9d9e58&page=queryresults
[0m23:24:23.614495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70f3fff-61b6-4588-8198-10d7a77a25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa03b808820>]}
[0m23:24:23.616523 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.33s]
[0m23:24:23.617400 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m23:24:23.618492 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m23:24:23.619098 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m23:24:23.619651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m23:24:23.620077 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m23:24:23.623610 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m23:24:23.624337 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m23:24:23.626987 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:24:24.459512 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m23:24:24.462507 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m23:24:25.022278 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:12539c61-1605-4c8e-b476-e1b6821d5ead&page=queryresults
[0m23:24:28.783067 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70f3fff-61b6-4588-8198-10d7a77a25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa03c2c2ca0>]}
[0m23:24:28.785794 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 5.16s]
[0m23:24:28.787835 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m23:24:28.791746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:24:28.794032 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m23:24:28.795337 [info ] [MainThread]: 
[0m23:24:28.796697 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 12.50 seconds (12.50s).
[0m23:24:28.799097 [debug] [MainThread]: Command end result
[0m23:24:28.845742 [info ] [MainThread]: 
[0m23:24:28.846258 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:24:28.846599 [info ] [MainThread]: 
[0m23:24:28.847007 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:24:28.847322 [info ] [MainThread]: 
[0m23:24:28.847652 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:24:28.850081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.640587, "process_user_time": 3.877676, "process_kernel_time": 0.261979, "process_mem_max_rss": "202199040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:24:28.850623 [debug] [MainThread]: Command `dbt run` failed at 23:24:28.850546 after 13.64 seconds
[0m23:24:28.851000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa038c632e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa03c261df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa038f3bf40>]}
[0m23:24:28.851335 [debug] [MainThread]: Flushing usage events
[0m23:27:12.672413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9040acb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905078dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905078d460>]}


============================== 23:27:12.675865 | 71074515-92b6-4535-8f9e-5571cfc0a9b3 ==============================
[0m23:27:12.675865 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:27:12.676394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:27:13.318123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71074515-92b6-4535-8f9e-5571cfc0a9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9043a8fc40>]}
[0m23:27:13.350780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71074515-92b6-4535-8f9e-5571cfc0a9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9030569ca0>]}
[0m23:27:13.351201 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:27:13.377749 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:27:13.470176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:27:13.470610 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/customers.sql
[0m23:27:13.613625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71074515-92b6-4535-8f9e-5571cfc0a9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9043cbc130>]}
[0m23:27:13.679290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71074515-92b6-4535-8f9e-5571cfc0a9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9043cce370>]}
[0m23:27:13.679647 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:27:13.679918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71074515-92b6-4535-8f9e-5571cfc0a9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9043c07b20>]}
[0m23:27:13.681100 [info ] [MainThread]: 
[0m23:27:13.681574 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:27:13.684713 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:27:13.685036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:14.315978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:27:14.317917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:14.946058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71074515-92b6-4535-8f9e-5571cfc0a9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905121f9d0>]}
[0m23:27:14.947908 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:14.948944 [info ] [MainThread]: 
[0m23:27:14.954987 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:27:14.956462 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m23:27:14.957487 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:27:14.958246 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:27:14.968332 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:27:14.969131 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:27:15.007011 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:27:15.007676 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:15.009127 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from 'bigquery-public-data'.thelook_ecommerce.users
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from 'bigquery-public-data'.thelook_ecommerce.orders
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        cutomers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m23:27:15.651124 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:2a6cb15e-2f3a-4b30-9335-aff10e8b268a&page=queryresults
[0m23:27:15.653316 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]")
[0m23:27:17.010109 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:0e24f192-2826-4d00-bf15-9fca42abddfc&page=queryresults
[0m23:27:17.012215 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:0e24f192-2826-4d00-bf15-9fca42abddfc&page=queryresults
[0m23:27:17.025428 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:27:17.028271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71074515-92b6-4535-8f9e-5571cfc0a9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902063de50>]}
[0m23:27:17.029424 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dbt_test.customers ....................... [[31mERROR[0m in 2.07s]
[0m23:27:17.030380 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:27:17.031066 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:27:17.032011 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:27:17.032881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:27:17.033500 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:27:17.038088 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:27:17.039107 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:27:17.042349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:17.685279 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:27:17.688743 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:27:18.319685 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:42aef356-c319-47dc-93b2-87c3e231e341&page=queryresults
[0m23:27:21.435837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71074515-92b6-4535-8f9e-5571cfc0a9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9051027b50>]}
[0m23:27:21.437870 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.40s]
[0m23:27:21.438745 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m23:27:21.439748 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m23:27:21.440433 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m23:27:21.441110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m23:27:21.441527 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m23:27:21.445025 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m23:27:21.445745 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m23:27:21.448257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:22.105243 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m23:27:22.107586 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m23:27:22.818166 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:0f09d21d-2c27-428c-8cfa-5db41a955d0f&page=queryresults
[0m23:27:25.771410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71074515-92b6-4535-8f9e-5571cfc0a9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905139e910>]}
[0m23:27:25.772600 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.33s]
[0m23:27:25.773532 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m23:27:25.775111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:25.775640 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m23:27:25.776223 [info ] [MainThread]: 
[0m23:27:25.776764 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 12.09 seconds (12.09s).
[0m23:27:25.778186 [debug] [MainThread]: Command end result
[0m23:27:25.810719 [info ] [MainThread]: 
[0m23:27:25.811171 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:27:25.811461 [info ] [MainThread]: 
[0m23:27:25.811813 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:27:25.812086 [info ] [MainThread]: 
[0m23:27:25.812380 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:27:25.815232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.194699, "process_user_time": 3.826562, "process_kernel_time": 0.248338, "process_mem_max_rss": "197378048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:27:25.815760 [debug] [MainThread]: Command `dbt run` failed at 23:27:25.815688 after 13.20 seconds
[0m23:27:25.816094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9040acb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9043a8fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9043c5e430>]}
[0m23:27:25.816425 [debug] [MainThread]: Flushing usage events
[0m23:28:53.935327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7863b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda789812e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda78981be0>]}


============================== 23:28:53.938657 | 29f49047-6ba7-4347-aa4a-97ad5ed82d53 ==============================
[0m23:28:53.938657 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:28:53.939150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:28:54.600011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29f49047-6ba7-4347-aa4a-97ad5ed82d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8a40d130>]}
[0m23:28:54.632593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29f49047-6ba7-4347-aa4a-97ad5ed82d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8a43e670>]}
[0m23:28:54.633016 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:28:54.650514 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:28:54.745589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:28:54.746053 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/customers.sql
[0m23:28:54.889039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29f49047-6ba7-4347-aa4a-97ad5ed82d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8bf6fe50>]}
[0m23:28:54.955151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29f49047-6ba7-4347-aa4a-97ad5ed82d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8bf7bf10>]}
[0m23:28:54.955502 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:28:54.955767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29f49047-6ba7-4347-aa4a-97ad5ed82d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda795c6400>]}
[0m23:28:54.956852 [info ] [MainThread]: 
[0m23:28:54.957279 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:28:54.960281 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:28:54.960594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:55.597815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:28:55.599401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:56.257318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29f49047-6ba7-4347-aa4a-97ad5ed82d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8a48ff40>]}
[0m23:28:56.260236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:28:56.261407 [info ] [MainThread]: 
[0m23:28:56.268271 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:28:56.269412 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m23:28:56.270360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:28:56.271102 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:28:56.283903 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:28:56.284750 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:28:56.323731 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:28:56.324340 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:28:56.325626 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        cutomers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m23:28:56.984050 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:2dfbbf13-8f21-4e46-9d31-296b705cd6bf&page=queryresults
[0m23:28:56.986377 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "customers" at [13:7]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "customers" at [13:7]')
[0m23:28:58.174958 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:811df241-612c-43b6-9df7-639942e14e1c&page=queryresults
[0m23:28:58.177312 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:811df241-612c-43b6-9df7-639942e14e1c&page=queryresults
[0m23:28:58.191077 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected identifier "customers" at [13:7]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:28:58.194350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f49047-6ba7-4347-aa4a-97ad5ed82d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda796826d0>]}
[0m23:28:58.195590 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dbt_test.customers ....................... [[31mERROR[0m in 1.92s]
[0m23:28:58.196598 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:28:58.197315 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:28:58.198221 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:28:58.199004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:28:58.199576 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:28:58.204345 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:28:58.205478 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:28:58.209034 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:28:58.914117 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:28:58.916916 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:28:59.503194 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:5ec81def-2d82-48e9-9086-ddcaa5471a2a&page=queryresults
[0m23:29:02.338480 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f49047-6ba7-4347-aa4a-97ad5ed82d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda792885b0>]}
[0m23:29:02.339469 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.14s]
[0m23:29:02.340252 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m23:29:02.341256 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m23:29:02.341857 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m23:29:02.342407 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m23:29:02.342829 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m23:29:02.346197 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m23:29:02.347605 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m23:29:02.350201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:29:03.043525 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m23:29:03.047403 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m23:29:03.672132 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:d3212d5c-8521-4969-aea7-9126b30391d4&page=queryresults
[0m23:29:06.714655 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f49047-6ba7-4347-aa4a-97ad5ed82d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7966e400>]}
[0m23:29:06.717027 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.37s]
[0m23:29:06.718751 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m23:29:06.721312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:06.722255 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m23:29:06.723119 [info ] [MainThread]: 
[0m23:29:06.723853 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.77 seconds (11.77s).
[0m23:29:06.725938 [debug] [MainThread]: Command end result
[0m23:29:06.766775 [info ] [MainThread]: 
[0m23:29:06.767288 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:29:06.767659 [info ] [MainThread]: 
[0m23:29:06.768092 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected identifier "customers" at [13:7]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:29:06.768398 [info ] [MainThread]: 
[0m23:29:06.768699 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:29:06.770953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.8871975, "process_user_time": 3.845048, "process_kernel_time": 0.248584, "process_mem_max_rss": "200790016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:29:06.771491 [debug] [MainThread]: Command `dbt run` failed at 23:29:06.771410 after 12.89 seconds
[0m23:29:06.771837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7863b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8bf945b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8a40d130>]}
[0m23:29:06.772147 [debug] [MainThread]: Flushing usage events
[0m23:30:44.470206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe128bb32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12a65dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12a65d580>]}


============================== 23:30:44.473662 | 5283bb4a-25bc-4a25-9ef4-0057ac01cd91 ==============================
[0m23:30:44.473662 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:30:44.474167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:30:45.111897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5283bb4a-25bc-4a25-9ef4-0057ac01cd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe128e84ee0>]}
[0m23:30:45.144246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5283bb4a-25bc-4a25-9ef4-0057ac01cd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12c019610>]}
[0m23:30:45.144661 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:30:45.162967 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:30:45.256872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:30:45.257341 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/customers.sql
[0m23:30:45.399045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5283bb4a-25bc-4a25-9ef4-0057ac01cd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1391a9f40>]}
[0m23:30:45.463686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5283bb4a-25bc-4a25-9ef4-0057ac01cd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1391aaac0>]}
[0m23:30:45.464047 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:30:45.464315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5283bb4a-25bc-4a25-9ef4-0057ac01cd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe139141be0>]}
[0m23:30:45.465431 [info ] [MainThread]: 
[0m23:30:45.465913 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:30:45.469087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:30:45.469417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:46.302871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:30:46.304340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:47.023257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5283bb4a-25bc-4a25-9ef4-0057ac01cd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe139175eb0>]}
[0m23:30:47.025015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:30:47.025950 [info ] [MainThread]: 
[0m23:30:47.030613 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:30:47.031547 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m23:30:47.032343 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:30:47.032942 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:30:47.044832 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:30:47.045711 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:30:47.083587 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:30:47.084234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:30:47.085529 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        cutomers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m23:30:47.949775 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:00dc1793-400b-4a60-bc24-a7b67c2f90e6&page=queryresults
[0m23:30:48.285478 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: cutomers; Did you mean customers? at [41:9]; reason: invalidQuery, location: query, message: Unrecognized name: cutomers; Did you mean customers? at [41:9]')
[0m23:30:49.342040 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:90de5ca9-b00c-4441-b2c2-3231cdc29761&page=queryresults
[0m23:30:49.677531 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:90de5ca9-b00c-4441-b2c2-3231cdc29761&page=queryresults
[0m23:30:49.690306 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  Unrecognized name: cutomers; Did you mean customers? at [41:9]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:30:49.693258 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5283bb4a-25bc-4a25-9ef4-0057ac01cd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12c312d90>]}
[0m23:30:49.694385 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dbt_test.customers ....................... [[31mERROR[0m in 2.66s]
[0m23:30:49.695349 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:30:49.696009 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:30:49.696888 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:30:49.697597 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:30:49.698117 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:30:49.702405 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:30:49.703165 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:30:49.706106 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:30:50.348838 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:30:50.351895 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:30:50.873785 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:0bee513a-1803-450a-9123-07872c7154db&page=queryresults
[0m23:30:53.405743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5283bb4a-25bc-4a25-9ef4-0057ac01cd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ba1b6a0>]}
[0m23:30:53.406719 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.71s]
[0m23:30:53.407493 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m23:30:53.408505 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m23:30:53.409202 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m23:30:53.409731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m23:30:53.410142 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m23:30:53.413730 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m23:30:53.414393 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m23:30:53.416960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:30:54.062118 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m23:30:54.064945 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m23:30:54.676014 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:edb5c947-3f09-44d4-8c28-6fb91c98cb49&page=queryresults
[0m23:30:58.133692 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5283bb4a-25bc-4a25-9ef4-0057ac01cd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12c312130>]}
[0m23:30:58.135888 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.72s]
[0m23:30:58.137282 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m23:30:58.140345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:58.141149 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m23:30:58.141983 [info ] [MainThread]: 
[0m23:30:58.142751 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 12.68 seconds (12.68s).
[0m23:30:58.144899 [debug] [MainThread]: Command end result
[0m23:30:58.182690 [info ] [MainThread]: 
[0m23:30:58.183142 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:30:58.183434 [info ] [MainThread]: 
[0m23:30:58.183869 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  Unrecognized name: cutomers; Did you mean customers? at [41:9]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:30:58.184212 [info ] [MainThread]: 
[0m23:30:58.184548 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:30:58.186738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.77133, "process_user_time": 3.841879, "process_kernel_time": 0.24096, "process_mem_max_rss": "199270400", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:30:58.187320 [debug] [MainThread]: Command `dbt run` failed at 23:30:58.187234 after 13.77 seconds
[0m23:30:58.187695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe128bb32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe128fb9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe128e84ee0>]}
[0m23:30:58.188039 [debug] [MainThread]: Flushing usage events
[0m23:32:33.869607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb000e232e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00287dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00287d4f0>]}


============================== 23:32:33.873150 | 63b1b0f2-0830-4de7-b6df-cb4771309a4a ==============================
[0m23:32:33.873150 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:32:33.873632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:32:34.554621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63b1b0f2-0830-4de7-b6df-cb4771309a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0010e3f40>]}
[0m23:32:34.587836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63b1b0f2-0830-4de7-b6df-cb4771309a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0027f8dc0>]}
[0m23:32:34.588256 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:32:34.606808 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:32:34.701772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:32:34.702240 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/customers.sql
[0m23:32:34.845549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63b1b0f2-0830-4de7-b6df-cb4771309a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff0fc1ee0>]}
[0m23:32:34.911812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63b1b0f2-0830-4de7-b6df-cb4771309a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff0fd3b20>]}
[0m23:32:34.912188 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:32:34.912470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b1b0f2-0830-4de7-b6df-cb4771309a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafe03a3340>]}
[0m23:32:34.913717 [info ] [MainThread]: 
[0m23:32:34.914236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:32:34.917318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:32:34.917634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:35.557743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:32:35.559494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:36.240167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b1b0f2-0830-4de7-b6df-cb4771309a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb002834f40>]}
[0m23:32:36.244673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:36.245918 [info ] [MainThread]: 
[0m23:32:36.251725 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:32:36.252386 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m23:32:36.253097 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:32:36.253528 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:32:36.260762 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:32:36.261621 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:32:36.293378 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:32:36.294069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:32:36.295512 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from 'bigquery-public-data'.thelook_ecommerce.users
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from 'bigquery-public-data'.thelook_ecommerce.orders
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        cutomers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m23:32:36.934874 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:a9afb22f-ff0d-4ad7-9a69-e4f376bf5335&page=queryresults
[0m23:32:36.937506 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]")
[0m23:32:37.545954 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:309b5212-6513-4bfd-8983-97d16c19e37b&page=queryresults
[0m23:32:37.548565 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:309b5212-6513-4bfd-8983-97d16c19e37b&page=queryresults
[0m23:32:37.564046 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:32:37.566816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b1b0f2-0830-4de7-b6df-cb4771309a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc0091a90>]}
[0m23:32:37.568014 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dbt_test.customers ....................... [[31mERROR[0m in 1.31s]
[0m23:32:37.569021 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:32:37.569706 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:32:37.570605 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:32:37.571267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:32:37.571767 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:32:37.576459 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:32:37.577757 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:32:37.580964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:32:38.230218 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:32:38.232343 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:32:38.802234 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:ed10543f-8651-4bd6-ad08-0a678cc1ae63&page=queryresults
[0m23:32:41.896400 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b1b0f2-0830-4de7-b6df-cb4771309a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb003c7b640>]}
[0m23:32:41.897891 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.33s]
[0m23:32:41.898687 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m23:32:41.899800 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m23:32:41.900496 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m23:32:41.901113 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m23:32:41.901571 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m23:32:41.905184 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m23:32:41.905900 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m23:32:41.908534 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:32:42.596679 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m23:32:42.599538 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m23:32:43.283069 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:c0f73707-cb82-4d76-9d04-baeae6fad919&page=queryresults
[0m23:32:46.154175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b1b0f2-0830-4de7-b6df-cb4771309a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1082a60>]}
[0m23:32:46.156204 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.25s]
[0m23:32:46.157969 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m23:32:46.160647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:46.161402 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m23:32:46.162223 [info ] [MainThread]: 
[0m23:32:46.162993 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.25 seconds (11.25s).
[0m23:32:46.165019 [debug] [MainThread]: Command end result
[0m23:32:46.203642 [info ] [MainThread]: 
[0m23:32:46.204120 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:32:46.204437 [info ] [MainThread]: 
[0m23:32:46.204804 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  Syntax error: Unexpected string literal 'bigquery-public-data' at [17:10]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m23:32:46.205086 [info ] [MainThread]: 
[0m23:32:46.205381 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:32:46.207545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.395827, "process_user_time": 3.835324, "process_kernel_time": 0.254059, "process_mem_max_rss": "196116480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:32:46.208090 [debug] [MainThread]: Command `dbt run` failed at 23:32:46.208012 after 12.40 seconds
[0m23:32:46.208454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb000e232e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff0ffa280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0027f8dc0>]}
[0m23:32:46.208769 [debug] [MainThread]: Flushing usage events
[0m23:34:10.871230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf68d732e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf58835d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf58835580>]}


============================== 23:34:10.874737 | 5c8b286c-369b-41d8-afd5-49f3a50139de ==============================
[0m23:34:10.874737 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:34:10.875241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:34:11.567219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c8b286c-369b-41d8-afd5-49f3a50139de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6bda4880>]}
[0m23:34:11.600006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c8b286c-369b-41d8-afd5-49f3a50139de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf587ec880>]}
[0m23:34:11.600429 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:34:11.623656 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:34:11.723548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:34:11.724064 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/customers.sql
[0m23:34:11.866653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c8b286c-369b-41d8-afd5-49f3a50139de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6bfd8130>]}
[0m23:34:11.933609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c8b286c-369b-41d8-afd5-49f3a50139de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6bfe3af0>]}
[0m23:34:11.933966 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:34:11.934239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c8b286c-369b-41d8-afd5-49f3a50139de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf48526310>]}
[0m23:34:11.935451 [info ] [MainThread]: 
[0m23:34:11.935943 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:34:11.939028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:34:11.939345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:12.535990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:34:12.537226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:13.235042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c8b286c-369b-41d8-afd5-49f3a50139de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6be25370>]}
[0m23:34:13.236970 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:34:13.237958 [info ] [MainThread]: 
[0m23:34:13.243179 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:34:13.244786 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m23:34:13.245922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:34:13.246707 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:34:13.260847 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:34:13.262079 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:34:13.301769 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:34:13.302440 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:13.303743 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m23:34:14.180612 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:047ca41f-7030-4270-86bf-0b90002b0ca1&page=queryresults
[0m23:34:18.092368 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b286c-369b-41d8-afd5-49f3a50139de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf30021d90>]}
[0m23:34:18.093360 [info ] [Thread-1  ]: 1 of 3 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 4.85s]
[0m23:34:18.094163 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:34:18.094735 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:34:18.095449 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:34:18.096099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:34:18.096572 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:34:18.100411 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:34:18.102064 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:34:18.104845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:18.788194 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:34:18.792051 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:34:19.312421 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:e1613a14-f901-49cd-9ff9-4000c4260027&page=queryresults
[0m23:34:22.663044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b286c-369b-41d8-afd5-49f3a50139de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf591d8cd0>]}
[0m23:34:22.664550 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.57s]
[0m23:34:22.665955 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m23:34:22.667695 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m23:34:22.668773 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m23:34:22.670031 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m23:34:22.670665 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m23:34:22.676091 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m23:34:22.677850 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m23:34:22.681624 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:23.342700 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m23:34:23.346640 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m23:34:23.900879 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:09c0e96a-7d1c-4f98-b92c-798f28e22a11&page=queryresults
[0m23:34:26.681264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8b286c-369b-41d8-afd5-49f3a50139de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf591e07f0>]}
[0m23:34:26.684276 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.01s]
[0m23:34:26.686111 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m23:34:26.690905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:26.691996 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m23:34:26.693344 [info ] [MainThread]: 
[0m23:34:26.694182 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 14.76 seconds (14.76s).
[0m23:34:26.696637 [debug] [MainThread]: Command end result
[0m23:34:26.745978 [info ] [MainThread]: 
[0m23:34:26.746531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:26.746872 [info ] [MainThread]: 
[0m23:34:26.747225 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:34:26.749830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.939117, "process_user_time": 3.81687, "process_kernel_time": 0.321188, "process_mem_max_rss": "195624960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:26.750473 [debug] [MainThread]: Command `dbt run` succeeded at 23:34:26.750382 after 15.94 seconds
[0m23:34:26.750888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf68d732e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69c29a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf587ec880>]}
[0m23:34:26.751259 [debug] [MainThread]: Flushing usage events
[0m23:42:40.425646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd0f132e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc09c4d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc09c44f0>]}


============================== 23:42:40.428930 | fa83c36e-e4bb-4e3e-8211-b534af805159 ==============================
[0m23:42:40.428930 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:42:40.429454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:42:41.111617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa83c36e-e4bb-4e3e-8211-b534af805159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd11ecf40>]}
[0m23:42:41.144378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa83c36e-e4bb-4e3e-8211-b534af805159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bb04d12b0>]}
[0m23:42:41.144811 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:42:41.170901 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:42:41.239484 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:42:41.239925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa83c36e-e4bb-4e3e-8211-b534af805159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd170ba90>]}
[0m23:42:42.082881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa83c36e-e4bb-4e3e-8211-b534af805159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc176b130>]}
[0m23:42:42.150513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa83c36e-e4bb-4e3e-8211-b534af805159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc1787d30>]}
[0m23:42:42.150893 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:42:42.151240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa83c36e-e4bb-4e3e-8211-b534af805159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc178d070>]}
[0m23:42:42.152410 [info ] [MainThread]: 
[0m23:42:42.152902 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:42:42.156056 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:42:42.156411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:42.963201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:42:42.964402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:43.639062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa83c36e-e4bb-4e3e-8211-b534af805159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bb0697fd0>]}
[0m23:42:43.641144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:42:43.642067 [info ] [MainThread]: 
[0m23:42:43.648932 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:42:43.650291 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_test.customers ................................. [RUN]
[0m23:42:43.651413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:42:43.652292 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:42:43.665096 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:42:43.666202 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:42:43.742805 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:42:44.445206 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:42:44.446388 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */


  create or replace view `dbt-test-427409`.`dbt_test`.`customers`
  OPTIONS()
  as with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final;


[0m23:42:45.332184 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:aa222889-6219-4fa9-a123-2298aecbc78a&page=queryresults
[0m23:42:46.078132 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa83c36e-e4bb-4e3e-8211-b534af805159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc1842ca0>]}
[0m23:42:46.079432 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_test.customers ............................ [[32mCREATE VIEW (0 processed)[0m in 2.43s]
[0m23:42:46.080307 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:42:46.080882 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:42:46.081586 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:42:46.082259 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:42:46.082731 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:42:46.086727 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:42:46.088604 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:42:46.099963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:42:46.821459 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:42:46.824038 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:42:47.418268 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:ce640718-dfa3-4ff6-8e30-818efd0ed19d&page=queryresults
[0m23:42:50.185895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa83c36e-e4bb-4e3e-8211-b534af805159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc1782550>]}
[0m23:42:50.188033 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.10s]
[0m23:42:50.189784 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m23:42:50.195041 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m23:42:50.196709 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m23:42:50.198360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m23:42:50.199403 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m23:42:50.206251 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m23:42:50.208593 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m23:42:50.213689 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:42:50.888776 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m23:42:50.891585 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m23:42:51.739327 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:fac010d7-afbc-452c-a041-ebdd78795630&page=queryresults
[0m23:42:54.526958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa83c36e-e4bb-4e3e-8211-b534af805159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc1782550>]}
[0m23:42:54.530257 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.33s]
[0m23:42:54.532377 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m23:42:54.535528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:54.536553 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m23:42:54.537514 [info ] [MainThread]: 
[0m23:42:54.538632 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 12.38 seconds (12.38s).
[0m23:42:54.541214 [debug] [MainThread]: Command end result
[0m23:42:54.587676 [info ] [MainThread]: 
[0m23:42:54.588246 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:42:54.588646 [info ] [MainThread]: 
[0m23:42:54.588994 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:42:54.591408 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.222715, "process_user_time": 4.564426, "process_kernel_time": 0.402729, "process_mem_max_rss": "202268672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:42:54.592034 [debug] [MainThread]: Command `dbt run` succeeded at 23:42:54.591934 after 14.22 seconds
[0m23:42:54.592456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd0f132e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9009d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bc155e400>]}
[0m23:42:54.592818 [debug] [MainThread]: Flushing usage events
[0m23:43:47.706962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f8c432e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e8b1cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e8b1c4f0>]}


============================== 23:43:47.710428 | 1b415125-1dbb-4c84-ab94-3109fafb450d ==============================
[0m23:43:47.710428 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:43:47.710921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:43:48.392024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b415125-1dbb-4c84-ab94-3109fafb450d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fb63ff70>]}
[0m23:43:48.425238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b415125-1dbb-4c84-ab94-3109fafb450d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fbc8d5b0>]}
[0m23:43:48.425719 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m23:43:48.444251 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:43:48.514485 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:43:48.514903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b415125-1dbb-4c84-ab94-3109fafb450d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f943ba90>]}
[0m23:43:49.386732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b415125-1dbb-4c84-ab94-3109fafb450d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fbe27130>]}
[0m23:43:49.456034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b415125-1dbb-4c84-ab94-3109fafb450d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e92eaf10>]}
[0m23:43:49.456492 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m23:43:49.456774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b415125-1dbb-4c84-ab94-3109fafb450d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fbe3b760>]}
[0m23:43:49.457882 [info ] [MainThread]: 
[0m23:43:49.458452 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:43:49.461663 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m23:43:49.462046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:50.091068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m23:43:50.092926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:50.738246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b415125-1dbb-4c84-ab94-3109fafb450d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6d8766250>]}
[0m23:43:50.740214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:43:50.741167 [info ] [MainThread]: 
[0m23:43:50.752702 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m23:43:50.754879 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m23:43:50.756408 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m23:43:50.757301 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m23:43:50.772216 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m23:43:50.773959 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m23:43:50.848028 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:43:51.897865 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m23:43:51.898630 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m23:43:52.612982 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:291ec654-f857-475c-bb10-8ed78400f6f7&page=queryresults
[0m23:43:56.895195 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b415125-1dbb-4c84-ab94-3109fafb450d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e92e20a0>]}
[0m23:43:56.896796 [info ] [Thread-1  ]: 1 of 3 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 6.14s]
[0m23:43:56.897721 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m23:43:56.898359 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m23:43:56.899170 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m23:43:56.899922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m23:43:56.900461 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m23:43:56.904611 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m23:43:56.905768 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m23:43:56.908695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:43:57.524379 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m23:43:57.527579 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:43:58.041293 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:dfa4337d-e0a5-46d0-8327-8c1795c5e791&page=queryresults
[0m23:44:00.655717 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b415125-1dbb-4c84-ab94-3109fafb450d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fbe55df0>]}
[0m23:44:00.658260 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.76s]
[0m23:44:00.659918 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m23:44:00.661935 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m23:44:00.663344 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m23:44:00.664515 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m23:44:00.667137 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m23:44:00.674479 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m23:44:00.677318 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m23:44:00.682402 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:44:01.365886 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m23:44:01.369427 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m23:44:02.074816 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:55b1d7e4-842e-4866-a08f-e0ebaf70c9fa&page=queryresults
[0m23:44:05.432902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b415125-1dbb-4c84-ab94-3109fafb450d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e8ad44c0>]}
[0m23:44:05.434442 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.77s]
[0m23:44:05.436438 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m23:44:05.438796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:05.439657 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m23:44:05.440756 [info ] [MainThread]: 
[0m23:44:05.441600 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 15.98 seconds (15.98s).
[0m23:44:05.445219 [debug] [MainThread]: Command end result
[0m23:44:05.489655 [info ] [MainThread]: 
[0m23:44:05.490225 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:44:05.490816 [info ] [MainThread]: 
[0m23:44:05.491268 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:44:05.493918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.842134, "process_user_time": 4.706537, "process_kernel_time": 0.275812, "process_mem_max_rss": "204861440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:44:05.494564 [debug] [MainThread]: Command `dbt run` succeeded at 23:44:05.494465 after 17.84 seconds
[0m23:44:05.495002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f8c432e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6d80a60a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6d84471f0>]}
[0m23:44:05.495403 [debug] [MainThread]: Flushing usage events
[0m00:57:29.450914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75107b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75299ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75299e460>]}


============================== 00:57:29.456359 | 45781034-ee7c-49b2-aab8-9b4c51e72b52 ==============================
[0m00:57:29.456359 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:57:29.457122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:57:30.524613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45781034-ee7c-49b2-aab8-9b4c51e72b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7539c11c0>]}
[0m00:57:30.581034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45781034-ee7c-49b2-aab8-9b4c51e72b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7611ea2b0>]}
[0m00:57:30.581708 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m00:57:30.619849 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:57:30.776625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:57:30.777251 [debug] [MainThread]: Partial parsing: added file: dbt_test://seeds/stadium_cleaned.csv
[0m00:57:31.028205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45781034-ee7c-49b2-aab8-9b4c51e72b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75441e130>]}
[0m00:57:31.153796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45781034-ee7c-49b2-aab8-9b4c51e72b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7543ec9a0>]}
[0m00:57:31.154383 [info ] [MainThread]: Found 3 models, 4 data tests, 1 seed, 471 macros
[0m00:57:31.154875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45781034-ee7c-49b2-aab8-9b4c51e72b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75441efa0>]}
[0m00:57:31.156721 [info ] [MainThread]: 
[0m00:57:31.157486 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:57:31.158786 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m00:57:31.159278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:32.347448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m00:57:32.348556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:57:33.411294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45781034-ee7c-49b2-aab8-9b4c51e72b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd754464130>]}
[0m00:57:33.413011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:57:33.413670 [info ] [MainThread]: 
[0m00:57:33.418635 [debug] [Thread-1  ]: Began running node seed.dbt_test.stadium_cleaned
[0m00:57:33.419808 [info ] [Thread-1  ]: 1 of 1 START seed file dbt_test.stadium_cleaned ................................ [RUN]
[0m00:57:33.420708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now seed.dbt_test.stadium_cleaned)
[0m00:57:33.421339 [debug] [Thread-1  ]: Began compiling node seed.dbt_test.stadium_cleaned
[0m00:57:33.421949 [debug] [Thread-1  ]: Began executing node seed.dbt_test.stadium_cleaned
[0m00:57:33.473046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:57:39.758514 [debug] [Thread-1  ]: On seed.dbt_test.stadium_cleaned: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.stadium_cleaned"} */

    alter table `dbt-test-427409`.`dbt_test`.`stadium_cleaned` set OPTIONS()
  
[0m00:57:40.353644 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:fc5e3bed-4ec0-4429-bd69-734e6ef9da1a&page=queryresults
[0m00:57:41.197368 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dbt_test.stadium_cleaned"
[0m00:57:41.230450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45781034-ee7c-49b2-aab8-9b4c51e72b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75134f2b0>]}
[0m00:57:41.231590 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file dbt_test.stadium_cleaned ............................ [[32mINSERT 381[0m in 7.81s]
[0m00:57:41.232468 [debug] [Thread-1  ]: Finished running node seed.dbt_test.stadium_cleaned
[0m00:57:41.233829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:57:41.234234 [debug] [MainThread]: Connection 'seed.dbt_test.stadium_cleaned' was properly closed.
[0m00:57:41.234620 [info ] [MainThread]: 
[0m00:57:41.235022 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.08 seconds (10.08s).
[0m00:57:41.235801 [debug] [MainThread]: Command end result
[0m00:57:41.272977 [info ] [MainThread]: 
[0m00:57:41.273573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:57:41.273992 [info ] [MainThread]: 
[0m00:57:41.274394 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:57:41.285186 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.929699, "process_user_time": 4.805527, "process_kernel_time": 0.372541, "process_mem_max_rss": "197029888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:57:41.285917 [debug] [MainThread]: Command `dbt seed` succeeded at 00:57:41.285808 after 11.93 seconds
[0m00:57:41.286374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75107b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd750a403d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7611ea2b0>]}
[0m00:57:41.286806 [debug] [MainThread]: Flushing usage events
[0m14:26:02.949953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faca91eb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facaa2ddd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facaa2dd460>]}


============================== 14:26:02.955905 | e04f3a75-a28f-485d-8c26-b1dc01be8be7 ==============================
[0m14:26:02.955905 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:26:02.956763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:26:04.315110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e04f3a75-a28f-485d-8c26-b1dc01be8be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facaa294250>]}
[0m14:26:04.373246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e04f3a75-a28f-485d-8c26-b1dc01be8be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facaae181c0>]}
[0m14:26:04.374087 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:26:04.405464 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:26:04.584769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:26:04.585565 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/schema.yml
[0m14:26:04.586108 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/customers.sql
[0m14:26:04.866317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e04f3a75-a28f-485d-8c26-b1dc01be8be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac98218eb0>]}
[0m14:26:04.991053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e04f3a75-a28f-485d-8c26-b1dc01be8be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac981ff5e0>]}
[0m14:26:04.991682 [info ] [MainThread]: Found 3 models, 4 data tests, 1 seed, 471 macros
[0m14:26:04.992117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e04f3a75-a28f-485d-8c26-b1dc01be8be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac981fd070>]}
[0m14:26:04.993891 [info ] [MainThread]: 
[0m14:26:04.994617 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:26:04.999575 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m14:26:05.000131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:05.898542 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409_dbt_test'
[0m14:26:05.900006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:06.652166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e04f3a75-a28f-485d-8c26-b1dc01be8be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facaa2895b0>]}
[0m14:26:06.654022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:26:06.654837 [info ] [MainThread]: 
[0m14:26:06.659479 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m14:26:06.660720 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m14:26:06.661707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now model.dbt_test.customers)
[0m14:26:06.662371 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m14:26:06.674624 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m14:26:06.675514 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m14:26:06.693375 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:26:07.551629 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m14:26:07.553971 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select 
        user_id,
        COALESCE(min(created_at), 'Shipped') as first_order,
        COALESCE(max(created_at), 'Shipped') as most_recent_order,
        COALESCE(count(order_id), 0) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m14:26:08.431623 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:c9884295-d5cc-43af-8531-d6452c7b1477&page=queryresults
[0m14:26:08.837324 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Could not cast literal "Shipped" to type TIMESTAMP at [31:35]; reason: invalidQuery, location: query, message: Could not cast literal "Shipped" to type TIMESTAMP at [31:35]')
[0m14:26:10.273175 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:8cf38d94-e174-4af7-afb1-0eaf55b797b3&page=queryresults
[0m14:26:10.684801 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:8cf38d94-e174-4af7-afb1-0eaf55b797b3&page=queryresults
[0m14:26:10.697347 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  Could not cast literal "Shipped" to type TIMESTAMP at [31:35]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m14:26:10.699927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04f3a75-a28f-485d-8c26-b1dc01be8be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac69746520>]}
[0m14:26:10.701123 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dbt_test.customers ....................... [[31mERROR[0m in 4.04s]
[0m14:26:10.702101 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m14:26:10.702690 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m14:26:10.703431 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m14:26:10.704106 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m14:26:10.704599 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m14:26:10.709259 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m14:26:10.710193 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m14:26:10.713131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:26:11.426028 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m14:26:11.428165 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:26:12.117018 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:321e01af-64ca-4599-ac06-b4349f6b118e&page=queryresults
[0m14:26:15.209547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04f3a75-a28f-485d-8c26-b1dc01be8be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8036aac0>]}
[0m14:26:15.210474 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.51s]
[0m14:26:15.211316 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m14:26:15.212340 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m14:26:15.213005 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m14:26:15.213656 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m14:26:15.214180 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m14:26:15.218099 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m14:26:15.218877 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m14:26:15.221737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:26:16.010608 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m14:26:16.013414 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m14:26:16.724944 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:60df2546-a3d6-496b-b21e-7b771850c5cf&page=queryresults
[0m14:26:19.372350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04f3a75-a28f-485d-8c26-b1dc01be8be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6986aac0>]}
[0m14:26:19.374352 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.16s]
[0m14:26:19.375624 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m14:26:19.377726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:19.378327 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m14:26:19.378826 [debug] [MainThread]: Connection 'list_dbt-test-427409_dbt_test' was properly closed.
[0m14:26:19.379447 [info ] [MainThread]: 
[0m14:26:19.380005 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 14.38 seconds (14.38s).
[0m14:26:19.381490 [debug] [MainThread]: Command end result
[0m14:26:19.422294 [info ] [MainThread]: 
[0m14:26:19.422841 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:26:19.423242 [info ] [MainThread]: 
[0m14:26:19.423877 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  Could not cast literal "Shipped" to type TIMESTAMP at [31:35]
  compiled Code at target/run/dbt_test/models/customers.sql
[0m14:26:19.424271 [info ] [MainThread]: 
[0m14:26:19.424664 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:26:19.426944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.5825, "process_user_time": 5.093734, "process_kernel_time": 0.847176, "process_mem_max_rss": "200155136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:26:19.427673 [debug] [MainThread]: Command `dbt run` failed at 14:26:19.427566 after 16.58 seconds
[0m14:26:19.428137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faca91eb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facaae181c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8036aac0>]}
[0m14:26:19.428559 [debug] [MainThread]: Flushing usage events
[0m14:27:45.655971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa028d7b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa019075d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa019075430>]}


============================== 14:27:45.661188 | a7c66ee2-616c-44dd-bd35-eaaf2b7755d3 ==============================
[0m14:27:45.661188 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:27:45.662007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:27:46.675207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7c66ee2-616c-44dd-bd35-eaaf2b7755d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa019055250>]}
[0m14:27:46.730620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7c66ee2-616c-44dd-bd35-eaaf2b7755d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa01a0eb100>]}
[0m14:27:46.731279 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:27:46.762043 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:27:46.933265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:46.934023 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/customers.sql
[0m14:27:47.191352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7c66ee2-616c-44dd-bd35-eaaf2b7755d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa00840f130>]}
[0m14:27:47.314611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7c66ee2-616c-44dd-bd35-eaaf2b7755d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02914b8e0>]}
[0m14:27:47.315220 [info ] [MainThread]: Found 3 models, 4 data tests, 1 seed, 471 macros
[0m14:27:47.315664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c66ee2-616c-44dd-bd35-eaaf2b7755d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa01a125d00>]}
[0m14:27:47.317431 [info ] [MainThread]: 
[0m14:27:47.318125 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:27:47.322989 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m14:27:47.323527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:48.171135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m14:27:48.172459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:48.901230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c66ee2-616c-44dd-bd35-eaaf2b7755d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa008415430>]}
[0m14:27:48.902884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:48.903771 [info ] [MainThread]: 
[0m14:27:48.909144 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m14:27:48.910460 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m14:27:48.911580 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m14:27:48.912404 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m14:27:48.925658 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m14:27:48.926586 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m14:27:48.945009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:49.744203 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m14:27:49.745200 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select 
        user_id,
        min(CAST(created_at AS DATETIME)) as first_order,
        max(CAST(created_at AS DATETIME)) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m14:27:50.522583 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:c84c4328-dc2b-44e5-bebf-d74c878b96b9&page=queryresults
[0m14:27:54.784469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c66ee2-616c-44dd-bd35-eaaf2b7755d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa019e33700>]}
[0m14:27:54.785466 [info ] [Thread-1  ]: 1 of 3 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 5.87s]
[0m14:27:54.786249 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m14:27:54.786782 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m14:27:54.787471 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m14:27:54.788105 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m14:27:54.788566 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m14:27:54.794125 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m14:27:54.794987 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m14:27:54.798010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:55.646772 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m14:27:55.648582 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:27:56.259087 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:8c223461-6cd2-46f7-bf49-7d32f170a213&page=queryresults
[0m14:27:59.303589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c66ee2-616c-44dd-bd35-eaaf2b7755d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa00851e970>]}
[0m14:27:59.307395 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.52s]
[0m14:27:59.309138 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m14:27:59.311224 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m14:27:59.312313 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m14:27:59.313730 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m14:27:59.314465 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m14:27:59.322970 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m14:27:59.324148 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m14:27:59.327634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:28:00.067455 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m14:28:00.070372 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m14:28:00.896580 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9847d504-7ad7-479f-ab3f-b3f91f14e0b8&page=queryresults
[0m14:28:04.603607 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c66ee2-616c-44dd-bd35-eaaf2b7755d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa00851e040>]}
[0m14:28:04.604454 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 5.29s]
[0m14:28:04.605309 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m14:28:04.606688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:04.607081 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m14:28:04.607527 [info ] [MainThread]: 
[0m14:28:04.607936 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 17.29 seconds (17.29s).
[0m14:28:04.609275 [debug] [MainThread]: Command end result
[0m14:28:04.652116 [info ] [MainThread]: 
[0m14:28:04.652852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:04.653270 [info ] [MainThread]: 
[0m14:28:04.653718 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:28:04.656175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.08193, "process_user_time": 5.003135, "process_kernel_time": 0.331831, "process_mem_max_rss": "199954432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:28:04.656913 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:04.656798 after 19.08 seconds
[0m14:28:04.657380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa028d7b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa019bb2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0287ed3d0>]}
[0m14:28:04.657826 [debug] [MainThread]: Flushing usage events
[0m14:33:02.057489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9220e732e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9221facd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9221fac4f0>]}


============================== 14:33:02.062864 | ae762061-dbac-4129-9938-2ad18a2f9421 ==============================
[0m14:33:02.062864 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:33:02.063622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:33:03.381160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae762061-dbac-4129-9938-2ad18a2f9421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9240fad670>]}
[0m14:33:03.438946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae762061-dbac-4129-9938-2ad18a2f9421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9221f28f40>]}
[0m14:33:03.439675 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:33:03.469626 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:33:03.646844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:03.647616 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/customers.sql
[0m14:33:03.910104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae762061-dbac-4129-9938-2ad18a2f9421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e05f1e20>]}
[0m14:33:04.036271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae762061-dbac-4129-9938-2ad18a2f9421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e05f6e50>]}
[0m14:33:04.036927 [info ] [MainThread]: Found 3 models, 4 data tests, 1 seed, 471 macros
[0m14:33:04.037377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae762061-dbac-4129-9938-2ad18a2f9421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e060d7c0>]}
[0m14:33:04.039164 [info ] [MainThread]: 
[0m14:33:04.039829 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:33:04.044710 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m14:33:04.045236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:04.997612 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409_dbt_test'
[0m14:33:04.998775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:05.753326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae762061-dbac-4129-9938-2ad18a2f9421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9221f64f40>]}
[0m14:33:05.755894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:05.757183 [info ] [MainThread]: 
[0m14:33:05.762865 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m14:33:05.765168 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m14:33:05.767328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now model.dbt_test.customers)
[0m14:33:05.768284 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m14:33:05.784533 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m14:33:05.786370 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m14:33:05.806014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:33:06.594561 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m14:33:06.596196 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m14:33:07.512746 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:00bc803a-b482-45bb-955a-a2d505fde267&page=queryresults
[0m14:33:12.035522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae762061-dbac-4129-9938-2ad18a2f9421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f0088fa0>]}
[0m14:33:12.036657 [info ] [Thread-1  ]: 1 of 3 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 6.27s]
[0m14:33:12.037553 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m14:33:12.038159 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m14:33:12.038968 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m14:33:12.039696 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m14:33:12.040227 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m14:33:12.046015 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m14:33:12.046859 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m14:33:12.049836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:33:12.883499 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m14:33:12.887544 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:33:13.433582 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:be1706d9-22c1-40aa-919b-119b77de3e40&page=queryresults
[0m14:33:18.106002 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae762061-dbac-4129-9938-2ad18a2f9421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f0088c40>]}
[0m14:33:18.109420 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 6.07s]
[0m14:33:18.111276 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m14:33:18.113601 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m14:33:18.118919 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m14:33:18.120628 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m14:33:18.121537 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m14:33:18.131076 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m14:33:18.132837 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m14:33:18.138141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:33:18.925109 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m14:33:18.930297 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m14:33:19.566529 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:1967fa2a-5018-409d-8c1f-e483fa3c9d57&page=queryresults
[0m14:33:42.791733 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae762061-dbac-4129-9938-2ad18a2f9421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92413ca160>]}
[0m14:33:42.795920 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 24.67s]
[0m14:33:42.797775 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m14:33:42.801057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:42.801940 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m14:33:42.802537 [debug] [MainThread]: Connection 'list_dbt-test-427409_dbt_test' was properly closed.
[0m14:33:42.803457 [info ] [MainThread]: 
[0m14:33:42.804675 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 38.76 seconds (38.76s).
[0m14:33:42.807539 [debug] [MainThread]: Command end result
[0m14:33:42.857121 [info ] [MainThread]: 
[0m14:33:42.857754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:42.858222 [info ] [MainThread]: 
[0m14:33:42.858667 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:33:42.861953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 40.89797, "process_user_time": 5.17682, "process_kernel_time": 0.512801, "process_mem_max_rss": "196300800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:33:42.862811 [debug] [MainThread]: Command `dbt run` succeeded at 14:33:42.862704 after 40.90 seconds
[0m14:33:42.863383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9220e732e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9221b693d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9240fad670>]}
[0m14:33:42.863847 [debug] [MainThread]: Flushing usage events
[0m17:31:32.906625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec693532e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6ab012b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6ab01bb0>]}


============================== 17:31:32.912102 | 2907eb0d-4e05-4802-bb18-0ab4d644dcc4 ==============================
[0m17:31:32.912102 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:31:32.912909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:31:34.264891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2907eb0d-4e05-4802-bb18-0ab4d644dcc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec58a231c0>]}
[0m17:31:34.321021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2907eb0d-4e05-4802-bb18-0ab4d644dcc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6a9362b0>]}
[0m17:31:34.321704 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:31:34.354307 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:31:34.530304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:31:34.531062 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/schema.yml
[0m17:31:34.594071 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:31:34.594761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2907eb0d-4e05-4802-bb18-0ab4d644dcc4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec58c9ca60>]}
[0m17:31:34.811947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2907eb0d-4e05-4802-bb18-0ab4d644dcc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec58e87130>]}
[0m17:31:34.938375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2907eb0d-4e05-4802-bb18-0ab4d644dcc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec58eb6520>]}
[0m17:31:34.939004 [info ] [MainThread]: Found 3 models, 7 data tests, 1 seed, 471 macros
[0m17:31:34.939427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2907eb0d-4e05-4802-bb18-0ab4d644dcc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec697800a0>]}
[0m17:31:34.941262 [info ] [MainThread]: 
[0m17:31:34.942032 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:31:34.947030 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:31:34.947538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:35.803936 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409_dbt_test'
[0m17:31:35.805669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:36.502159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2907eb0d-4e05-4802-bb18-0ab4d644dcc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec58e06880>]}
[0m17:31:36.504397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:36.505371 [info ] [MainThread]: 
[0m17:31:36.510995 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:31:36.512325 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_test.customers ................................ [RUN]
[0m17:31:36.513352 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now model.dbt_test.customers)
[0m17:31:36.514094 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:31:36.526590 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:31:36.528583 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:31:36.548400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:31:37.268733 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:31:37.271354 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:31:38.094142 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:7615136c-3d29-4642-8103-90c30f9c1b5d&page=queryresults
[0m17:31:44.190291 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2907eb0d-4e05-4802-bb18-0ab4d644dcc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec58c7f940>]}
[0m17:31:44.191699 [info ] [Thread-1  ]: 1 of 3 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 7.68s]
[0m17:31:44.192750 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:31:44.193469 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:31:44.194239 [info ] [Thread-1  ]: 2 of 3 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:31:44.194901 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:31:44.195415 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:31:44.199688 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:31:44.201242 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:31:44.204203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:31:44.946692 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:31:44.951539 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:31:45.496015 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:974aa372-be21-47eb-8a85-d199e8a490e7&page=queryresults
[0m17:31:48.848295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2907eb0d-4e05-4802-bb18-0ab4d644dcc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec18613250>]}
[0m17:31:48.849921 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.65s]
[0m17:31:48.851394 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:31:48.853110 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:31:48.854209 [info ] [Thread-1  ]: 3 of 3 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:31:48.855198 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m17:31:48.855959 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:31:48.860748 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:31:48.862983 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:31:48.866720 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:31:49.663338 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:31:49.667640 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:31:50.308629 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9a8f2388-202e-4c4f-905f-43bc938897e1&page=queryresults
[0m17:31:55.519525 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2907eb0d-4e05-4802-bb18-0ab4d644dcc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec18613250>]}
[0m17:31:55.523160 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 6.66s]
[0m17:31:55.525379 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:31:55.529069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:55.530546 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:31:55.531628 [debug] [MainThread]: Connection 'list_dbt-test-427409_dbt_test' was properly closed.
[0m17:31:55.532561 [info ] [MainThread]: 
[0m17:31:55.533375 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 20.59 seconds (20.59s).
[0m17:31:55.536684 [debug] [MainThread]: Command end result
[0m17:31:55.581757 [info ] [MainThread]: 
[0m17:31:55.582428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:55.582857 [info ] [MainThread]: 
[0m17:31:55.583355 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:31:55.586423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.780334, "process_user_time": 5.11978, "process_kernel_time": 0.842656, "process_mem_max_rss": "198967296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:31:55.587217 [debug] [MainThread]: Command `dbt run` succeeded at 17:31:55.587102 after 22.78 seconds
[0m17:31:55.587725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec693532e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec185039d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec68d153d0>]}
[0m17:31:55.588277 [debug] [MainThread]: Flushing usage events
[0m17:33:59.236091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8098b9b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808893dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808893d400>]}


============================== 17:33:59.241563 | 66886f0d-55ed-4ced-bb1c-79e8c6a1c857 ==============================
[0m17:33:59.241563 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:33:59.242351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:34:00.302813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66886f0d-55ed-4ced-bb1c-79e8c6a1c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809b58e190>]}
[0m17:34:00.358909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66886f0d-55ed-4ced-bb1c-79e8c6a1c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80987142e0>]}
[0m17:34:00.359580 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:34:00.384983 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:34:00.558629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:00.559112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:00.621065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66886f0d-55ed-4ced-bb1c-79e8c6a1c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809bfd6130>]}
[0m17:34:00.638119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66886f0d-55ed-4ced-bb1c-79e8c6a1c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809bfb2070>]}
[0m17:34:00.638689 [info ] [MainThread]: Found 3 models, 7 data tests, 1 seed, 471 macros
[0m17:34:00.639110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66886f0d-55ed-4ced-bb1c-79e8c6a1c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809bfb2220>]}
[0m17:34:00.641087 [info ] [MainThread]: 
[0m17:34:00.641825 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:00.647072 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409_dbt_test'
[0m17:34:00.647631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:01.361527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66886f0d-55ed-4ced-bb1c-79e8c6a1c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809bf08e20>]}
[0m17:34:01.363767 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:34:01.364580 [info ] [MainThread]: 
[0m17:34:01.370172 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:34:01.371619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m17:34:01.372439 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:34:01.386834 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:34:01.389008 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:34:01.390052 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:34:01.390549 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:34:01.391098 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:34:01.391616 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:34:01.395186 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:34:01.396422 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:34:01.397197 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:34:01.397667 [debug] [Thread-1  ]: Began running node seed.dbt_test.stadium_cleaned
[0m17:34:01.398249 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now seed.dbt_test.stadium_cleaned)
[0m17:34:01.398676 [debug] [Thread-1  ]: Began compiling node seed.dbt_test.stadium_cleaned
[0m17:34:01.402760 [debug] [Thread-1  ]: Began executing node seed.dbt_test.stadium_cleaned
[0m17:34:01.403529 [debug] [Thread-1  ]: Finished running node seed.dbt_test.stadium_cleaned
[0m17:34:01.404011 [debug] [Thread-1  ]: Began running node test.dbt_test.not_null_customers_first_name.602d132c3b
[0m17:34:01.404489 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.dbt_test.stadium_cleaned, now test.dbt_test.not_null_customers_first_name.602d132c3b)
[0m17:34:01.404911 [debug] [Thread-1  ]: Began compiling node test.dbt_test.not_null_customers_first_name.602d132c3b
[0m17:34:01.418791 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_test.not_null_customers_first_name.602d132c3b"
[0m17:34:01.419696 [debug] [Thread-1  ]: Began executing node test.dbt_test.not_null_customers_first_name.602d132c3b
[0m17:34:01.420471 [debug] [Thread-1  ]: Finished running node test.dbt_test.not_null_customers_first_name.602d132c3b
[0m17:34:01.420939 [debug] [Thread-1  ]: Began running node test.dbt_test.not_null_customers_last_name.3900f94ffb
[0m17:34:01.421434 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_customers_first_name.602d132c3b, now test.dbt_test.not_null_customers_last_name.3900f94ffb)
[0m17:34:01.421898 [debug] [Thread-1  ]: Began compiling node test.dbt_test.not_null_customers_last_name.3900f94ffb
[0m17:34:01.426665 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_test.not_null_customers_last_name.3900f94ffb"
[0m17:34:01.427299 [debug] [Thread-1  ]: Began executing node test.dbt_test.not_null_customers_last_name.3900f94ffb
[0m17:34:01.428057 [debug] [Thread-1  ]: Finished running node test.dbt_test.not_null_customers_last_name.3900f94ffb
[0m17:34:01.428515 [debug] [Thread-1  ]: Began running node test.dbt_test.unique_customers_first_name.35a2d81a83
[0m17:34:01.428997 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_customers_last_name.3900f94ffb, now test.dbt_test.unique_customers_first_name.35a2d81a83)
[0m17:34:01.429403 [debug] [Thread-1  ]: Began compiling node test.dbt_test.unique_customers_first_name.35a2d81a83
[0m17:34:01.436560 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_test.unique_customers_first_name.35a2d81a83"
[0m17:34:01.437179 [debug] [Thread-1  ]: Began executing node test.dbt_test.unique_customers_first_name.35a2d81a83
[0m17:34:01.437923 [debug] [Thread-1  ]: Finished running node test.dbt_test.unique_customers_first_name.35a2d81a83
[0m17:34:01.438385 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:34:01.438852 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_test.unique_customers_first_name.35a2d81a83, now model.dbt_test.my_second_dbt_model)
[0m17:34:01.439264 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:34:01.442578 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:34:01.443170 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:34:01.443889 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:34:01.444345 [debug] [Thread-1  ]: Began running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:34:01.444827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_second_dbt_model, now test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:34:01.445295 [debug] [Thread-1  ]: Began compiling node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:34:01.450159 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:34:01.450860 [debug] [Thread-1  ]: Began executing node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:34:01.451613 [debug] [Thread-1  ]: Finished running node test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:34:01.452066 [debug] [Thread-1  ]: Began running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
[0m17:34:01.452541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_test.unique_my_first_dbt_model_id.16e066b321)
[0m17:34:01.452947 [debug] [Thread-1  ]: Began compiling node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
[0m17:34:01.458729 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_test.unique_my_first_dbt_model_id.16e066b321"
[0m17:34:01.459313 [debug] [Thread-1  ]: Began executing node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
[0m17:34:01.460041 [debug] [Thread-1  ]: Finished running node test.dbt_test.unique_my_first_dbt_model_id.16e066b321
[0m17:34:01.460498 [debug] [Thread-1  ]: Began running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
[0m17:34:01.460952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_test.unique_my_first_dbt_model_id.16e066b321, now test.dbt_test.not_null_my_second_dbt_model_id.151b76d778)
[0m17:34:01.461362 [debug] [Thread-1  ]: Began compiling node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
[0m17:34:01.465932 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_test.not_null_my_second_dbt_model_id.151b76d778"
[0m17:34:01.466546 [debug] [Thread-1  ]: Began executing node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
[0m17:34:01.467274 [debug] [Thread-1  ]: Finished running node test.dbt_test.not_null_my_second_dbt_model_id.151b76d778
[0m17:34:01.467735 [debug] [Thread-1  ]: Began running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
[0m17:34:01.468192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:34:01.468596 [debug] [Thread-1  ]: Began compiling node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
[0m17:34:01.473199 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:34:01.473819 [debug] [Thread-1  ]: Began executing node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
[0m17:34:01.474553 [debug] [Thread-1  ]: Finished running node test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493
[0m17:34:01.475414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:01.475743 [debug] [MainThread]: Connection 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:34:01.477738 [debug] [MainThread]: Command end result
[0m17:34:01.607579 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m17:34:01.607991 [info ] [MainThread]: Building catalog
[0m17:34:01.613680 [debug] [ThreadPool]: Acquiring new bigquery connection 'dbt-test-427409.information_schema'
[0m17:34:01.636967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:01.639294 [debug] [ThreadPool]: On dbt-test-427409.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "dbt-test-427409.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `dbt-test-427409`.`dbt_test`.__TABLES__ tables
    left join `dbt-test-427409`.`dbt_test`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `dbt-test-427409`.`dbt_test`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_test')
                            and upper(table_name) = upper('customers')
                            ) or (
                                upper(table_schema) = upper('dbt_test')
                            and upper(table_name) = upper('my_first_dbt_model')
                            ) or (
                                upper(table_schema) = upper('dbt_test')
                            and upper(table_name) = upper('my_second_dbt_model')
                            ) or (
                                upper(table_schema) = upper('dbt_test')
                            and upper(table_name) = upper('stadium_cleaned')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `dbt-test-427409`.`dbt_test`.INFORMATION_SCHEMA.COLUMNS columns
    join `dbt-test-427409`.`dbt_test`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m17:34:02.425537 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:5372495a-c84f-4058-99ea-c406f73f1f5a&page=queryresults
[0m17:34:05.495821 [info ] [MainThread]: Catalog written to /Users/tszeyenthen/dbt-test/dbt_test/target/catalog.json
[0m17:34:05.498486 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.3465133, "process_user_time": 4.618095, "process_kernel_time": 0.328342, "process_mem_max_rss": "195678208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:34:05.499385 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:34:05.499264 after 6.35 seconds
[0m17:34:05.499817 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:34:05.500156 [debug] [MainThread]: Connection 'dbt-test-427409.information_schema' was properly closed.
[0m17:34:05.500560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8098b9b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809b58e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809bce0820>]}
[0m17:34:05.501000 [debug] [MainThread]: Flushing usage events
[0m17:37:31.879673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff758de32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73830ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73830e400>]}


============================== 17:37:31.885285 | 42b2db3e-2101-48ff-9f30-fcdcabcf2e2f ==============================
[0m17:37:31.885285 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:37:31.886093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m17:37:32.950099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42b2db3e-2101-48ff-9f30-fcdcabcf2e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7695c0bb0>]}
[0m17:37:33.006677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42b2db3e-2101-48ff-9f30-fcdcabcf2e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7486e8e20>]}
[0m17:40:46.158858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a0f1b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa880afed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa880afe460>]}


============================== 17:40:46.165089 | a3519610-eb14-4bda-9ac3-1a6227f4ce2d ==============================
[0m17:40:46.165089 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:40:46.165838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:47.288061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3519610-eb14-4bda-9ac3-1a6227f4ce2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a2405c10>]}
[0m17:40:47.344915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3519610-eb14-4bda-9ac3-1a6227f4ce2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a38d6ca0>]}
[0m17:40:48.140449 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m17:40:48.144291 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m17:40:48.148071 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 2.0853271, "process_user_time": 3.90096, "process_kernel_time": 0.307754, "process_mem_max_rss": "190271488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:40:48.149702 [debug] [MainThread]: Command `dbt docs serve` failed at 17:40:48.149214 after 2.09 seconds
[0m17:40:48.150413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a0f1b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a399afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8a399a5b0>]}
[0m17:40:48.150983 [debug] [MainThread]: Flushing usage events
[0m17:43:34.408635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa430bb32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4211a6d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4211a6460>]}


============================== 17:43:34.413900 | 27ccc023-643a-47c2-919d-b4684128b157 ==============================
[0m17:43:34.413900 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:43:34.414673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m17:43:35.438507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27ccc023-643a-47c2-919d-b4684128b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa433315580>]}
[0m17:43:35.494299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27ccc023-643a-47c2-919d-b4684128b157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa431e0ffd0>]}
[0m17:43:35.719883 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m17:43:35.723241 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m17:43:35.726450 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 1.4002283, "process_user_time": 3.880595, "process_kernel_time": 0.269591, "process_mem_max_rss": "189452288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:43:35.727791 [debug] [MainThread]: Command `dbt docs serve` failed at 17:43:35.727410 after 1.40 seconds
[0m17:43:35.728438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa430bb32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa421f35eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa421f3e910>]}
[0m17:43:35.728984 [debug] [MainThread]: Flushing usage events
[0m17:45:23.592339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe8d0b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfea656d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfea656460>]}


============================== 17:45:23.597400 | 1ec22d65-11ff-4da5-8693-762fa59bd2e9 ==============================
[0m17:45:23.597400 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:45:23.598123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m17:45:24.647164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ec22d65-11ff-4da5-8693-762fa59bd2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfebda94f0>]}
[0m17:45:24.703706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ec22d65-11ff-4da5-8693-762fa59bd2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfebdf2310>]}
[0m17:45:24.927752 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m17:45:24.931737 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m17:45:24.935365 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 1.4261519, "process_user_time": 3.873583, "process_kernel_time": 0.292343, "process_mem_max_rss": "190132224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:45:24.936695 [debug] [MainThread]: Command `dbt docs serve` failed at 17:45:24.936324 after 1.43 seconds
[0m17:45:24.937341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe8d0b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfebf2ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfebf36970>]}
[0m17:45:24.937889 [debug] [MainThread]: Flushing usage events
[0m17:45:49.279443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd878b932e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd888a8ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd888a8e460>]}


============================== 17:45:49.284804 | 0600aae7-8a6a-4b3c-baa0-2fc415b21bf8 ==============================
[0m17:45:49.284804 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:45:49.285515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m17:45:50.333419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0600aae7-8a6a-4b3c-baa0-2fc415b21bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd888addf40>]}
[0m17:45:50.390101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0600aae7-8a6a-4b3c-baa0-2fc415b21bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87b49c190>]}
[0m17:46:17.391211 [error] [MainThread]: Encountered an error:

[0m17:46:17.399172 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m17:46:17.404344 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 28.207573, "process_user_time": 3.920103, "process_kernel_time": 0.290275, "process_mem_max_rss": "190410752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:46:17.406192 [debug] [MainThread]: Command `dbt docs serve` failed at 17:46:17.405628 after 28.21 seconds
[0m17:46:17.407271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd878b932e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd898312d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd898312cd0>]}
[0m17:46:17.408059 [debug] [MainThread]: Flushing usage events
[0m17:46:53.702818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8ecb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba886dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba886d460>]}


============================== 17:46:53.708465 | af5acef1-29d4-4ec3-8d17-4b4dcd4982a2 ==============================
[0m17:46:53.708465 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:46:53.709243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:46:54.806488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af5acef1-29d4-4ec3-8d17-4b4dcd4982a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba937f460>]}
[0m17:46:54.869498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af5acef1-29d4-4ec3-8d17-4b4dcd4982a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb989d1cd0>]}
[0m17:49:47.404774 [error] [MainThread]: Encountered an error:

[0m17:49:47.417821 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m17:49:47.425209 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 173.81496, "process_user_time": 3.995704, "process_kernel_time": 0.323154, "process_mem_max_rss": "190791680", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:49:47.427555 [debug] [MainThread]: Command `dbt docs serve` failed at 17:49:47.426957 after 173.82 seconds
[0m17:49:47.429039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8ecb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febbb0b5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febbb0b5b20>]}
[0m17:49:47.430034 [debug] [MainThread]: Flushing usage events
[0m16:45:34.210200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d02ab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e2c16d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e2c16460>]}


============================== 16:45:34.214456 | 7ec6ae76-7ef5-499c-bb3a-85ab590c5e24 ==============================
[0m16:45:34.214456 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:45:34.214951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:35.373590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e2be0c40>]}
[0m16:45:35.406352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e2b90040>]}
[0m16:45:35.406778 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:45:35.436115 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:45:35.519762 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:45:35.520195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d0493bb0>]}
[0m16:45:36.326960 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:45:36.327369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e4194af0>]}
[0m16:45:36.516367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b056fac0>]}
[0m16:45:36.592326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e424fd90>]}
[0m16:45:36.592720 [info ] [MainThread]: Found 4 models, 1 seed, 7 data tests, 471 macros
[0m16:45:36.592981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b045b130>]}
[0m16:45:36.594121 [info ] [MainThread]: 
[0m16:45:36.594540 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:45:36.597815 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m16:45:36.598188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:37.500500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m16:45:37.501729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:38.313481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e1677220>]}
[0m16:45:38.315579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:38.316546 [info ] [MainThread]: 
[0m16:45:38.321741 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m16:45:38.323249 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_test.customers ................................ [RUN]
[0m16:45:38.324309 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m16:45:38.325058 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m16:45:38.340234 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m16:45:38.342580 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m16:45:38.359485 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:45:39.080739 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m16:45:39.082678 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m16:45:39.958330 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:8f0277fe-bd3f-42c3-bef2-d2b692f739b4&page=queryresults
[0m16:45:43.298087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e2c16460>]}
[0m16:45:43.298973 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 4.97s]
[0m16:45:43.299710 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m16:45:43.300212 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m16:45:43.300882 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m16:45:43.301546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m16:45:43.301974 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m16:45:43.306001 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m16:45:43.308184 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m16:45:43.310923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:45:43.993416 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m16:45:43.998348 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:45:44.532327 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:cf43c136-ac22-4b06-98a0-7071a2675f01&page=queryresults
[0m16:45:47.129998 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b075c100>]}
[0m16:45:47.132286 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.83s]
[0m16:45:47.133674 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m16:45:47.134612 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m16:45:47.136543 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_test.users .................................... [RUN]
[0m16:45:47.137759 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m16:45:47.138621 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m16:45:47.146902 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m16:45:47.148021 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m16:45:47.152452 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m16:45:47.153220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:45:47.155246 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      CREATE TABLE users (
    id INTEGER NULLABLE,
    first_name STRING NULLABLE,
    last_name STRING NULLABLE,
    email STRING NULLABLE,
    age INTEGER NULLABLE,
    gender STRING NULLABLE,
    state STRING NULLABLE,
    street_address STRING NULLABLE,
    postal_code STRING NULLABLE,
    city STRING NULLABLE,
    country STRING NULLABLE,
    latitude FLOAT NULLABLE,
    longitude FLOAT NULLABLE,
    traffic_source STRING NULLABLE,
    created_at TIMESTAMP NULLABLE
);
    );
  
[0m16:45:47.843987 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:4aeb8448-0c90-43b3-a4b2-2401d26de7be&page=queryresults
[0m16:45:47.845643 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword CREATE at [13:7]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword CREATE at [13:7]')
[0m16:45:49.072439 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:b5634fc0-64f2-4926-9559-ce1b102c93c6&page=queryresults
[0m16:45:49.074477 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:b5634fc0-64f2-4926-9559-ce1b102c93c6&page=queryresults
[0m16:45:49.087003 [debug] [Thread-1  ]: Database Error in model users (models/users.sql)
  Syntax error: Unexpected keyword CREATE at [13:7]
  compiled Code at target/run/dbt_test/models/users.sql
[0m16:45:49.087875 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b06cc2e0>]}
[0m16:45:49.088953 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model dbt_test.users ........................... [[31mERROR[0m in 1.95s]
[0m16:45:49.089905 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m16:45:49.090580 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m16:45:49.091566 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m16:45:49.092343 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m16:45:49.092873 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m16:45:49.097811 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m16:45:49.098728 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m16:45:49.101871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:45:49.894250 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m16:45:49.897234 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m16:45:50.513939 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:f6601301-dfa6-46ac-9019-bafaf12e0751&page=queryresults
[0m16:45:53.579488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec6ae76-7ef5-499c-bb3a-85ab590c5e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f02fc610>]}
[0m16:45:53.581939 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.49s]
[0m16:45:53.583545 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m16:45:53.586182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:53.586816 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m16:45:53.587588 [info ] [MainThread]: 
[0m16:45:53.588647 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.99 seconds (16.99s).
[0m16:45:53.591039 [debug] [MainThread]: Command end result
[0m16:45:53.635368 [info ] [MainThread]: 
[0m16:45:53.635846 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:45:53.636148 [info ] [MainThread]: 
[0m16:45:53.636509 [error] [MainThread]:   Database Error in model users (models/users.sql)
  Syntax error: Unexpected keyword CREATE at [13:7]
  compiled Code at target/run/dbt_test/models/users.sql
[0m16:45:53.636793 [info ] [MainThread]: 
[0m16:45:53.637099 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:45:53.648605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 19.512077, "process_user_time": 4.721586, "process_kernel_time": 0.404903, "process_mem_max_rss": "202362880", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:53.649374 [debug] [MainThread]: Command `dbt run` failed at 16:45:53.649275 after 19.51 seconds
[0m16:45:53.649789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d02ab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b0721100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f02e99a0>]}
[0m16:45:53.650133 [debug] [MainThread]: Flushing usage events
[0m16:47:13.428957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c82ab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0da92dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0da92d460>]}


============================== 16:47:13.432466 | ccc0c76c-b696-4f6a-9525-9d9d2665c23c ==============================
[0m16:47:13.432466 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:47:13.432920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:47:14.327614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccc0c76c-b696-4f6a-9525-9d9d2665c23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0da90d700>]}
[0m16:47:14.359901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccc0c76c-b696-4f6a-9525-9d9d2665c23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0da8a8f40>]}
[0m16:47:14.360322 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:47:14.388111 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:47:14.495734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:47:14.496215 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/users.sql
[0m16:47:14.650290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccc0c76c-b696-4f6a-9525-9d9d2665c23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc098b7c130>]}
[0m16:47:14.725141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccc0c76c-b696-4f6a-9525-9d9d2665c23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc098ba31f0>]}
[0m16:47:14.725511 [info ] [MainThread]: Found 4 models, 1 seed, 7 data tests, 471 macros
[0m16:47:14.725772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccc0c76c-b696-4f6a-9525-9d9d2665c23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc098b876d0>]}
[0m16:47:14.727020 [info ] [MainThread]: 
[0m16:47:14.727485 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:47:14.730614 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m16:47:14.730946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:15.499859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m16:47:15.501336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:16.321796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccc0c76c-b696-4f6a-9525-9d9d2665c23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0dc933610>]}
[0m16:47:16.323129 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:47:16.323796 [info ] [MainThread]: 
[0m16:47:16.327846 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m16:47:16.328976 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_test.customers ................................ [RUN]
[0m16:47:16.329741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m16:47:16.330330 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m16:47:16.341329 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m16:47:16.342808 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m16:47:16.359609 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:47:17.181760 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m16:47:17.182795 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m16:47:17.955719 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:afec1a34-974d-4dc4-b4dd-c3e26245e244&page=queryresults
[0m16:47:21.270887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccc0c76c-b696-4f6a-9525-9d9d2665c23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0dc8d0a60>]}
[0m16:47:21.272782 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 4.94s]
[0m16:47:21.273568 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m16:47:21.274803 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m16:47:21.275681 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m16:47:21.276482 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m16:47:21.277046 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m16:47:21.281245 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m16:47:21.282600 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m16:47:21.285459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:47:21.968595 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m16:47:21.975224 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:47:22.664284 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:1b5f6436-3fcd-4ecd-9f68-74ab7c2c0461&page=queryresults
[0m16:47:25.157787 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccc0c76c-b696-4f6a-9525-9d9d2665c23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc098c3aca0>]}
[0m16:47:25.161395 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.88s]
[0m16:47:25.163260 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m16:47:25.164877 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m16:47:25.166431 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_test.users .................................... [RUN]
[0m16:47:25.167852 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m16:47:25.168767 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m16:47:25.176105 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m16:47:25.179279 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m16:47:25.186223 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m16:47:25.187490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:47:25.190508 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`;
    );
  
[0m16:47:25.941311 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:72be4857-d868-4042-a6c4-874b3e0c3a70&page=queryresults
[0m16:47:25.944529 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [14:52]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [14:52]')
[0m16:47:26.555993 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:ec6e280a-1c58-4d94-a9d3-066b7b439e2b&page=queryresults
[0m16:47:26.559388 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:ec6e280a-1c58-4d94-a9d3-066b7b439e2b&page=queryresults
[0m16:47:26.575896 [debug] [Thread-1  ]: Database Error in model users (models/users.sql)
  Syntax error: Expected ")" but got ";" at [14:52]
  compiled Code at target/run/dbt_test/models/users.sql
[0m16:47:26.577666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccc0c76c-b696-4f6a-9525-9d9d2665c23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc088064f40>]}
[0m16:47:26.579194 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model dbt_test.users ........................... [[31mERROR[0m in 1.41s]
[0m16:47:26.580397 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m16:47:26.581268 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m16:47:26.582541 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m16:47:26.583459 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m16:47:26.584141 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m16:47:26.590718 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m16:47:26.592240 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m16:47:26.596229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:47:27.372971 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m16:47:27.374093 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m16:47:28.055865 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:96bcb307-8a80-4c28-a640-49fb30c4ac28&page=queryresults
[0m16:47:30.757578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccc0c76c-b696-4f6a-9525-9d9d2665c23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b805c160>]}
[0m16:47:30.759824 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.17s]
[0m16:47:30.761551 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m16:47:30.764689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:30.765516 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m16:47:30.766478 [info ] [MainThread]: 
[0m16:47:30.767399 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.04 seconds (16.04s).
[0m16:47:30.770582 [debug] [MainThread]: Command end result
[0m16:47:30.819722 [info ] [MainThread]: 
[0m16:47:30.820254 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:47:30.820580 [info ] [MainThread]: 
[0m16:47:30.821267 [error] [MainThread]:   Database Error in model users (models/users.sql)
  Syntax error: Expected ")" but got ";" at [14:52]
  compiled Code at target/run/dbt_test/models/users.sql
[0m16:47:30.821692 [info ] [MainThread]: 
[0m16:47:30.822140 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:47:30.825250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.451817, "process_user_time": 3.985947, "process_kernel_time": 0.316658, "process_mem_max_rss": "193130496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:47:30.825958 [debug] [MainThread]: Command `dbt run` failed at 16:47:30.825866 after 17.45 seconds
[0m16:47:30.826415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c82ab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0da8a8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0dc8f9430>]}
[0m16:47:30.826758 [debug] [MainThread]: Flushing usage events
[0m17:05:16.265758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c10eb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c2a8ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c2a8e400>]}


============================== 17:05:16.269453 | 467790ce-89d5-4201-a672-8d0b8b336c3d ==============================
[0m17:05:16.269453 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:05:16.269972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:17.200581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '467790ce-89d5-4201-a672-8d0b8b336c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98b0794ee0>]}
[0m17:05:17.232734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '467790ce-89d5-4201-a672-8d0b8b336c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d03d48b0>]}
[0m17:05:17.233159 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:05:17.256276 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:05:17.363631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:17.364090 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/users.sql
[0m17:05:17.517621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '467790ce-89d5-4201-a672-8d0b8b336c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98b0cfb130>]}
[0m17:05:17.593238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '467790ce-89d5-4201-a672-8d0b8b336c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98b0d23250>]}
[0m17:05:17.593609 [info ] [MainThread]: Found 4 models, 1 seed, 7 data tests, 471 macros
[0m17:05:17.593883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '467790ce-89d5-4201-a672-8d0b8b336c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98b0d09610>]}
[0m17:05:17.595106 [info ] [MainThread]: 
[0m17:05:17.595554 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:05:17.598930 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:05:17.599305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:18.586503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:05:18.587981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:19.308342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '467790ce-89d5-4201-a672-8d0b8b336c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c14224c0>]}
[0m17:05:19.310311 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:19.311113 [info ] [MainThread]: 
[0m17:05:19.316215 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:05:19.317723 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_test.customers ................................ [RUN]
[0m17:05:19.318724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m17:05:19.319480 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:05:19.331893 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:05:19.333655 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:05:19.351070 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:05:20.064771 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:05:20.065835 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:05:20.835920 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:4ea7d592-c556-4593-b5f3-5303ccc9ef4b&page=queryresults
[0m17:05:24.464494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '467790ce-89d5-4201-a672-8d0b8b336c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c475f0a0>]}
[0m17:05:24.466227 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 5.14s]
[0m17:05:24.467182 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:05:24.467834 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:05:24.468639 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:05:24.469315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:05:24.469787 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:05:24.473893 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:05:24.474685 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:05:24.477546 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:05:25.277134 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:05:25.281123 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:05:25.960164 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:782f6e27-179e-4ab8-88aa-f0236925add7&page=queryresults
[0m17:05:28.459881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '467790ce-89d5-4201-a672-8d0b8b336c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d04495e0>]}
[0m17:05:28.462867 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.99s]
[0m17:05:28.465546 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:05:28.467815 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:05:28.470251 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_test.users .................................... [RUN]
[0m17:05:28.471769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m17:05:28.472700 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:05:28.479354 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:05:28.481131 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:05:28.485608 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:05:28.486253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:05:28.488631 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      -- Query 1: Select data from existing table
SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`;

-- Query 2: Create a new table
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL,
    age INTEGER,
    gender VARCHAR(10),
    state VARCHAR(50),
    street_address VARCHAR(100),
    postal_code VARCHAR(20),
    city VARCHAR(50),
    country VARCHAR(50),
    latitude FLOAT,
    longitude FLOAT,
    traffic_source VARCHAR(50),
    created_at TIMESTAMP
);
    );
  
[0m17:05:29.146621 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:22440f60-f701-4f80-aff1-1949e074cc7f&page=queryresults
[0m17:05:29.149832 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [15:52]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [15:52]')
[0m17:05:30.033133 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9a8b1922-ea78-4c40-bb95-bc7def3f3085&page=queryresults
[0m17:05:30.034833 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9a8b1922-ea78-4c40-bb95-bc7def3f3085&page=queryresults
[0m17:05:30.115468 [debug] [Thread-1  ]: Database Error in model users (models/users.sql)
  Syntax error: Expected ")" but got ";" at [15:52]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:05:30.117801 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '467790ce-89d5-4201-a672-8d0b8b336c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9898071d60>]}
[0m17:05:30.120437 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model dbt_test.users ........................... [[31mERROR[0m in 1.65s]
[0m17:05:30.121675 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:05:30.158105 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:05:30.159067 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:05:30.159764 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:05:30.166493 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:05:30.251898 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:05:30.253006 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:05:30.255825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:05:30.975920 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:05:30.979482 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:05:31.689393 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:b6c9459f-a497-421b-8766-8c63914a0af0&page=queryresults
[0m17:05:33.945484 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '467790ce-89d5-4201-a672-8d0b8b336c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989809c0a0>]}
[0m17:05:33.947256 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 3.79s]
[0m17:05:33.948579 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:05:33.951319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:33.951836 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:05:33.952677 [info ] [MainThread]: 
[0m17:05:33.953275 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.36 seconds (16.36s).
[0m17:05:33.955338 [debug] [MainThread]: Command end result
[0m17:05:33.997137 [info ] [MainThread]: 
[0m17:05:33.997615 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:05:33.997913 [info ] [MainThread]: 
[0m17:05:33.998393 [error] [MainThread]:   Database Error in model users (models/users.sql)
  Syntax error: Expected ")" but got ";" at [15:52]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:05:33.998687 [info ] [MainThread]: 
[0m17:05:33.999002 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:05:34.002287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.798801, "process_user_time": 3.93822, "process_kernel_time": 0.390259, "process_mem_max_rss": "194994176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:05:34.002902 [debug] [MainThread]: Command `dbt run` failed at 17:05:34.002821 after 17.80 seconds
[0m17:05:34.003297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c10eb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c471d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98b099b4c0>]}
[0m17:05:34.003592 [debug] [MainThread]: Flushing usage events
[0m17:05:53.553001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9930dc32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f994066ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f994066e430>]}


============================== 17:05:53.556558 | 0ab09e46-77d9-4ef7-8029-7bf959f2d051 ==============================
[0m17:05:53.556558 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:05:53.557008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:05:54.410760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ab09e46-77d9-4ef7-8029-7bf959f2d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9940ac9820>]}
[0m17:05:54.442800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ab09e46-77d9-4ef7-8029-7bf959f2d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993271d670>]}
[0m17:05:54.443205 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:05:54.463156 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:05:54.572412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:05:54.572757 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:05:54.608896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ab09e46-77d9-4ef7-8029-7bf959f2d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993454a130>]}
[0m17:05:54.685004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ab09e46-77d9-4ef7-8029-7bf959f2d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9940b37d60>]}
[0m17:05:54.685380 [info ] [MainThread]: Found 4 models, 1 seed, 7 data tests, 471 macros
[0m17:05:54.685650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ab09e46-77d9-4ef7-8029-7bf959f2d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9940b7ba00>]}
[0m17:05:54.686834 [info ] [MainThread]: 
[0m17:05:54.687278 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:05:54.690395 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:05:54.690729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:55.450752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:05:55.452486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:56.269856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ab09e46-77d9-4ef7-8029-7bf959f2d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993276bf40>]}
[0m17:05:56.271785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:56.272640 [info ] [MainThread]: 
[0m17:05:56.279361 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:05:56.280642 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_test.customers ................................ [RUN]
[0m17:05:56.281723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m17:05:56.282474 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:05:56.297805 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:05:56.298651 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:05:56.317105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:05:57.079438 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:05:57.080366 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:05:57.905605 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:dd7740a7-cab9-40c3-858a-d34d37a8ef1c&page=queryresults
[0m17:06:01.622442 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab09e46-77d9-4ef7-8029-7bf959f2d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9940a58520>]}
[0m17:06:01.623314 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 5.34s]
[0m17:06:01.624073 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:06:01.624582 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:06:01.625236 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:06:01.625842 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:06:01.626251 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:06:01.629482 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:06:01.630148 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:06:01.632815 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:06:02.412104 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:06:02.414481 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:06:03.024885 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:3c8dd230-8fdf-45d0-9831-c3d38c3fbe75&page=queryresults
[0m17:06:05.409162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab09e46-77d9-4ef7-8029-7bf959f2d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e006de20>]}
[0m17:06:05.411051 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.78s]
[0m17:06:05.412332 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:06:05.413295 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:06:05.414408 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_test.users .................................... [RUN]
[0m17:06:05.415639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m17:06:05.416400 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:06:05.421151 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:06:05.422235 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:06:05.426664 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:06:05.427428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:06:05.429497 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      -- Query 1: Select data from existing table
SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`;

-- Query 2: Create a new table
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL,
    age INTEGER,
    gender VARCHAR(10),
    state VARCHAR(50),
    street_address VARCHAR(100),
    postal_code VARCHAR(20),
    city VARCHAR(50),
    country VARCHAR(50),
    latitude FLOAT,
    longitude FLOAT,
    traffic_source VARCHAR(50),
    created_at TIMESTAMP
);
    );
  
[0m17:06:06.096428 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:64187a96-0910-4fb5-9441-f1392d666b00&page=queryresults
[0m17:06:06.098911 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [15:52]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [15:52]')
[0m17:06:06.999529 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:ea01b8d8-653f-4a6c-892f-b73fa3be9e76&page=queryresults
[0m17:06:07.001606 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:ea01b8d8-653f-4a6c-892f-b73fa3be9e76&page=queryresults
[0m17:06:07.015952 [debug] [Thread-1  ]: Database Error in model users (models/users.sql)
  Syntax error: Expected ")" but got ";" at [15:52]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:06:07.016928 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab09e46-77d9-4ef7-8029-7bf959f2d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9934683190>]}
[0m17:06:07.017804 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model dbt_test.users ........................... [[31mERROR[0m in 1.60s]
[0m17:06:07.018608 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:06:07.019175 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:06:07.019914 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:06:07.020561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:06:07.021057 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:06:07.025187 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:06:07.025931 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:06:07.028915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:06:07.838998 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:06:07.841838 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:06:08.553509 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:06889279-8e6e-4442-b3f3-28b358e79d7e&page=queryresults
[0m17:06:10.940113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab09e46-77d9-4ef7-8029-7bf959f2d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9934683820>]}
[0m17:06:10.941505 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 3.92s]
[0m17:06:10.942928 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:06:10.945102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:10.945826 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:06:10.946583 [info ] [MainThread]: 
[0m17:06:10.947259 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.26 seconds (16.26s).
[0m17:06:10.948967 [debug] [MainThread]: Command end result
[0m17:06:10.985974 [info ] [MainThread]: 
[0m17:06:10.986416 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:06:10.986707 [info ] [MainThread]: 
[0m17:06:10.987058 [error] [MainThread]:   Database Error in model users (models/users.sql)
  Syntax error: Expected ")" but got ";" at [15:52]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:06:10.987341 [info ] [MainThread]: 
[0m17:06:10.987631 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:06:10.989777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.496655, "process_user_time": 3.883035, "process_kernel_time": 0.259374, "process_mem_max_rss": "192548864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:06:10.990330 [debug] [MainThread]: Command `dbt run` failed at 17:06:10.990249 after 17.50 seconds
[0m17:06:10.990689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9930dc32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99324de5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993457e520>]}
[0m17:06:10.991006 [debug] [MainThread]: Flushing usage events
[0m17:07:43.305591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe218feb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21a93dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21a93d460>]}


============================== 17:07:43.309088 | 9973b807-5a3f-416d-8310-aed738f64221 ==============================
[0m17:07:43.309088 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:07:43.309565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:07:44.206715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9973b807-5a3f-416d-8310-aed738f64221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21c025370>]}
[0m17:07:44.239190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9973b807-5a3f-416d-8310-aed738f64221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2089f1670>]}
[0m17:07:44.239597 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:07:44.262431 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:07:44.370131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:44.370446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:44.406549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9973b807-5a3f-416d-8310-aed738f64221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21c641130>]}
[0m17:07:44.483692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9973b807-5a3f-416d-8310-aed738f64221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21c651eb0>]}
[0m17:07:44.484060 [info ] [MainThread]: Found 4 models, 1 seed, 7 data tests, 471 macros
[0m17:07:44.484327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9973b807-5a3f-416d-8310-aed738f64221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e05bb760>]}
[0m17:07:44.485529 [info ] [MainThread]: 
[0m17:07:44.486033 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:07:44.489420 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:07:44.489756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:45.222365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:07:45.224062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:45.939154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9973b807-5a3f-416d-8310-aed738f64221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21c671280>]}
[0m17:07:45.940958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:45.941724 [info ] [MainThread]: 
[0m17:07:45.946873 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:07:45.948116 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_test.customers ................................ [RUN]
[0m17:07:45.949215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m17:07:45.950116 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:07:45.964197 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:07:45.965532 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:07:45.983638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:07:46.795712 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:07:46.797635 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:07:47.575952 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:87a860a8-cbe2-4c6f-80bd-b2094b370348&page=queryresults
[0m17:07:51.223870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9973b807-5a3f-416d-8310-aed738f64221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21c01f430>]}
[0m17:07:51.224856 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 5.27s]
[0m17:07:51.225657 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:07:51.226149 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:07:51.226784 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:07:51.227358 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:07:51.227767 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:07:51.231287 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:07:51.232860 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:07:51.235313 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:07:51.879859 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:07:51.883209 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:07:52.490600 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:10c61e1a-be20-4bef-b53b-eef136ab17d8&page=queryresults
[0m17:07:54.748298 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9973b807-5a3f-416d-8310-aed738f64221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e809fd30>]}
[0m17:07:54.750572 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.52s]
[0m17:07:54.751969 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:07:54.752986 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:07:54.754131 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_test.users .................................... [RUN]
[0m17:07:54.755643 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m17:07:54.756586 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:07:54.762094 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:07:54.764851 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:07:54.769626 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:07:54.770442 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:07:54.772524 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      -- Query 1: Select data from existing table
SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`;

-- Query 2: Create a new table
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL,
    age INTEGER,
    gender VARCHAR(10),
    state VARCHAR(50),
    street_address VARCHAR(100),
    postal_code VARCHAR(20),
    city VARCHAR(50),
    country VARCHAR(50),
    latitude FLOAT,
    longitude FLOAT,
    traffic_source VARCHAR(50),
    created_at TIMESTAMP
);
    );
  
[0m17:07:55.459702 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:2ef9ca47-5c8c-475f-b730-caf403f46ce0&page=queryresults
[0m17:07:55.461764 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [15:52]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [15:52]')
[0m17:07:56.118120 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:5429706e-f50e-4b53-a4a2-84ab67c3a53d&page=queryresults
[0m17:07:56.121245 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:5429706e-f50e-4b53-a4a2-84ab67c3a53d&page=queryresults
[0m17:07:56.137135 [debug] [Thread-1  ]: Database Error in model users (models/users.sql)
  Syntax error: Expected ")" but got ";" at [15:52]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:07:56.138047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9973b807-5a3f-416d-8310-aed738f64221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe208c550a0>]}
[0m17:07:56.139102 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model dbt_test.users ........................... [[31mERROR[0m in 1.38s]
[0m17:07:56.140040 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:07:56.140616 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:07:56.141340 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:07:56.141979 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:07:56.142458 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:07:56.147083 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:07:56.147866 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:07:56.150862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:07:56.816066 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:07:56.818893 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:07:57.503154 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:1fa57ead-b6c9-4756-961a-b64f39009854&page=queryresults
[0m17:08:00.256456 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9973b807-5a3f-416d-8310-aed738f64221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe208c55790>]}
[0m17:08:00.258436 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.11s]
[0m17:08:00.259692 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:08:00.262006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:00.262595 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:08:00.263208 [info ] [MainThread]: 
[0m17:08:00.263757 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.78 seconds (15.78s).
[0m17:08:00.265685 [debug] [MainThread]: Command end result
[0m17:08:00.304383 [info ] [MainThread]: 
[0m17:08:00.304832 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:08:00.305119 [info ] [MainThread]: 
[0m17:08:00.305471 [error] [MainThread]:   Database Error in model users (models/users.sql)
  Syntax error: Expected ")" but got ";" at [15:52]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:08:00.305746 [info ] [MainThread]: 
[0m17:08:00.306034 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:08:00.307912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.065075, "process_user_time": 3.836202, "process_kernel_time": 0.290766, "process_mem_max_rss": "192950272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:08:00.308456 [debug] [MainThread]: Command `dbt run` failed at 17:08:00.308376 after 17.07 seconds
[0m17:08:00.308813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe218feb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2089f1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21895e400>]}
[0m17:08:00.309124 [debug] [MainThread]: Flushing usage events
[0m17:08:24.104681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd09f32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf09b92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf09b9c10>]}


============================== 17:08:24.107932 | c99335ee-76a4-4f94-b8bc-47cb2a09d515 ==============================
[0m17:08:24.107932 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:08:24.108403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:08:24.969579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c99335ee-76a4-4f94-b8bc-47cb2a09d515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf0f0be50>]}
[0m17:08:25.001925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c99335ee-76a4-4f94-b8bc-47cb2a09d515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf1122160>]}
[0m17:08:25.002345 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:08:25.025775 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:08:25.130291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:25.130591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:25.166395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c99335ee-76a4-4f94-b8bc-47cb2a09d515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd40ea130>]}
[0m17:08:25.241458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c99335ee-76a4-4f94-b8bc-47cb2a09d515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf135b400>]}
[0m17:08:25.241834 [info ] [MainThread]: Found 4 models, 1 seed, 7 data tests, 471 macros
[0m17:08:25.242104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99335ee-76a4-4f94-b8bc-47cb2a09d515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf133b790>]}
[0m17:08:25.243310 [info ] [MainThread]: 
[0m17:08:25.243820 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:08:25.247241 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:08:25.247556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:25.979438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:08:25.981255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:26.677411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99335ee-76a4-4f94-b8bc-47cb2a09d515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd2475130>]}
[0m17:08:26.679405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:26.680315 [info ] [MainThread]: 
[0m17:08:26.687236 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:08:26.688483 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_test.customers ................................ [RUN]
[0m17:08:26.689548 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m17:08:26.690317 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:08:26.705499 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:08:26.706748 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:08:26.725038 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:08:27.559701 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:08:27.560701 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:08:28.266938 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:060d0dd8-3a89-46b0-904c-fb542711c64e&page=queryresults
[0m17:08:31.945454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99335ee-76a4-4f94-b8bc-47cb2a09d515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf0e936a0>]}
[0m17:08:31.946429 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 5.26s]
[0m17:08:31.947211 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:08:31.947792 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:08:31.948479 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:08:31.949136 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:08:31.949612 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:08:31.953094 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:08:31.953761 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:08:31.956375 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:08:32.737037 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:08:32.739929 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:08:33.347442 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:879ad98d-65c8-4d07-ba13-ad4e07644b56&page=queryresults
[0m17:08:35.501650 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99335ee-76a4-4f94-b8bc-47cb2a09d515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c9001eeb0>]}
[0m17:08:35.503709 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.55s]
[0m17:08:35.505306 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:08:35.506309 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:08:35.507470 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_test.users .................................... [RUN]
[0m17:08:35.508725 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m17:08:35.509451 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:08:35.514227 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:08:35.515191 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:08:35.519544 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:08:35.520266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:08:35.522276 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      -- Query 1: Select data from existing table
SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`;

-- Query 2: Create a new table
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL,
    age INTEGER,
    gender VARCHAR(10),
    state VARCHAR(50),
    street_address VARCHAR(100),
    postal_code VARCHAR(20),
    city VARCHAR(50),
    country VARCHAR(50),
    latitude FLOAT,
    longitude FLOAT,
    traffic_source VARCHAR(50),
    created_at TIMESTAMP
);
    );
  
[0m17:08:36.193119 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:2cacccde-09f0-4d7e-bea4-3c3fa7e33d96&page=queryresults
[0m17:08:36.195276 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [15:52]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [15:52]')
[0m17:08:37.033797 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:b141f3b0-9186-445c-bf4e-8a87e1a5dcfd&page=queryresults
[0m17:08:37.035843 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:b141f3b0-9186-445c-bf4e-8a87e1a5dcfd&page=queryresults
[0m17:08:37.051713 [debug] [Thread-1  ]: Database Error in model users (models/users.sql)
  Syntax error: Expected ")" but got ";" at [15:52]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:08:37.052628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99335ee-76a4-4f94-b8bc-47cb2a09d515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd4268040>]}
[0m17:08:37.053682 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model dbt_test.users ........................... [[31mERROR[0m in 1.54s]
[0m17:08:37.054563 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:08:37.055160 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:08:37.055890 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:08:37.056551 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:08:37.057044 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:08:37.061509 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:08:37.062284 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:08:37.065332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:08:37.723222 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:08:37.726032 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:08:38.368704 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:4f22e796-1869-4d9f-922b-10e566838135&page=queryresults
[0m17:08:40.791803 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99335ee-76a4-4f94-b8bc-47cb2a09d515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd4268100>]}
[0m17:08:40.794024 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 3.74s]
[0m17:08:40.795689 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:08:40.803084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:40.805053 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:08:40.806253 [info ] [MainThread]: 
[0m17:08:40.807105 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.56 seconds (15.56s).
[0m17:08:40.809798 [debug] [MainThread]: Command end result
[0m17:08:40.857201 [info ] [MainThread]: 
[0m17:08:40.857829 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:08:40.858168 [info ] [MainThread]: 
[0m17:08:40.858540 [error] [MainThread]:   Database Error in model users (models/users.sql)
  Syntax error: Expected ")" but got ";" at [15:52]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:08:40.858829 [info ] [MainThread]: 
[0m17:08:40.859138 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:08:40.861684 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.81021, "process_user_time": 3.913015, "process_kernel_time": 0.252822, "process_mem_max_rss": "196096000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:08:40.862315 [debug] [MainThread]: Command `dbt run` failed at 17:08:40.862220 after 16.81 seconds
[0m17:08:40.862740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd09f32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf135ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf1122160>]}
[0m17:08:40.863107 [debug] [MainThread]: Flushing usage events
[0m17:10:40.627067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8e1b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ba636d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ba6364c0>]}


============================== 17:10:40.630818 | 8ba1172a-0e5b-4d1a-9bb3-14c88c47cbaa ==============================
[0m17:10:40.630818 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:10:40.631281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:41.548535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ba1172a-0e5b-4d1a-9bb3-14c88c47cbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a8876bb0>]}
[0m17:10:41.580965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ba1172a-0e5b-4d1a-9bb3-14c88c47cbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ba5e1cd0>]}
[0m17:10:41.581385 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:10:41.606543 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:10:41.713030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:41.713503 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/users.sql
[0m17:10:41.866233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ba1172a-0e5b-4d1a-9bb3-14c88c47cbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bc590dc0>]}
[0m17:10:41.940430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ba1172a-0e5b-4d1a-9bb3-14c88c47cbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bc592280>]}
[0m17:10:41.940790 [info ] [MainThread]: Found 4 models, 1 seed, 7 data tests, 471 macros
[0m17:10:41.941059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ba1172a-0e5b-4d1a-9bb3-14c88c47cbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bc578fa0>]}
[0m17:10:41.942286 [info ] [MainThread]: 
[0m17:10:41.942720 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:10:41.945856 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:10:41.946175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:42.683250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:10:42.684770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:43.399607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ba1172a-0e5b-4d1a-9bb3-14c88c47cbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bc4ecee0>]}
[0m17:10:43.401408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:43.402177 [info ] [MainThread]: 
[0m17:10:43.406950 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:10:43.408436 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_test.customers ................................ [RUN]
[0m17:10:43.409432 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m17:10:43.410178 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:10:43.422509 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:10:43.424208 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:10:43.441072 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:10:44.256561 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:10:44.257692 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:10:45.036623 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:ba81b064-7d90-4b19-a009-4f9a51ce5e14&page=queryresults
[0m17:10:48.758417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba1172a-0e5b-4d1a-9bb3-14c88c47cbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bc530b50>]}
[0m17:10:48.759393 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 5.35s]
[0m17:10:48.760275 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:10:48.760898 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:10:48.761577 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:10:48.762276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:10:48.762778 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:10:48.766296 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:10:48.767038 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:10:48.769740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:10:49.543744 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:10:49.546948 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:10:50.050742 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:d93354b1-48e1-4925-b89b-acccd39e1d4f&page=queryresults
[0m17:10:52.512900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba1172a-0e5b-4d1a-9bb3-14c88c47cbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bc5acd00>]}
[0m17:10:52.515174 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.75s]
[0m17:10:52.516849 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:10:52.517935 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:10:52.519146 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_test.users .................................... [RUN]
[0m17:10:52.520423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m17:10:52.521470 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:10:52.526371 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:10:52.528531 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:10:52.533460 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:10:52.534285 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:10:52.536370 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      CREATE TABLE users
AS
SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`;
    );
  
[0m17:10:53.227330 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:dc9f0978-e002-4951-a823-329c9b3e0fc0&page=queryresults
[0m17:10:53.229827 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword CREATE at [13:7]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword CREATE at [13:7]')
[0m17:10:54.658454 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:585628f4-6b77-4c95-ac02-febe83b0ef71&page=queryresults
[0m17:10:54.660600 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:585628f4-6b77-4c95-ac02-febe83b0ef71&page=queryresults
[0m17:10:54.673215 [debug] [Thread-1  ]: Database Error in model users (models/users.sql)
  Syntax error: Unexpected keyword CREATE at [13:7]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:10:54.674162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba1172a-0e5b-4d1a-9bb3-14c88c47cbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc688081c70>]}
[0m17:10:54.675245 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model dbt_test.users ........................... [[31mERROR[0m in 2.15s]
[0m17:10:54.676203 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:10:54.676868 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:10:54.677739 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:10:54.678508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:10:54.679006 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:10:54.683813 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:10:54.684837 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:10:54.687884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:10:55.481667 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:10:55.484106 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:10:56.196710 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:1bfc40b0-7a7f-4a6a-bc00-3da32280f865&page=queryresults
[0m17:10:58.760498 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba1172a-0e5b-4d1a-9bb3-14c88c47cbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bc5acfd0>]}
[0m17:10:58.762453 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.08s]
[0m17:10:58.763915 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:10:58.766062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:58.766777 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:10:58.767564 [info ] [MainThread]: 
[0m17:10:58.768256 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.82 seconds (16.82s).
[0m17:10:58.770468 [debug] [MainThread]: Command end result
[0m17:10:58.808555 [info ] [MainThread]: 
[0m17:10:58.808977 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:10:58.809299 [info ] [MainThread]: 
[0m17:10:58.809685 [error] [MainThread]:   Database Error in model users (models/users.sql)
  Syntax error: Unexpected keyword CREATE at [13:7]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:10:58.809971 [info ] [MainThread]: 
[0m17:10:58.810270 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:10:58.812257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 18.241968, "process_user_time": 3.93922, "process_kernel_time": 0.288033, "process_mem_max_rss": "196403200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:10:58.812804 [debug] [MainThread]: Command `dbt run` failed at 17:10:58.812727 after 18.24 seconds
[0m17:10:58.813162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8e1b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bc3912b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ba5e1cd0>]}
[0m17:10:58.813476 [debug] [MainThread]: Flushing usage events
[0m17:13:39.720518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c11932e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c29e5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c29e5520>]}


============================== 17:13:39.724016 | 9df23917-bbfa-4661-bfef-65c20cdeb462 ==============================
[0m17:13:39.724016 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:13:39.724529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:13:40.615685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9df23917-bbfa-4661-bfef-65c20cdeb462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c146bf10>]}
[0m17:13:40.648127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9df23917-bbfa-4661-bfef-65c20cdeb462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c1da12e0>]}
[0m17:13:40.648560 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:13:40.667024 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:13:40.774971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:13:40.775434 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/users.sql
[0m17:13:40.928314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9df23917-bbfa-4661-bfef-65c20cdeb462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c4918130>]}
[0m17:13:41.003540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9df23917-bbfa-4661-bfef-65c20cdeb462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c494c5e0>]}
[0m17:13:41.003911 [info ] [MainThread]: Found 4 models, 1 seed, 7 data tests, 471 macros
[0m17:13:41.004195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9df23917-bbfa-4661-bfef-65c20cdeb462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c492a4c0>]}
[0m17:13:41.005415 [info ] [MainThread]: 
[0m17:13:41.005934 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:13:41.009047 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:13:41.009383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:41.882954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:13:41.884536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:42.924802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9df23917-bbfa-4661-bfef-65c20cdeb462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c472cb50>]}
[0m17:13:42.926508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:42.927273 [info ] [MainThread]: 
[0m17:13:42.932400 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:13:42.933612 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_test.customers ................................ [RUN]
[0m17:13:42.934435 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m17:13:42.935070 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:13:42.946502 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:13:42.947988 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:13:42.964440 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:13:43.760853 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:13:43.761712 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:13:44.543050 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:3d24ed5d-8e88-42ed-96ee-d5dbe135a83d&page=queryresults
[0m17:13:48.611674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df23917-bbfa-4661-bfef-65c20cdeb462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c48e4040>]}
[0m17:13:48.613177 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 5.68s]
[0m17:13:48.614081 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:13:48.614755 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:13:48.615555 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:13:48.616319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:13:48.616871 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:13:48.621421 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:13:48.623344 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:13:48.626652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:13:49.257167 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:13:49.259442 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:13:49.816396 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9e5525c5-de8e-43c7-8b43-a66c747c52ca&page=queryresults
[0m17:13:52.337628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df23917-bbfa-4661-bfef-65c20cdeb462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b0b24d60>]}
[0m17:13:52.339891 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.72s]
[0m17:13:52.341395 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:13:52.342495 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:13:52.343674 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_test.users .................................... [RUN]
[0m17:13:52.345868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m17:13:52.346722 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:13:52.351882 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:13:52.354398 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:13:52.359291 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:13:52.360156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:13:52.362427 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      CREATE TABLE dbt-test-427409.dbt_test.users
AS
SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`;
    );
  
[0m17:13:52.977632 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:1bf3dd4f-6745-47d3-a653-c95e983c5d0e&page=queryresults
[0m17:13:52.979902 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword CREATE at [13:7]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword CREATE at [13:7]')
[0m17:13:53.909495 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9d997b8e-3fe8-4fbf-8316-fdc106c181e3&page=queryresults
[0m17:13:53.911698 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9d997b8e-3fe8-4fbf-8316-fdc106c181e3&page=queryresults
[0m17:13:53.931333 [debug] [Thread-1  ]: Database Error in model users (models/users.sql)
  Syntax error: Unexpected keyword CREATE at [13:7]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:13:53.932106 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df23917-bbfa-4661-bfef-65c20cdeb462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b0bbda60>]}
[0m17:13:53.932784 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model dbt_test.users ........................... [[31mERROR[0m in 1.59s]
[0m17:13:53.933410 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:13:53.933899 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:13:53.934738 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:13:53.935374 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:13:53.935860 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:13:53.939558 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:13:53.940323 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:13:53.943563 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:13:54.684315 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:13:54.685540 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:13:55.601067 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:b922278c-7462-4c66-885f-6096f33d29f1&page=queryresults
[0m17:13:57.980907 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df23917-bbfa-4661-bfef-65c20cdeb462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c48e4040>]}
[0m17:13:57.983423 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.04s]
[0m17:13:57.984694 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:13:57.987558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:57.988201 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:13:57.988959 [info ] [MainThread]: 
[0m17:13:57.989475 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.98 seconds (16.98s).
[0m17:13:57.991234 [debug] [MainThread]: Command end result
[0m17:13:58.031609 [info ] [MainThread]: 
[0m17:13:58.032103 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:13:58.032395 [info ] [MainThread]: 
[0m17:13:58.032773 [error] [MainThread]:   Database Error in model users (models/users.sql)
  Syntax error: Unexpected keyword CREATE at [13:7]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:13:58.033042 [info ] [MainThread]: 
[0m17:13:58.033338 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:13:58.036399 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 18.373667, "process_user_time": 3.931039, "process_kernel_time": 0.312956, "process_mem_max_rss": "195313664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:13:58.037031 [debug] [MainThread]: Command `dbt run` failed at 17:13:58.036947 after 18.37 seconds
[0m17:13:58.037451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c11932e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c146bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c15a8370>]}
[0m17:13:58.037767 [debug] [MainThread]: Flushing usage events
[0m17:16:17.962326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9992132e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97866dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97866d4f0>]}


============================== 17:16:17.966133 | 828f78f1-e9da-45d2-894e-24da14fba8c5 ==============================
[0m17:16:17.966133 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:16:17.966653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:16:18.893101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd99a2171f0>]}
[0m17:16:18.925956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd998af0d30>]}
[0m17:16:18.926383 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:16:18.951560 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:16:19.032454 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:16:19.032865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd99995ba90>]}
[0m17:16:19.831177 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:16:19.831595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd99bda0af0>]}
[0m17:16:20.017586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989296610>]}
[0m17:16:20.094137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989005730>]}
[0m17:16:20.094561 [info ] [MainThread]: Found 4 models, 1 seed, 7 data tests, 471 macros
[0m17:16:20.094829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989021c70>]}
[0m17:16:20.095992 [info ] [MainThread]: 
[0m17:16:20.096429 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:16:20.099529 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:16:20.099865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:20.913123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:16:20.914830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:21.623591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd99b605c10>]}
[0m17:16:21.624369 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:21.624802 [info ] [MainThread]: 
[0m17:16:21.628007 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:16:21.628751 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_test.customers ................................ [RUN]
[0m17:16:21.629400 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m17:16:21.629885 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:16:21.639995 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:16:21.641420 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:16:21.654990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:22.484577 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:16:22.486813 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:16:23.262920 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:331231e8-f65e-4590-8be9-9e66016d4903&page=queryresults
[0m17:16:46.661921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd99bced2b0>]}
[0m17:16:46.664699 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 25.03s]
[0m17:16:46.665801 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:16:46.666456 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:16:46.667271 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:16:46.667797 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:16:46.668187 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:16:46.676947 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:16:46.678036 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:16:46.680700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:47.309363 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:16:47.312320 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:16:47.878952 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:f0814078-6937-4ae5-8966-8501d5438715&page=queryresults
[0m17:16:50.194070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9891d2ee0>]}
[0m17:16:50.195544 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.53s]
[0m17:16:50.196620 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:16:50.197337 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:16:50.198602 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_test.users .................................... [RUN]
[0m17:16:50.199462 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m17:16:50.200198 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:16:50.207403 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:16:50.209520 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:16:50.213003 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:16:50.213683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:50.215493 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      CREATE TABLE dbt-test-427409.dbt_test.users
AS
SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`;
    );
  
[0m17:16:50.882614 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:6150eae1-b94a-44b1-a840-621cebe2aa9b&page=queryresults
[0m17:16:50.884756 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword CREATE at [13:7]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword CREATE at [13:7]')
[0m17:16:51.338473 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:50cad7d7-f8ae-4ce7-aeda-a3522da46a7f&page=queryresults
[0m17:16:51.340485 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:50cad7d7-f8ae-4ce7-aeda-a3522da46a7f&page=queryresults
[0m17:16:51.363976 [debug] [Thread-1  ]: Database Error in model users (models/users.sql)
  Syntax error: Unexpected keyword CREATE at [13:7]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:16:51.364684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd95058d5b0>]}
[0m17:16:51.365325 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model dbt_test.users ........................... [[31mERROR[0m in 1.17s]
[0m17:16:51.365934 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:16:51.366315 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:16:51.366976 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:16:51.367494 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:16:51.367828 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:16:51.371595 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:16:51.372270 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:16:51.374587 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:52.033097 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:16:52.035774 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:16:52.753853 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:18b90c91-e0f0-4b70-a0b1-01c1ee358e29&page=queryresults
[0m17:16:55.421590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828f78f1-e9da-45d2-894e-24da14fba8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd95056a760>]}
[0m17:16:55.423084 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.05s]
[0m17:16:55.424332 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:16:55.427399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:55.428044 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:16:55.428792 [info ] [MainThread]: 
[0m17:16:55.429407 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 35.33 seconds (35.33s).
[0m17:16:55.431549 [debug] [MainThread]: Command end result
[0m17:16:55.473599 [info ] [MainThread]: 
[0m17:16:55.474057 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:16:55.474347 [info ] [MainThread]: 
[0m17:16:55.474689 [error] [MainThread]:   Database Error in model users (models/users.sql)
  Syntax error: Unexpected keyword CREATE at [13:7]
  compiled Code at target/run/dbt_test/models/users.sql
[0m17:16:55.474963 [info ] [MainThread]: 
[0m17:16:55.475273 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:16:55.487220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 37.589127, "process_user_time": 4.753344, "process_kernel_time": 0.362414, "process_mem_max_rss": "200601600", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:16:55.487949 [debug] [MainThread]: Command `dbt run` failed at 17:16:55.487865 after 37.59 seconds
[0m17:16:55.488356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9992132e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989137c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989137400>]}
[0m17:16:55.488663 [debug] [MainThread]: Flushing usage events
[0m17:20:36.902463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2903b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf183e5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf183e54f0>]}


============================== 17:20:36.905941 | f5f4a691-0438-48b9-ac52-ac5ccee57349 ==============================
[0m17:20:36.905941 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:20:36.906403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:20:37.844280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2930bf40>]}
[0m17:20:37.877209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2c42e670>]}
[0m17:20:37.877622 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:20:37.905327 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:20:37.984950 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:20:37.985361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf298aba90>]}
[0m17:20:38.781488 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:20:38.781897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed87e8f70>]}
[0m17:20:38.965587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf188d2d90>]}
[0m17:20:39.041954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed8975790>]}
[0m17:20:39.042333 [info ] [MainThread]: Found 4 models, 1 seed, 7 data tests, 471 macros
[0m17:20:39.042600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed88cb9d0>]}
[0m17:20:39.043724 [info ] [MainThread]: 
[0m17:20:39.044166 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:20:39.047233 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:20:39.047561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:39.880025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:20:39.881705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:40.698107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf28ace0a0>]}
[0m17:20:40.699594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:40.700470 [info ] [MainThread]: 
[0m17:20:40.704959 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:20:40.706336 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_test.customers ................................ [RUN]
[0m17:20:40.707692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.customers)
[0m17:20:40.708611 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:20:40.723718 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:20:40.726036 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:20:40.742761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:20:41.562202 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:20:41.563417 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:20:42.333058 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:6d5819d2-3c43-4bb1-a626-34c595c2cb67&page=queryresults
[0m17:20:45.586335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2c00ba90>]}
[0m17:20:45.587057 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 4.88s]
[0m17:20:45.587613 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:20:45.587995 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:20:45.588495 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:20:45.588965 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:20:45.589300 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:20:45.592100 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:20:45.592708 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:20:45.594710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:20:46.236557 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:20:46.238816 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:20:46.839997 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9eb0b6dd-1373-48eb-b472-2e4f95e200d7&page=queryresults
[0m17:20:49.415951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed8a40e50>]}
[0m17:20:49.418440 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.82s]
[0m17:20:49.419815 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:20:49.420671 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:20:49.421797 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_test.users .................................... [RUN]
[0m17:20:49.422530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m17:20:49.423315 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:20:49.431363 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:20:49.432815 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:20:49.436740 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:20:49.437468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:20:49.439774 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`
    );
  
[0m17:20:50.425098 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:8115d3ac-1a2c-4915-a170-0030013aebb2&page=queryresults
[0m17:20:53.855329 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf189e0a00>]}
[0m17:20:53.857568 [info ] [Thread-1  ]: 3 of 4 OK created sql table model dbt_test.users ............................... [[32mCREATE TABLE (100.0k rows, 15.1 MiB processed)[0m in 4.43s]
[0m17:20:53.859381 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:20:53.860832 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:20:53.862241 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:20:53.863438 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:20:53.864293 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:20:53.871669 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:20:53.872681 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:20:53.875674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:20:54.493550 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:20:54.496719 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:20:55.193480 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:437f85f7-c5f6-4e0d-88a8-84206f6ca7f4&page=queryresults
[0m17:20:57.563160 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5f4a691-0438-48b9-ac52-ac5ccee57349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf1872db20>]}
[0m17:20:57.565453 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 3.70s]
[0m17:20:57.567566 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:20:57.571625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:57.572444 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:20:57.573459 [info ] [MainThread]: 
[0m17:20:57.574453 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 18.53 seconds (18.53s).
[0m17:20:57.576881 [debug] [MainThread]: Command end result
[0m17:20:57.624833 [info ] [MainThread]: 
[0m17:20:57.625298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:20:57.625599 [info ] [MainThread]: 
[0m17:20:57.625915 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:20:57.628953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.792505, "process_user_time": 4.710871, "process_kernel_time": 0.344244, "process_mem_max_rss": "194637824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:20:57.629678 [debug] [MainThread]: Command `dbt run` succeeded at 17:20:57.629592 after 20.79 seconds
[0m17:20:57.630118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2903b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf28a20ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf187d7f70>]}
[0m17:20:57.630477 [debug] [MainThread]: Flushing usage events
[0m17:43:37.510358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed03032e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee2af6d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee2af6490>]}


============================== 17:43:37.514209 | 7a9672f5-259a-46db-bd58-e834595d93c5 ==============================
[0m17:43:37.514209 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:43:37.514678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:43:38.565939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a9672f5-259a-46db-bd58-e834595d93c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec0b25af0>]}
[0m17:43:38.601602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a9672f5-259a-46db-bd58-e834595d93c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec0d33b20>]}
[0m17:43:38.602179 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:43:38.634540 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:43:38.747914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:43:38.748365 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/basicquery.sql
[0m17:43:38.903128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a9672f5-259a-46db-bd58-e834595d93c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee458dee0>]}
[0m17:43:38.979428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a9672f5-259a-46db-bd58-e834595d93c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee4576af0>]}
[0m17:43:38.979827 [info ] [MainThread]: Found 5 models, 1 seed, 7 data tests, 471 macros
[0m17:43:38.980108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a9672f5-259a-46db-bd58-e834595d93c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee45a39a0>]}
[0m17:43:38.981421 [info ] [MainThread]: 
[0m17:43:38.981892 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:43:38.985077 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:43:38.985414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:39.910474 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409_dbt_test'
[0m17:43:39.912256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:40.953923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a9672f5-259a-46db-bd58-e834595d93c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee13724c0>]}
[0m17:43:40.969395 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:40.970408 [info ] [MainThread]: 
[0m17:43:40.988357 [debug] [Thread-1  ]: Began running node model.dbt_test.basicquery
[0m17:43:40.993803 [info ] [Thread-1  ]: 1 of 5 START sql table model dbt_test.basicquery ............................... [RUN]
[0m17:43:40.995118 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now model.dbt_test.basicquery)
[0m17:43:40.995926 [debug] [Thread-1  ]: Began compiling node model.dbt_test.basicquery
[0m17:43:41.024104 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.basicquery"
[0m17:43:41.026095 [debug] [Thread-1  ]: Began executing node model.dbt_test.basicquery
[0m17:43:41.079363 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.basicquery"
[0m17:43:41.080257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:43:41.082105 [debug] [Thread-1  ]: On model.dbt_test.basicquery: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.basicquery"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`basicquery`
      
    
    

    OPTIONS()
    as (
      SELECT 
    oi.id AS order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.status,
    oi.created_at AS order_created_at,
    oi.sale_price,
    ii.product_name,
    ii.product_category,
    ii.product_brand,
    ii.cost AS product_cost,
    ii.product_retail_price,
    (oi.sale_price - ii.cost) AS profit
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
WHERE 
    oi.status = 'Complete'
    AND oi.created_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY)
ORDER BY 
    oi.created_at DESC
LIMIT 100;
    );
  
[0m17:43:41.878740 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:b5d0b334-21df-49da-9299-f3dd6844354d&page=queryresults
[0m17:43:41.882260 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [36:10]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [36:10]')
[0m17:43:43.260179 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:51a86d15-a450-4dfd-9a80-01556cb5cfba&page=queryresults
[0m17:43:43.262397 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:51a86d15-a450-4dfd-9a80-01556cb5cfba&page=queryresults
[0m17:43:43.277481 [debug] [Thread-1  ]: Database Error in model basicquery (models/basicquery.sql)
  Syntax error: Expected ")" but got ";" at [36:10]
  compiled Code at target/run/dbt_test/models/basicquery.sql
[0m17:43:43.280875 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9672f5-259a-46db-bd58-e834595d93c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee461d4c0>]}
[0m17:43:43.281983 [error] [Thread-1  ]: 1 of 5 ERROR creating sql table model dbt_test.basicquery ...................... [[31mERROR[0m in 2.28s]
[0m17:43:43.282995 [debug] [Thread-1  ]: Finished running node model.dbt_test.basicquery
[0m17:43:43.283781 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:43:43.284867 [info ] [Thread-1  ]: 2 of 5 START sql table model dbt_test.customers ................................ [RUN]
[0m17:43:43.285608 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.basicquery, now model.dbt_test.customers)
[0m17:43:43.286174 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:43:43.292258 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:43:43.294287 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:43:43.297251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:43:44.050093 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:43:44.053288 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:43:44.840372 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:324c3ff6-9f16-4877-ac1c-c451925e9f37&page=queryresults
[0m17:43:48.762766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9672f5-259a-46db-bd58-e834595d93c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee4612e20>]}
[0m17:43:48.763797 [info ] [Thread-1  ]: 2 of 5 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 5.48s]
[0m17:43:48.764703 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:43:48.765323 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:43:48.765984 [info ] [Thread-1  ]: 3 of 5 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:43:48.766603 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:43:48.767066 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:43:48.770765 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:43:48.772598 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:43:48.775290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:43:49.551360 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:43:49.554706 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:43:50.267939 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:5f968069-b4d1-4b73-8bf1-c8741d29452c&page=queryresults
[0m17:43:52.829674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9672f5-259a-46db-bd58-e834595d93c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faea0367b50>]}
[0m17:43:52.832189 [info ] [Thread-1  ]: 3 of 5 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.06s]
[0m17:43:52.833792 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:43:52.834852 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:43:52.835943 [info ] [Thread-1  ]: 4 of 5 START sql table model dbt_test.users .................................... [RUN]
[0m17:43:52.837081 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m17:43:52.837794 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:43:52.841738 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:43:52.843403 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:43:52.847140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:43:53.598573 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:43:53.600436 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`
    );
  
[0m17:43:54.342711 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:1c903313-60b8-42df-b499-a0e9e3096d3b&page=queryresults
[0m17:43:58.170925 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9672f5-259a-46db-bd58-e834595d93c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faea03672b0>]}
[0m17:43:58.172201 [info ] [Thread-1  ]: 4 of 5 OK created sql table model dbt_test.users ............................... [[32mCREATE TABLE (100.0k rows, 15.1 MiB processed)[0m in 5.33s]
[0m17:43:58.173237 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:43:58.173943 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:43:58.174888 [info ] [Thread-1  ]: 5 of 5 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:43:58.175763 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:43:58.176371 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:43:58.181747 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:43:58.182854 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:43:58.186096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:43:59.076156 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:43:59.079596 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:43:59.789477 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:f770705e-2f7e-4843-9d42-2742666acf0b&page=queryresults
[0m17:44:02.559775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9672f5-259a-46db-bd58-e834595d93c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee3cec970>]}
[0m17:44:02.561253 [info ] [Thread-1  ]: 5 of 5 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.38s]
[0m17:44:02.562677 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:44:02.565167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:02.565707 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:44:02.566141 [debug] [MainThread]: Connection 'list_dbt-test-427409_dbt_test' was properly closed.
[0m17:44:02.566795 [info ] [MainThread]: 
[0m17:44:02.567393 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 23.58 seconds (23.58s).
[0m17:44:02.569572 [debug] [MainThread]: Command end result
[0m17:44:02.609312 [info ] [MainThread]: 
[0m17:44:02.609805 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:44:02.610168 [info ] [MainThread]: 
[0m17:44:02.610533 [error] [MainThread]:   Database Error in model basicquery (models/basicquery.sql)
  Syntax error: Expected ")" but got ";" at [36:10]
  compiled Code at target/run/dbt_test/models/basicquery.sql
[0m17:44:02.610811 [info ] [MainThread]: 
[0m17:44:02.611102 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:44:02.614024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 25.165726, "process_user_time": 4.008986, "process_kernel_time": 0.388028, "process_mem_max_rss": "191885312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:44:02.614983 [debug] [MainThread]: Command `dbt run` failed at 17:44:02.614757 after 25.17 seconds
[0m17:44:02.615702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed03032e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee3cec970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee45574c0>]}
[0m17:44:02.616078 [debug] [MainThread]: Flushing usage events
[0m17:44:18.437057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35062b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3507edd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3507ed4f0>]}


============================== 17:44:18.440868 | 7c5cc683-b877-4806-8703-d6b40776a58c ==============================
[0m17:44:18.440868 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:44:18.441323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:44:19.329075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c5cc683-b877-4806-8703-d6b40776a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe343889730>]}
[0m17:44:19.361849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c5cc683-b877-4806-8703-d6b40776a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35085d610>]}
[0m17:44:19.362286 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:44:19.379900 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:44:19.484701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:44:19.485211 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/basicquery.sql
[0m17:44:19.641161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c5cc683-b877-4806-8703-d6b40776a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe320755130>]}
[0m17:44:19.715874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c5cc683-b877-4806-8703-d6b40776a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3412731f0>]}
[0m17:44:19.716291 [info ] [MainThread]: Found 5 models, 1 seed, 7 data tests, 471 macros
[0m17:44:19.716564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c5cc683-b877-4806-8703-d6b40776a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe320755250>]}
[0m17:44:19.717854 [info ] [MainThread]: 
[0m17:44:19.718385 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:44:19.721539 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:44:19.721885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:20.359630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:44:20.362183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:21.001588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c5cc683-b877-4806-8703-d6b40776a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3412730d0>]}
[0m17:44:21.004203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:21.006467 [info ] [MainThread]: 
[0m17:44:21.011675 [debug] [Thread-1  ]: Began running node model.dbt_test.basicquery
[0m17:44:21.012880 [info ] [Thread-1  ]: 1 of 5 START sql table model dbt_test.basicquery ............................... [RUN]
[0m17:44:21.014208 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.basicquery)
[0m17:44:21.014983 [debug] [Thread-1  ]: Began compiling node model.dbt_test.basicquery
[0m17:44:21.027808 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.basicquery"
[0m17:44:21.028712 [debug] [Thread-1  ]: Began executing node model.dbt_test.basicquery
[0m17:44:21.070436 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.basicquery"
[0m17:44:21.071316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:21.072736 [debug] [Thread-1  ]: On model.dbt_test.basicquery: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.basicquery"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`basicquery`
      
    
    

    OPTIONS()
    as (
      SELECT 
    oi.id AS order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.status,
    oi.created_at AS order_created_at,
    oi.sale_price,
    ii.product_name,
    ii.product_category,
    ii.product_brand,
    ii.cost AS product_cost,
    ii.product_retail_price,
    (oi.sale_price - ii.cost) AS profit
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
WHERE 
    oi.status = 'Complete'
    AND oi.created_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY)
ORDER BY 
    oi.created_at DESC
LIMIT 100
    );
  
[0m17:44:22.034318 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9ee99eaa-f122-458f-a964-770312223ee9&page=queryresults
[0m17:44:24.641778 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c5cc683-b877-4806-8703-d6b40776a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350e1e400>]}
[0m17:44:24.643672 [info ] [Thread-1  ]: 1 of 5 OK created sql table model dbt_test.basicquery .......................... [[32mCREATE TABLE (100.0 rows, 57.5 MiB processed)[0m in 3.63s]
[0m17:44:24.644500 [debug] [Thread-1  ]: Finished running node model.dbt_test.basicquery
[0m17:44:24.645040 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:44:24.645743 [info ] [Thread-1  ]: 2 of 5 START sql table model dbt_test.customers ................................ [RUN]
[0m17:44:24.646414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.basicquery, now model.dbt_test.customers)
[0m17:44:24.646897 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:44:24.651912 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:44:24.653369 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:44:24.655958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:25.321568 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:44:25.323002 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:44:25.960235 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:c6a89133-3a5c-41e3-b822-fc61d3b12362&page=queryresults
[0m17:44:29.208131 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c5cc683-b877-4806-8703-d6b40776a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350e17a30>]}
[0m17:44:29.209785 [info ] [Thread-1  ]: 2 of 5 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 4.56s]
[0m17:44:29.211375 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:44:29.212425 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:44:29.213569 [info ] [Thread-1  ]: 3 of 5 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:44:29.214618 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:44:29.215371 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:44:29.220913 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:44:29.222827 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:44:29.226613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:30.207192 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:44:30.210767 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:44:30.725267 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:78b37cf4-0d09-4cd1-be48-3e1eee79fbb1&page=queryresults
[0m17:44:33.382712 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c5cc683-b877-4806-8703-d6b40776a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350e17b80>]}
[0m17:44:33.384418 [info ] [Thread-1  ]: 3 of 5 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.17s]
[0m17:44:33.385724 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:44:33.386743 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:44:33.389076 [info ] [Thread-1  ]: 4 of 5 START sql table model dbt_test.users .................................... [RUN]
[0m17:44:33.390757 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.users)
[0m17:44:33.392130 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:44:33.397205 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:44:33.399604 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:44:33.403952 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:34.204092 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:44:34.207116 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`
    );
  
[0m17:44:35.015672 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:6ebb451d-e418-4575-865a-4e2dd0ca8d57&page=queryresults
[0m17:44:39.634562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c5cc683-b877-4806-8703-d6b40776a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350e8f700>]}
[0m17:44:39.637626 [info ] [Thread-1  ]: 4 of 5 OK created sql table model dbt_test.users ............................... [[32mCREATE TABLE (100.0k rows, 15.1 MiB processed)[0m in 6.24s]
[0m17:44:39.639511 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:44:39.640567 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:44:39.641907 [info ] [Thread-1  ]: 5 of 5 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:44:39.643125 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:44:39.643821 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:44:39.651434 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:44:39.652422 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:44:39.655984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:40.324682 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:44:40.327472 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:44:41.155934 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:11abe914-4e0f-4686-9198-4e897262c482&page=queryresults
[0m17:44:43.619671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c5cc683-b877-4806-8703-d6b40776a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33079e490>]}
[0m17:44:43.622025 [info ] [Thread-1  ]: 5 of 5 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 3.98s]
[0m17:44:43.623538 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:44:43.626664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:43.627820 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:44:43.628870 [info ] [MainThread]: 
[0m17:44:43.629736 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 23.91 seconds (23.91s).
[0m17:44:43.632559 [debug] [MainThread]: Command end result
[0m17:44:43.677646 [info ] [MainThread]: 
[0m17:44:43.678134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:43.678437 [info ] [MainThread]: 
[0m17:44:43.678748 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:44:43.681721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.305246, "process_user_time": 4.000982, "process_kernel_time": 0.302103, "process_mem_max_rss": "195416064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:44:43.682523 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:43.682422 after 25.31 seconds
[0m17:44:43.682958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35062b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3207183a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35085d610>]}
[0m17:44:43.683341 [debug] [MainThread]: Flushing usage events
[0m17:47:01.170635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5105b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c60a76d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c60a76460>]}


============================== 17:47:01.174139 | 186e3117-72ee-4c75-8605-80ee682df906 ==============================
[0m17:47:01.174139 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:47:01.174676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:47:02.074108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5423ce80>]}
[0m17:47:02.107203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c52511f10>]}
[0m17:47:02.107631 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:47:02.133994 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:47:02.242823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:47:02.243251 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/sales_product_category.sql
[0m17:47:02.398164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5464e160>]}
[0m17:47:02.483187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c546297c0>]}
[0m17:47:02.483643 [info ] [MainThread]: Found 6 models, 1 seed, 7 data tests, 471 macros
[0m17:47:02.483925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5463c2b0>]}
[0m17:47:02.485388 [info ] [MainThread]: 
[0m17:47:02.485960 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:47:02.490259 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:47:02.490684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:03.434365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:47:03.436727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:04.322633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c545ec400>]}
[0m17:47:04.324723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:04.325717 [info ] [MainThread]: 
[0m17:47:04.333011 [debug] [Thread-1  ]: Began running node model.dbt_test.basicquery
[0m17:47:04.335300 [info ] [Thread-1  ]: 1 of 6 START sql table model dbt_test.basicquery ............................... [RUN]
[0m17:47:04.336733 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.basicquery)
[0m17:47:04.337994 [debug] [Thread-1  ]: Began compiling node model.dbt_test.basicquery
[0m17:47:04.352774 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.basicquery"
[0m17:47:04.354252 [debug] [Thread-1  ]: Began executing node model.dbt_test.basicquery
[0m17:47:04.375617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:05.186357 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.basicquery"
[0m17:47:05.188631 [debug] [Thread-1  ]: On model.dbt_test.basicquery: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.basicquery"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`basicquery`
      
    
    

    OPTIONS()
    as (
      SELECT 
    oi.id AS order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.status,
    oi.created_at AS order_created_at,
    oi.sale_price,
    ii.product_name,
    ii.product_category,
    ii.product_brand,
    ii.cost AS product_cost,
    ii.product_retail_price,
    (oi.sale_price - ii.cost) AS profit
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
WHERE 
    oi.status = 'Complete'
    AND oi.created_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY)
ORDER BY 
    oi.created_at DESC
LIMIT 100
    );
  
[0m17:47:05.851979 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:01319de3-91d2-48c4-b79a-92073a2fc52a&page=queryresults
[0m17:47:08.655306 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c54515580>]}
[0m17:47:08.657247 [info ] [Thread-1  ]: 1 of 6 OK created sql table model dbt_test.basicquery .......................... [[32mCREATE TABLE (100.0 rows, 57.5 MiB processed)[0m in 4.32s]
[0m17:47:08.658721 [debug] [Thread-1  ]: Finished running node model.dbt_test.basicquery
[0m17:47:08.659446 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:47:08.660208 [info ] [Thread-1  ]: 2 of 6 START sql table model dbt_test.customers ................................ [RUN]
[0m17:47:08.660999 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.basicquery, now model.dbt_test.customers)
[0m17:47:08.661606 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:47:08.664704 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:47:08.666692 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:47:08.669937 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:09.437186 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:47:09.440465 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:47:10.093342 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:560bf658-03ec-4732-9bc9-393c7e5ea31e&page=queryresults
[0m17:47:13.537334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c60fc9a30>]}
[0m17:47:13.542113 [info ] [Thread-1  ]: 2 of 6 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 4.88s]
[0m17:47:13.544762 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:47:13.546134 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:47:13.547738 [info ] [Thread-1  ]: 3 of 6 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:47:13.549333 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:47:13.550610 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:47:13.559168 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:47:13.561813 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:47:13.566801 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:14.355120 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:47:14.359913 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:47:14.965414 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:a477dcaf-a7f0-4a57-a667-c615070184f4&page=queryresults
[0m17:47:17.224848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c30149880>]}
[0m17:47:17.227519 [info ] [Thread-1  ]: 3 of 6 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.68s]
[0m17:47:17.229390 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:47:17.230785 [debug] [Thread-1  ]: Began running node model.dbt_test.sales_product_category
[0m17:47:17.232710 [info ] [Thread-1  ]: 4 of 6 START sql table model dbt_test.sales_product_category ................... [RUN]
[0m17:47:17.234367 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.sales_product_category)
[0m17:47:17.235420 [debug] [Thread-1  ]: Began compiling node model.dbt_test.sales_product_category
[0m17:47:17.242100 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.sales_product_category"
[0m17:47:17.243684 [debug] [Thread-1  ]: Began executing node model.dbt_test.sales_product_category
[0m17:47:17.253704 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.sales_product_category"
[0m17:47:17.254868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:17.257354 [debug] [Thread-1  ]: On model.dbt_test.sales_product_category: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.sales_product_category"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`sales_product_category`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_category,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_category
ORDER BY 
    total_sales DESC
    );
  
[0m17:47:18.210786 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:d620058b-ba60-4c9d-9017-c0918bc939fb&page=queryresults
[0m17:47:21.829530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c180318b0>]}
[0m17:47:21.832382 [info ] [Thread-1  ]: 4 of 6 OK created sql table model dbt_test.sales_product_category .............. [[32mCREATE TABLE (26.0 rows, 13.7 MiB processed)[0m in 4.60s]
[0m17:47:21.834939 [debug] [Thread-1  ]: Finished running node model.dbt_test.sales_product_category
[0m17:47:21.836328 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:47:21.837837 [info ] [Thread-1  ]: 5 of 6 START sql table model dbt_test.users .................................... [RUN]
[0m17:47:21.839926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.sales_product_category, now model.dbt_test.users)
[0m17:47:21.841451 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:47:21.848717 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:47:21.851722 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:47:21.856485 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:22.650264 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:47:22.654252 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`
    );
  
[0m17:47:23.360675 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:1862b92d-b495-46de-9c39-2e521c220d7d&page=queryresults
[0m17:47:27.567601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c6100ad60>]}
[0m17:47:27.570195 [info ] [Thread-1  ]: 5 of 6 OK created sql table model dbt_test.users ............................... [[32mCREATE TABLE (100.0k rows, 15.1 MiB processed)[0m in 5.73s]
[0m17:47:27.574438 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:47:27.576036 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:47:27.577523 [info ] [Thread-1  ]: 6 of 6 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:47:27.578854 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:47:27.579702 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:47:27.588383 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:47:27.590677 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:47:27.595515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:28.486888 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:47:28.491570 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:47:29.197999 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:fd93d5ac-a83f-462b-be07-2edb5f01a5e5&page=queryresults
[0m17:47:31.761975 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186e3117-72ee-4c75-8605-80ee682df906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c40362280>]}
[0m17:47:31.765390 [info ] [Thread-1  ]: 6 of 6 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.18s]
[0m17:47:31.767861 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:47:31.772360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:31.774283 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:47:31.775729 [info ] [MainThread]: 
[0m17:47:31.776837 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 29.29 seconds (29.29s).
[0m17:47:31.780480 [debug] [MainThread]: Command end result
[0m17:47:31.838388 [info ] [MainThread]: 
[0m17:47:31.838902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:31.839254 [info ] [MainThread]: 
[0m17:47:31.839669 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:47:31.842747 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.728727, "process_user_time": 4.370732, "process_kernel_time": 0.363885, "process_mem_max_rss": "193933312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:47:31.843494 [debug] [MainThread]: Command `dbt run` succeeded at 17:47:31.843396 after 30.73 seconds
[0m17:47:31.843904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5105b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c544acbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5423ce80>]}
[0m17:47:31.844260 [debug] [MainThread]: Flushing usage events
[0m17:50:39.558686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82920b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8082112e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd808211b80>]}


============================== 17:50:39.562218 | 947ca4b1-9926-4c2d-a09c-53406122fd11 ==============================
[0m17:50:39.562218 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:50:39.562723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:50:40.488005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8294e1160>]}
[0m17:50:40.521052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82a6362b0>]}
[0m17:50:40.521489 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:50:40.545987 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:50:40.655235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:50:40.655708 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/top_selling_products.sql
[0m17:50:40.655951 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/average_time_to_ship.sql
[0m17:50:40.816873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818f4e130>]}
[0m17:50:40.897891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818f25c10>]}
[0m17:50:40.898293 [info ] [MainThread]: Found 8 models, 1 seed, 7 data tests, 471 macros
[0m17:50:40.898567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818f32340>]}
[0m17:50:40.899998 [info ] [MainThread]: 
[0m17:50:40.900488 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:50:40.903792 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:50:40.904163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:41.818101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:50:41.819800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:42.544056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82a683280>]}
[0m17:50:42.544834 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:42.545258 [info ] [MainThread]: 
[0m17:50:42.548144 [debug] [Thread-1  ]: Began running node model.dbt_test.average_time_to_ship
[0m17:50:42.548900 [info ] [Thread-1  ]: 1 of 8 START sql table model dbt_test.average_time_to_ship ..................... [RUN]
[0m17:50:42.549479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.average_time_to_ship)
[0m17:50:42.549879 [debug] [Thread-1  ]: Began compiling node model.dbt_test.average_time_to_ship
[0m17:50:42.558042 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.average_time_to_ship"
[0m17:50:42.559010 [debug] [Thread-1  ]: Began executing node model.dbt_test.average_time_to_ship
[0m17:50:42.593352 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.average_time_to_ship"
[0m17:50:42.593986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:42.595142 [debug] [Thread-1  ]: On model.dbt_test.average_time_to_ship: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.average_time_to_ship"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`average_time_to_ship`
      
    
    

    OPTIONS()
    as (
      SELECT 
    AVG(TIMESTAMP_DIFF(shipped_at, created_at, HOUR)) AS avg_hours_to_ship
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items`
WHERE 
    status = 'Complete'
    AND shipped_at IS NOT NULL;
    );
  
[0m17:50:43.261024 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:1652a493-5043-4404-8dc2-46899d10d4af&page=queryresults
[0m17:50:43.264275 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [19:31]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [19:31]')
[0m17:50:44.603527 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:bd967678-ee25-44ab-94a9-4c0e24d5ac7c&page=queryresults
[0m17:50:44.610011 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:bd967678-ee25-44ab-94a9-4c0e24d5ac7c&page=queryresults
[0m17:50:44.623921 [debug] [Thread-1  ]: Database Error in model average_time_to_ship (models/average_time_to_ship.sql)
  Syntax error: Expected ")" but got ";" at [19:31]
  compiled Code at target/run/dbt_test/models/average_time_to_ship.sql
[0m17:50:44.627362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818e9a0d0>]}
[0m17:50:44.628828 [error] [Thread-1  ]: 1 of 8 ERROR creating sql table model dbt_test.average_time_to_ship ............ [[31mERROR[0m in 2.08s]
[0m17:50:44.630025 [debug] [Thread-1  ]: Finished running node model.dbt_test.average_time_to_ship
[0m17:50:44.630959 [debug] [Thread-1  ]: Began running node model.dbt_test.basicquery
[0m17:50:44.632183 [info ] [Thread-1  ]: 2 of 8 START sql table model dbt_test.basicquery ............................... [RUN]
[0m17:50:44.633141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.average_time_to_ship, now model.dbt_test.basicquery)
[0m17:50:44.633836 [debug] [Thread-1  ]: Began compiling node model.dbt_test.basicquery
[0m17:50:44.641526 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.basicquery"
[0m17:50:44.643304 [debug] [Thread-1  ]: Began executing node model.dbt_test.basicquery
[0m17:50:44.647360 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:45.401640 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.basicquery"
[0m17:50:45.405614 [debug] [Thread-1  ]: On model.dbt_test.basicquery: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.basicquery"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`basicquery`
      
    
    

    OPTIONS()
    as (
      SELECT 
    oi.id AS order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.status,
    oi.created_at AS order_created_at,
    oi.sale_price,
    ii.product_name,
    ii.product_category,
    ii.product_brand,
    ii.cost AS product_cost,
    ii.product_retail_price,
    (oi.sale_price - ii.cost) AS profit
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
WHERE 
    oi.status = 'Complete'
    AND oi.created_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY)
ORDER BY 
    oi.created_at DESC
LIMIT 100
    );
  
[0m17:50:46.084960 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:8a2de25b-93c5-4560-accc-a390fbef712d&page=queryresults
[0m17:50:48.903530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82c484040>]}
[0m17:50:48.904429 [info ] [Thread-1  ]: 2 of 8 OK created sql table model dbt_test.basicquery .......................... [[32mCREATE TABLE (100.0 rows, 57.5 MiB processed)[0m in 4.27s]
[0m17:50:48.905201 [debug] [Thread-1  ]: Finished running node model.dbt_test.basicquery
[0m17:50:48.905736 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:50:48.906371 [info ] [Thread-1  ]: 3 of 8 START sql table model dbt_test.customers ................................ [RUN]
[0m17:50:48.907006 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.basicquery, now model.dbt_test.customers)
[0m17:50:48.907473 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:50:48.910095 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:50:48.911636 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:50:48.914140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:49.697741 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:50:49.700814 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:50:50.343813 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:f40f6c34-aea7-4bd2-9314-12afbaf39bdc&page=queryresults
[0m17:50:54.315728 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82c4bc670>]}
[0m17:50:54.319562 [info ] [Thread-1  ]: 3 of 8 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 5.41s]
[0m17:50:54.321941 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:50:54.323978 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:50:54.325676 [info ] [Thread-1  ]: 4 of 8 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:50:54.327007 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:50:54.327917 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:50:54.337893 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:50:54.340205 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:50:54.345555 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:55.166640 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:50:55.173940 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:50:55.759466 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:fa06e33c-a2fc-48c6-b913-f5f0712b8716&page=queryresults
[0m17:50:58.303167 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e80a36a0>]}
[0m17:50:58.307185 [info ] [Thread-1  ]: 4 of 8 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.98s]
[0m17:50:58.309800 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:50:58.311143 [debug] [Thread-1  ]: Began running node model.dbt_test.sales_product_category
[0m17:50:58.313004 [info ] [Thread-1  ]: 5 of 8 START sql table model dbt_test.sales_product_category ................... [RUN]
[0m17:50:58.314678 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.sales_product_category)
[0m17:50:58.315717 [debug] [Thread-1  ]: Began compiling node model.dbt_test.sales_product_category
[0m17:50:58.321887 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.sales_product_category"
[0m17:50:58.324875 [debug] [Thread-1  ]: Began executing node model.dbt_test.sales_product_category
[0m17:50:58.329890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:59.225604 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.sales_product_category"
[0m17:50:59.228866 [debug] [Thread-1  ]: On model.dbt_test.sales_product_category: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.sales_product_category"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`sales_product_category`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_category,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_category
ORDER BY 
    total_sales DESC
    );
  
[0m17:50:59.937773 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:076d541a-3500-4ad8-9d84-71c52ab58ae3&page=queryresults
[0m17:51:02.912984 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818fbac40>]}
[0m17:51:02.915776 [info ] [Thread-1  ]: 5 of 8 OK created sql table model dbt_test.sales_product_category .............. [[32mCREATE TABLE (26.0 rows, 13.7 MiB processed)[0m in 4.60s]
[0m17:51:02.917786 [debug] [Thread-1  ]: Finished running node model.dbt_test.sales_product_category
[0m17:51:02.918975 [debug] [Thread-1  ]: Began running node model.dbt_test.top_selling_products
[0m17:51:02.920321 [info ] [Thread-1  ]: 6 of 8 START sql table model dbt_test.top_selling_products ..................... [RUN]
[0m17:51:02.921692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.sales_product_category, now model.dbt_test.top_selling_products)
[0m17:51:02.922992 [debug] [Thread-1  ]: Began compiling node model.dbt_test.top_selling_products
[0m17:51:02.929147 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.top_selling_products"
[0m17:51:02.930793 [debug] [Thread-1  ]: Began executing node model.dbt_test.top_selling_products
[0m17:51:02.936314 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.top_selling_products"
[0m17:51:02.937358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:02.939802 [debug] [Thread-1  ]: On model.dbt_test.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.top_selling_products"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`top_selling_products`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_name,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_name
ORDER BY 
    total_sales DESC
LIMIT 10
    );
  
[0m17:51:03.934783 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:2735a9ec-84bc-4a4a-9306-02bc27a0322b&page=queryresults
[0m17:51:07.010021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d0465c40>]}
[0m17:51:07.012499 [info ] [Thread-1  ]: 6 of 8 OK created sql table model dbt_test.top_selling_products ................ [[32mCREATE TABLE (10.0 rows, 31.4 MiB processed)[0m in 4.09s]
[0m17:51:07.014225 [debug] [Thread-1  ]: Finished running node model.dbt_test.top_selling_products
[0m17:51:07.015459 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:51:07.016855 [info ] [Thread-1  ]: 7 of 8 START sql table model dbt_test.users .................................... [RUN]
[0m17:51:07.018223 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.top_selling_products, now model.dbt_test.users)
[0m17:51:07.019043 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:51:07.025693 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:51:07.029102 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:51:07.033356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:07.824897 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:51:07.827681 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`
    );
  
[0m17:51:08.493020 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9b40a310-8479-4e41-9898-662bc5ce3ab0&page=queryresults
[0m17:51:12.449445 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818fe51c0>]}
[0m17:51:12.453040 [info ] [Thread-1  ]: 7 of 8 OK created sql table model dbt_test.users ............................... [[32mCREATE TABLE (100.0k rows, 15.1 MiB processed)[0m in 5.43s]
[0m17:51:12.454637 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:51:12.456140 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:51:12.457863 [info ] [Thread-1  ]: 8 of 8 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:51:12.459158 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:51:12.460062 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:51:12.469035 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:51:12.470323 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:51:12.474412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:13.253557 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:51:13.257520 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:51:13.968851 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:d2cdd6fe-a858-432a-b6bf-06fc41d34089&page=queryresults
[0m17:51:16.531313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ca4b1-9926-4c2d-a09c-53406122fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e80b2760>]}
[0m17:51:16.533639 [info ] [Thread-1  ]: 8 of 8 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.07s]
[0m17:51:16.535586 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:51:16.539833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:16.540676 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:51:16.541564 [info ] [MainThread]: 
[0m17:51:16.542384 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 35.64 seconds (35.64s).
[0m17:51:16.545875 [debug] [MainThread]: Command end result
[0m17:51:16.588378 [info ] [MainThread]: 
[0m17:51:16.588847 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:51:16.589130 [info ] [MainThread]: 
[0m17:51:16.589478 [error] [MainThread]:   Database Error in model average_time_to_ship (models/average_time_to_ship.sql)
  Syntax error: Expected ")" but got ";" at [19:31]
  compiled Code at target/run/dbt_test/models/average_time_to_ship.sql
[0m17:51:16.589758 [info ] [MainThread]: 
[0m17:51:16.590049 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m17:51:16.593606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 37.0939, "process_user_time": 4.490501, "process_kernel_time": 0.375381, "process_mem_max_rss": "186437632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:51:16.594287 [debug] [MainThread]: Command `dbt run` failed at 17:51:16.594196 after 37.09 seconds
[0m17:51:16.594748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82920b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd828c583a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818f32820>]}
[0m17:51:16.595067 [debug] [MainThread]: Flushing usage events
[0m17:51:57.926641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4311d32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb432b0cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb432b0c4f0>]}


============================== 17:51:57.930371 | 14508ef9-af36-4b61-a2d7-22e8265938f3 ==============================
[0m17:51:57.930371 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:51:57.931000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:58.879029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb434415a00>]}
[0m17:51:58.912576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb418aa9eb0>]}
[0m17:51:58.913029 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:51:58.932185 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:51:59.041808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:51:59.042290 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/average_time_to_ship.sql
[0m17:51:59.198903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4346b3130>]}
[0m17:51:59.274819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4346bf310>]}
[0m17:51:59.275222 [info ] [MainThread]: Found 8 models, 1 seed, 7 data tests, 471 macros
[0m17:51:59.275485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4344437c0>]}
[0m17:51:59.276851 [info ] [MainThread]: 
[0m17:51:59.277336 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:51:59.280644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m17:51:59.281019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:59.889549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m17:51:59.891197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:00.564037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb432ac4f40>]}
[0m17:52:00.566042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:00.567349 [info ] [MainThread]: 
[0m17:52:00.573667 [debug] [Thread-1  ]: Began running node model.dbt_test.average_time_to_ship
[0m17:52:00.575553 [info ] [Thread-1  ]: 1 of 8 START sql table model dbt_test.average_time_to_ship ..................... [RUN]
[0m17:52:00.576769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.average_time_to_ship)
[0m17:52:00.577584 [debug] [Thread-1  ]: Began compiling node model.dbt_test.average_time_to_ship
[0m17:52:00.591048 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.average_time_to_ship"
[0m17:52:00.592412 [debug] [Thread-1  ]: Began executing node model.dbt_test.average_time_to_ship
[0m17:52:00.634457 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.average_time_to_ship"
[0m17:52:00.635021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:52:00.636259 [debug] [Thread-1  ]: On model.dbt_test.average_time_to_ship: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.average_time_to_ship"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`average_time_to_ship`
      
    
    

    OPTIONS()
    as (
      SELECT 
    AVG(TIMESTAMP_DIFF(shipped_at, created_at, HOUR)) AS avg_hours_to_ship
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items`
WHERE 
    status = 'Complete'
    AND shipped_at IS NOT NULL
    );
  
[0m17:52:01.671056 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:225cb3e5-f06e-4e64-8645-46718fd1e336&page=queryresults
[0m17:52:04.080904 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb432ac4f40>]}
[0m17:52:04.082210 [info ] [Thread-1  ]: 1 of 8 OK created sql table model dbt_test.average_time_to_ship ................ [[32mCREATE TABLE (1.0 rows, 4.0 MiB processed)[0m in 3.50s]
[0m17:52:04.083289 [debug] [Thread-1  ]: Finished running node model.dbt_test.average_time_to_ship
[0m17:52:04.083988 [debug] [Thread-1  ]: Began running node model.dbt_test.basicquery
[0m17:52:04.084818 [info ] [Thread-1  ]: 2 of 8 START sql table model dbt_test.basicquery ............................... [RUN]
[0m17:52:04.085639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.average_time_to_ship, now model.dbt_test.basicquery)
[0m17:52:04.086244 [debug] [Thread-1  ]: Began compiling node model.dbt_test.basicquery
[0m17:52:04.089769 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.basicquery"
[0m17:52:04.091409 [debug] [Thread-1  ]: Began executing node model.dbt_test.basicquery
[0m17:52:04.094421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:52:04.866089 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.basicquery"
[0m17:52:04.868892 [debug] [Thread-1  ]: On model.dbt_test.basicquery: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.basicquery"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`basicquery`
      
    
    

    OPTIONS()
    as (
      SELECT 
    oi.id AS order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.status,
    oi.created_at AS order_created_at,
    oi.sale_price,
    ii.product_name,
    ii.product_category,
    ii.product_brand,
    ii.cost AS product_cost,
    ii.product_retail_price,
    (oi.sale_price - ii.cost) AS profit
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
WHERE 
    oi.status = 'Complete'
    AND oi.created_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY)
ORDER BY 
    oi.created_at DESC
LIMIT 100
    );
  
[0m17:52:05.679490 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:4816a88f-7316-4687-aa44-f212e9940d44&page=queryresults
[0m17:52:08.254476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb434550250>]}
[0m17:52:08.258063 [info ] [Thread-1  ]: 2 of 8 OK created sql table model dbt_test.basicquery .......................... [[32mCREATE TABLE (100.0 rows, 57.5 MiB processed)[0m in 4.17s]
[0m17:52:08.259936 [debug] [Thread-1  ]: Finished running node model.dbt_test.basicquery
[0m17:52:08.261103 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m17:52:08.262298 [info ] [Thread-1  ]: 3 of 8 START sql table model dbt_test.customers ................................ [RUN]
[0m17:52:08.263812 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.basicquery, now model.dbt_test.customers)
[0m17:52:08.264703 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m17:52:08.269679 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m17:52:08.273192 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m17:52:08.277836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:52:08.959296 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m17:52:08.961412 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m17:52:09.704008 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:23f31c05-75d5-45ef-b829-262ac0afff0f&page=queryresults
[0m17:52:12.642632 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb418cbfe80>]}
[0m17:52:12.648135 [info ] [Thread-1  ]: 3 of 8 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 4.38s]
[0m17:52:12.650282 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m17:52:12.651869 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m17:52:12.653345 [info ] [Thread-1  ]: 4 of 8 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m17:52:12.654790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.my_first_dbt_model)
[0m17:52:12.655819 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m17:52:12.664935 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m17:52:12.666691 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m17:52:12.676207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:52:13.473836 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m17:52:13.478571 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:52:14.175171 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:615f1bd6-133d-4081-95c0-c85a9e9e9f9b&page=queryresults
[0m17:52:16.643427 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4311c1fd0>]}
[0m17:52:16.644798 [info ] [Thread-1  ]: 4 of 8 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.99s]
[0m17:52:16.646033 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m17:52:16.646892 [debug] [Thread-1  ]: Began running node model.dbt_test.sales_product_category
[0m17:52:16.647896 [info ] [Thread-1  ]: 5 of 8 START sql table model dbt_test.sales_product_category ................... [RUN]
[0m17:52:16.649085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.sales_product_category)
[0m17:52:16.649770 [debug] [Thread-1  ]: Began compiling node model.dbt_test.sales_product_category
[0m17:52:16.653732 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.sales_product_category"
[0m17:52:16.655810 [debug] [Thread-1  ]: Began executing node model.dbt_test.sales_product_category
[0m17:52:16.659277 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:52:17.358578 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.sales_product_category"
[0m17:52:17.361471 [debug] [Thread-1  ]: On model.dbt_test.sales_product_category: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.sales_product_category"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`sales_product_category`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_category,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_category
ORDER BY 
    total_sales DESC
    );
  
[0m17:52:18.069249 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:8750e51f-6ff5-4bbf-9ffc-c98248197bbb&page=queryresults
[0m17:52:20.841552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb418cf8bb0>]}
[0m17:52:20.844553 [info ] [Thread-1  ]: 5 of 8 OK created sql table model dbt_test.sales_product_category .............. [[32mCREATE TABLE (26.0 rows, 13.7 MiB processed)[0m in 4.19s]
[0m17:52:20.846538 [debug] [Thread-1  ]: Finished running node model.dbt_test.sales_product_category
[0m17:52:20.848101 [debug] [Thread-1  ]: Began running node model.dbt_test.top_selling_products
[0m17:52:20.849623 [info ] [Thread-1  ]: 6 of 8 START sql table model dbt_test.top_selling_products ..................... [RUN]
[0m17:52:20.851204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.sales_product_category, now model.dbt_test.top_selling_products)
[0m17:52:20.852243 [debug] [Thread-1  ]: Began compiling node model.dbt_test.top_selling_products
[0m17:52:20.858573 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.top_selling_products"
[0m17:52:20.860153 [debug] [Thread-1  ]: Began executing node model.dbt_test.top_selling_products
[0m17:52:20.865229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:52:21.537334 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.top_selling_products"
[0m17:52:21.540729 [debug] [Thread-1  ]: On model.dbt_test.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.top_selling_products"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`top_selling_products`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_name,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_name
ORDER BY 
    total_sales DESC
LIMIT 10
    );
  
[0m17:52:22.177333 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:8e80ba4c-9e07-4161-8e67-f78edcc53e8d&page=queryresults
[0m17:52:25.150261 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb418ce56d0>]}
[0m17:52:25.152576 [info ] [Thread-1  ]: 6 of 8 OK created sql table model dbt_test.top_selling_products ................ [[32mCREATE TABLE (10.0 rows, 31.4 MiB processed)[0m in 4.30s]
[0m17:52:25.154279 [debug] [Thread-1  ]: Finished running node model.dbt_test.top_selling_products
[0m17:52:25.155630 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m17:52:25.156995 [info ] [Thread-1  ]: 7 of 8 START sql table model dbt_test.users .................................... [RUN]
[0m17:52:25.158432 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.top_selling_products, now model.dbt_test.users)
[0m17:52:25.159873 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m17:52:25.165624 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m17:52:25.168818 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m17:52:25.177258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:52:25.960832 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m17:52:25.964314 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`
    );
  
[0m17:52:26.668907 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:88b1c110-f2db-4339-93cd-b86c719cd680&page=queryresults
[0m17:52:30.262144 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb400049790>]}
[0m17:52:30.264963 [info ] [Thread-1  ]: 7 of 8 OK created sql table model dbt_test.users ............................... [[32mCREATE TABLE (100.0k rows, 15.1 MiB processed)[0m in 5.10s]
[0m17:52:30.267660 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m17:52:30.269303 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m17:52:30.270968 [info ] [Thread-1  ]: 8 of 8 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m17:52:30.274035 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m17:52:30.275513 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m17:52:30.283890 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m17:52:30.286570 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m17:52:30.291090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:52:30.975507 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m17:52:30.981250 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m17:52:31.687645 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:c034e49c-6063-4940-a9b3-5e2d11e4d3df&page=queryresults
[0m17:52:33.887798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14508ef9-af36-4b61-a2d7-22e8265938f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb418cb7700>]}
[0m17:52:33.890820 [info ] [Thread-1  ]: 8 of 8 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 3.62s]
[0m17:52:33.893264 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m17:52:33.897185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:33.898193 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m17:52:33.899685 [info ] [MainThread]: 
[0m17:52:33.900701 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 34.62 seconds (34.62s).
[0m17:52:33.904729 [debug] [MainThread]: Command end result
[0m17:52:33.952273 [info ] [MainThread]: 
[0m17:52:33.952823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:33.953195 [info ] [MainThread]: 
[0m17:52:33.953530 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:52:33.956345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 36.09246, "process_user_time": 4.592838, "process_kernel_time": 0.354636, "process_mem_max_rss": "195915776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:52:33.956925 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:33.956845 after 36.09 seconds
[0m17:52:33.957308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4311d32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb430b783d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb418aa9eb0>]}
[0m17:52:33.957654 [debug] [MainThread]: Flushing usage events
[0m13:23:02.359474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded11ab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded292ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded292e580>]}


============================== 13:23:02.364985 | f5a03096-883d-471f-b9ab-12c056f7ba11 ==============================
[0m13:23:02.364985 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:23:02.365690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:23:03.799528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5a03096-883d-471f-b9ab-12c056f7ba11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4417610>]}
[0m13:23:03.856096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5a03096-883d-471f-b9ab-12c056f7ba11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded28a9d60>]}
[0m13:23:03.856768 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:23:03.882622 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:23:04.071338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:23:04.071856 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:23:04.136276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5a03096-883d-471f-b9ab-12c056f7ba11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded46b9130>]}
[0m13:23:04.268909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5a03096-883d-471f-b9ab-12c056f7ba11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded46a2b80>]}
[0m13:23:04.269506 [info ] [MainThread]: Found 8 models, 1 seed, 7 data tests, 471 macros
[0m13:23:04.269934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a03096-883d-471f-b9ab-12c056f7ba11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded46d9220>]}
[0m13:23:04.272079 [info ] [MainThread]: 
[0m13:23:04.272790 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:04.278068 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m13:23:04.278607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:31.360218 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409_dbt_test'
[0m14:02:31.365262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:31.020036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:31.023014 [debug] [MainThread]: Connection 'list_dbt-test-427409' was properly closed.
[0m15:25:31.024117 [debug] [MainThread]: Connection 'list_dbt-test-427409_dbt_test' was properly closed.
[0m15:25:31.027687 [info ] [MainThread]: 
[0m15:25:31.029367 [info ] [MainThread]: Finished running  in 2 hours 2 minutes and 26.75 seconds (7346.75s).
[0m15:25:31.054649 [error] [MainThread]: Encountered an error:
('invalid_grant: Invalid JWT: Token must be a short-lived token (60 minutes) and in a reasonable timeframe. Check your iat and exp values in the JWT claim.', {'error': 'invalid_grant', 'error_description': 'Invalid JWT: Token must be a short-lived token (60 minutes) and in a reasonable timeframe. Check your iat and exp values in the JWT claim.'})
[0m15:25:31.065694 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/task/run.py", line 460, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/task/runnable.py", line 464, in populate_adapter_cache
    adapter.set_relations_cache(cachable_nodes)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 525, in set_relations_cache
    self._relations_cache_for_schemas(relation_configs, required_schemas)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 501, in _relations_cache_for_schemas
    for relation in future.result():
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/concurrent/futures/_base.py", line 433, in result
    return self.__get_result()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/concurrent/futures/thread.py", line 52, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt_common/utils/executor.py", line 13, in connected
    return func(*args, **kwargs)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/adapters/bigquery/impl.py", line 284, in list_relations_without_caching
    return [self._bq_table_to_relation(table) for table in all_tables]  # type: ignore[misc]
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/dbt/adapters/bigquery/impl.py", line 284, in <listcomp>
    return [self._bq_table_to_relation(table) for table in all_tables]  # type: ignore[misc]
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/api_core/page_iterator.py", line 208, in _items_iter
    for page in self._page_iter(increment=False):
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/api_core/page_iterator.py", line 244, in _page_iter
    page = self._next_page()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/api_core/page_iterator.py", line 373, in _next_page
    response = self._get_next_page_response()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/api_core/page_iterator.py", line 432, in _get_next_page_response
    return self.api_request(
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/cloud/bigquery/client.py", line 1651, in api_request
    return self._call_api(
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/cloud/bigquery/client.py", line 833, in _call_api
    return call()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/cloud/_http/__init__.py", line 482, in api_request
    response = self._make_request(
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/cloud/_http/__init__.py", line 341, in _make_request
    return self._do_request(
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/cloud/_http/__init__.py", line 379, in _do_request
    return self.http.request(
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/auth/transport/requests.py", line 534, in request
    self.credentials.before_request(auth_request, method, url, request_headers)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/oauth2/service_account.py", line 446, in refresh
    access_token, expiry, _ = _client.jwt_grant(
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/oauth2/_client.py", line 304, in jwt_grant
    response_data = _token_endpoint_request(
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/oauth2/_client.py", line 275, in _token_endpoint_request
    _handle_error_response(response_data, retryable_error)
  File "/Users/tszeyenthen/anaconda3/envs/dbt/lib/python3.9/site-packages/google/oauth2/_client.py", line 68, in _handle_error_response
    raise exceptions.RefreshError(
google.auth.exceptions.RefreshError: ('invalid_grant: Invalid JWT: Token must be a short-lived token (60 minutes) and in a reasonable timeframe. Check your iat and exp values in the JWT claim.', {'error': 'invalid_grant', 'error_description': 'Invalid JWT: Token must be a short-lived token (60 minutes) and in a reasonable timeframe. Check your iat and exp values in the JWT claim.'})

[0m15:25:31.102323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 396.2681, "process_user_time": 4.419235, "process_kernel_time": 0.541638, "process_mem_max_rss": "191016960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:25:31.103975 [debug] [MainThread]: Command `dbt run` failed at 15:25:31.103757 after 396.27 seconds
[0m15:25:31.104895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded11ab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded46d9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdec0fbdeb0>]}
[0m15:25:31.105573 [debug] [MainThread]: Flushing usage events
[0m00:42:20.007647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81010a32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f0f06d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f0f06460>]}


============================== 00:42:20.012872 | ee997562-286d-4ab1-ac3e-c4b6cf4a6e5b ==============================
[0m00:42:20.012872 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:42:20.013604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:42:21.351571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee997562-286d-4ab1-ac3e-c4b6cf4a6e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8101378130>]}
[0m00:42:21.407011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee997562-286d-4ab1-ac3e-c4b6cf4a6e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8103619760>]}
[0m00:42:21.407691 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m00:42:21.438814 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:42:21.613520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:42:21.614285 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/sales_product_category.sql
[0m00:42:21.875920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee997562-286d-4ab1-ac3e-c4b6cf4a6e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e0400100>]}
[0m00:42:22.000861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee997562-286d-4ab1-ac3e-c4b6cf4a6e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e03cbb80>]}
[0m00:42:22.001494 [info ] [MainThread]: Found 8 models, 1 seed, 7 data tests, 471 macros
[0m00:42:22.001933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee997562-286d-4ab1-ac3e-c4b6cf4a6e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e03e8f40>]}
[0m00:42:22.004094 [info ] [MainThread]: 
[0m00:42:22.004843 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:42:22.010167 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m00:42:22.010707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:04.029943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad6845b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7a646d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7a6464c0>]}


============================== 00:48:04.035106 | c65565eb-603a-4c37-b98f-ff18c98ca7ad ==============================
[0m00:48:04.035106 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:48:04.035919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:48:05.377501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c65565eb-603a-4c37-b98f-ff18c98ca7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7a61a250>]}
[0m00:48:05.434062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c65565eb-603a-4c37-b98f-ff18c98ca7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7a4cae50>]}
[0m00:48:05.434781 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m00:48:05.459960 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:48:05.640903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:48:05.641427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:48:05.705645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c65565eb-603a-4c37-b98f-ff18c98ca7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad4029a130>]}
[0m00:48:05.837885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c65565eb-603a-4c37-b98f-ff18c98ca7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad402aad90>]}
[0m00:48:05.838565 [info ] [MainThread]: Found 8 models, 1 seed, 7 data tests, 471 macros
[0m00:48:05.839086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65565eb-603a-4c37-b98f-ff18c98ca7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad79515220>]}
[0m00:48:05.841432 [info ] [MainThread]: 
[0m00:48:05.842182 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:48:05.847615 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m00:48:05.848169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:49:59.701474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce91cb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cea8ded30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cea8de430>]}


============================== 00:49:59.707273 | c1f466c8-9c4f-4201-babd-ef5e25030136 ==============================
[0m00:49:59.707273 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:49:59.708114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:50:00.842149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1f466c8-9c4f-4201-babd-ef5e25030136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cea8bde20>]}
[0m00:50:00.898578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1f466c8-9c4f-4201-babd-ef5e25030136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd867ecd0>]}
[0m00:50:00.899320 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m00:50:00.930953 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:50:01.107033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:50:01.107805 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/sales_product_category.sql
[0m00:50:01.368437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1f466c8-9c4f-4201-babd-ef5e25030136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cec19a130>]}
[0m00:50:01.494764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1f466c8-9c4f-4201-babd-ef5e25030136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cec1aafa0>]}
[0m00:50:01.495390 [info ] [MainThread]: Found 8 models, 1 seed, 7 data tests, 471 macros
[0m00:50:01.495817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f466c8-9c4f-4201-babd-ef5e25030136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cec19a310>]}
[0m00:50:01.497940 [info ] [MainThread]: 
[0m00:50:01.498602 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:50:01.503740 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m00:50:01.504266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:57.104536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38920b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3685d6d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3685d6430>]}


============================== 00:51:57.110932 | 55999dc4-7fe7-4678-a9d4-3746ee415fd7 ==============================
[0m00:51:57.110932 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:51:57.111772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:51:58.448521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55999dc4-7fe7-4678-a9d4-3746ee415fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe368d05640>]}
[0m00:51:58.511425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55999dc4-7fe7-4678-a9d4-3746ee415fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38a96dc70>]}
[0m00:51:58.512269 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m00:51:58.546220 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:51:58.725091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:51:58.725612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:51:58.788853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55999dc4-7fe7-4678-a9d4-3746ee415fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe368e86ee0>]}
[0m00:51:58.920048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55999dc4-7fe7-4678-a9d4-3746ee415fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe368e9dd00>]}
[0m00:51:58.920714 [info ] [MainThread]: Found 8 models, 1 seed, 7 data tests, 471 macros
[0m00:51:58.921149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55999dc4-7fe7-4678-a9d4-3746ee415fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38c4f7e50>]}
[0m00:51:58.923334 [info ] [MainThread]: 
[0m00:51:58.924026 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:51:58.929475 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m00:51:58.930012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:14.810832 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409_dbt_test'
[0m00:58:14.816761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:01.760207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb1138b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb12a9dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb12a9d580>]}


============================== 01:00:01.765657 | b421cefe-cc11-4a74-9935-5ea8b9e81b1f ==============================
[0m01:00:01.765657 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:00:01.766456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:03.094814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b421cefe-cc11-4a74-9935-5ea8b9e81b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb128d5490>]}
[0m01:00:03.151533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b421cefe-cc11-4a74-9935-5ea8b9e81b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb12a18d90>]}
[0m01:00:03.152232 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m01:00:03.183371 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:00:03.364922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:00:03.365602 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/inventory_items.sql
[0m01:00:03.632949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b421cefe-cc11-4a74-9935-5ea8b9e81b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb13911130>]}
[0m01:00:03.762618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b421cefe-cc11-4a74-9935-5ea8b9e81b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad92283d0>]}
[0m01:00:03.763246 [info ] [MainThread]: Found 9 models, 1 seed, 7 data tests, 471 macros
[0m01:00:03.763698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b421cefe-cc11-4a74-9935-5ea8b9e81b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb004b3880>]}
[0m01:00:03.765876 [info ] [MainThread]: 
[0m01:00:03.766533 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:00:03.771947 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m01:00:03.772511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:35.703842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95c910b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b8806d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b8806460>]}


============================== 01:00:35.708966 | 957a1aee-1ec3-48b6-a386-4452d5c6e618 ==============================
[0m01:00:35.708966 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:00:35.709783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:00:37.003891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '957a1aee-1ec3-48b6-a386-4452d5c6e618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cbf86a60>]}
[0m01:00:37.060824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '957a1aee-1ec3-48b6-a386-4452d5c6e618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b87d0490>]}
[0m01:00:37.061524 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m01:00:37.089346 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:00:37.266436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:37.266939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:37.331423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '957a1aee-1ec3-48b6-a386-4452d5c6e618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cc128dc0>]}
[0m01:00:37.462436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '957a1aee-1ec3-48b6-a386-4452d5c6e618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95cc140eb0>]}
[0m01:00:37.463078 [info ] [MainThread]: Found 9 models, 1 seed, 7 data tests, 471 macros
[0m01:00:37.463529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '957a1aee-1ec3-48b6-a386-4452d5c6e618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b92c6bb0>]}
[0m01:00:37.465825 [info ] [MainThread]: 
[0m01:00:37.466502 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:00:37.471877 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m01:00:37.472411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:11.579482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf602232e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf58226c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf582264f0>]}


============================== 01:04:11.585227 | 608ba160-0ccd-4635-996b-185ed52bbe44 ==============================
[0m01:04:11.585227 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:04:11.585980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:04:13.202796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfab687820>]}
[0m01:04:13.259406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfab6cc820>]}
[0m01:04:13.260130 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m01:04:13.289383 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:04:13.467963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:04:13.468764 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/sales_product_category.sql
[0m01:04:13.729990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfabb18130>]}
[0m01:04:13.856675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfabb2b7c0>]}
[0m01:04:13.857333 [info ] [MainThread]: Found 9 models, 1 seed, 7 data tests, 471 macros
[0m01:04:13.857774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfabb32f40>]}
[0m01:04:13.859942 [info ] [MainThread]: 
[0m01:04:13.860669 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:04:13.865911 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m01:04:13.866414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:15.244500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m01:04:15.245842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:15.986400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf986c1700>]}
[0m01:04:15.987828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:04:15.988661 [info ] [MainThread]: 
[0m01:04:15.994511 [debug] [Thread-1  ]: Began running node model.dbt_test.average_time_to_ship
[0m01:04:15.995833 [info ] [Thread-1  ]: 1 of 9 START sql table model dbt_test.average_time_to_ship ..................... [RUN]
[0m01:04:15.996907 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.average_time_to_ship)
[0m01:04:15.997672 [debug] [Thread-1  ]: Began compiling node model.dbt_test.average_time_to_ship
[0m01:04:16.010574 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.average_time_to_ship"
[0m01:04:16.013676 [debug] [Thread-1  ]: Began executing node model.dbt_test.average_time_to_ship
[0m01:04:16.031850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:17.001087 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.average_time_to_ship"
[0m01:04:17.002000 [debug] [Thread-1  ]: On model.dbt_test.average_time_to_ship: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.average_time_to_ship"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`average_time_to_ship`
      
    
    

    OPTIONS()
    as (
      SELECT 
    AVG(TIMESTAMP_DIFF(shipped_at, created_at, HOUR)) AS avg_hours_to_ship
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items`
WHERE 
    status = 'Complete'
    AND shipped_at IS NOT NULL
    );
  
[0m01:04:17.728009 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:2496aef2-1d1a-4b65-96d7-a33e7e27f7c9&page=queryresults
[0m01:04:20.483270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfab249430>]}
[0m01:04:20.484351 [info ] [Thread-1  ]: 1 of 9 OK created sql table model dbt_test.average_time_to_ship ................ [[32mCREATE TABLE (1.0 rows, 4.1 MiB processed)[0m in 4.49s]
[0m01:04:20.485164 [debug] [Thread-1  ]: Finished running node model.dbt_test.average_time_to_ship
[0m01:04:20.485679 [debug] [Thread-1  ]: Began running node model.dbt_test.basicquery
[0m01:04:20.486353 [info ] [Thread-1  ]: 2 of 9 START sql table model dbt_test.basicquery ............................... [RUN]
[0m01:04:20.487000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.average_time_to_ship, now model.dbt_test.basicquery)
[0m01:04:20.487460 [debug] [Thread-1  ]: Began compiling node model.dbt_test.basicquery
[0m01:04:20.490230 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.basicquery"
[0m01:04:20.491609 [debug] [Thread-1  ]: Began executing node model.dbt_test.basicquery
[0m01:04:20.494763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:21.233768 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.basicquery"
[0m01:04:21.236564 [debug] [Thread-1  ]: On model.dbt_test.basicquery: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.basicquery"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`basicquery`
      
    
    

    OPTIONS()
    as (
      SELECT 
    oi.id AS order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.status,
    oi.created_at AS order_created_at,
    oi.sale_price,
    ii.product_name,
    ii.product_category,
    ii.product_brand,
    ii.cost AS product_cost,
    ii.product_retail_price,
    (oi.sale_price - ii.cost) AS profit
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
WHERE 
    oi.status = 'Complete'
    AND oi.created_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY)
ORDER BY 
    oi.created_at DESC
LIMIT 100
    );
  
[0m01:04:22.384642 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:a771a0cf-9050-4860-b7c4-cc48214aab84&page=queryresults
[0m01:04:24.300422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfabca6f70>]}
[0m01:04:24.301775 [info ] [Thread-1  ]: 2 of 9 OK created sql table model dbt_test.basicquery .......................... [[32mCREATE TABLE (100.0 rows, 57.8 MiB processed)[0m in 3.81s]
[0m01:04:24.302969 [debug] [Thread-1  ]: Finished running node model.dbt_test.basicquery
[0m01:04:24.303793 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m01:04:24.304847 [info ] [Thread-1  ]: 3 of 9 START sql table model dbt_test.customers ................................ [RUN]
[0m01:04:24.305857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.basicquery, now model.dbt_test.customers)
[0m01:04:24.306502 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m01:04:24.310270 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m01:04:24.312427 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m01:04:24.315914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:25.355070 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m01:04:25.357383 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m01:04:25.983649 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:e26732ed-8269-4401-b62d-5dfe820518f2&page=queryresults
[0m01:04:30.128339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf605d0190>]}
[0m01:04:30.130679 [info ] [Thread-1  ]: 3 of 9 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 5.82s]
[0m01:04:30.132288 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m01:04:30.133479 [debug] [Thread-1  ]: Began running node model.dbt_test.inventory_items
[0m01:04:30.134705 [info ] [Thread-1  ]: 4 of 9 START sql table model dbt_test.inventory_items .......................... [RUN]
[0m01:04:30.135931 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.inventory_items)
[0m01:04:30.136828 [debug] [Thread-1  ]: Began compiling node model.dbt_test.inventory_items
[0m01:04:30.142352 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.inventory_items"
[0m01:04:30.143250 [debug] [Thread-1  ]: Began executing node model.dbt_test.inventory_items
[0m01:04:30.147604 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.inventory_items"
[0m01:04:30.148517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:30.150526 [debug] [Thread-1  ]: On model.dbt_test.inventory_items: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.inventory_items"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`inventory_items`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.order_items`
    );
  
[0m01:04:31.046627 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:e7c1c286-3d12-4f08-a69c-6c5ea2c7c5a3&page=queryresults
[0m01:04:34.980824 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa9a4e4f0>]}
[0m01:04:34.982958 [info ] [Thread-1  ]: 4 of 9 OK created sql table model dbt_test.inventory_items ..................... [[32mCREATE TABLE (182.0k rows, 13.0 MiB processed)[0m in 4.85s]
[0m01:04:34.984746 [debug] [Thread-1  ]: Finished running node model.dbt_test.inventory_items
[0m01:04:34.986065 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m01:04:34.987365 [info ] [Thread-1  ]: 5 of 9 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m01:04:34.988570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.inventory_items, now model.dbt_test.my_first_dbt_model)
[0m01:04:34.989473 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m01:04:34.996850 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m01:04:34.998382 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m01:04:35.002463 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:36.070698 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m01:04:36.073122 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:04:36.718878 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:e36b3221-26f8-4914-bffa-2c4eb43bb23a&page=queryresults
[0m01:04:39.181496 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfab7c6ee0>]}
[0m01:04:39.183468 [info ] [Thread-1  ]: 5 of 9 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.19s]
[0m01:04:39.185296 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m01:04:39.186598 [debug] [Thread-1  ]: Began running node model.dbt_test.sales_product_category
[0m01:04:39.187792 [info ] [Thread-1  ]: 6 of 9 START sql table model dbt_test.sales_product_category ................... [RUN]
[0m01:04:39.189011 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.sales_product_category)
[0m01:04:39.189752 [debug] [Thread-1  ]: Began compiling node model.dbt_test.sales_product_category
[0m01:04:39.194069 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.sales_product_category"
[0m01:04:39.195243 [debug] [Thread-1  ]: Began executing node model.dbt_test.sales_product_category
[0m01:04:39.199170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:40.001337 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.sales_product_category"
[0m01:04:40.004227 [debug] [Thread-1  ]: On model.dbt_test.sales_product_category: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.sales_product_category"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`sales_product_category`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_category,
    -- ii.product_name,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_category,
    ii.product_name
ORDER BY 
    total_sales DESC
    );
  
[0m01:04:40.718856 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9be64530-081a-4538-8dfd-1571344050e3&page=queryresults
[0m01:04:44.208407 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfabb37f10>]}
[0m01:04:44.210339 [info ] [Thread-1  ]: 6 of 9 OK created sql table model dbt_test.sales_product_category .............. [[32mCREATE TABLE (28.4k rows, 37.4 MiB processed)[0m in 5.02s]
[0m01:04:44.211594 [debug] [Thread-1  ]: Finished running node model.dbt_test.sales_product_category
[0m01:04:44.212438 [debug] [Thread-1  ]: Began running node model.dbt_test.top_selling_products
[0m01:04:44.213481 [info ] [Thread-1  ]: 7 of 9 START sql table model dbt_test.top_selling_products ..................... [RUN]
[0m01:04:44.214500 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.sales_product_category, now model.dbt_test.top_selling_products)
[0m01:04:44.215246 [debug] [Thread-1  ]: Began compiling node model.dbt_test.top_selling_products
[0m01:04:44.222191 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.top_selling_products"
[0m01:04:44.223120 [debug] [Thread-1  ]: Began executing node model.dbt_test.top_selling_products
[0m01:04:44.226378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:45.015595 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.top_selling_products"
[0m01:04:45.019199 [debug] [Thread-1  ]: On model.dbt_test.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.top_selling_products"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`top_selling_products`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_name,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_name
ORDER BY 
    total_sales DESC
LIMIT 10
    );
  
[0m01:04:45.652798 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:a5548105-7a09-484c-9581-6990db7051a8&page=queryresults
[0m01:04:48.328557 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfabb2b280>]}
[0m01:04:48.330011 [info ] [Thread-1  ]: 7 of 9 OK created sql table model dbt_test.top_selling_products ................ [[32mCREATE TABLE (10.0 rows, 31.6 MiB processed)[0m in 4.11s]
[0m01:04:48.331225 [debug] [Thread-1  ]: Finished running node model.dbt_test.top_selling_products
[0m01:04:48.332067 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m01:04:48.333124 [info ] [Thread-1  ]: 8 of 9 START sql table model dbt_test.users .................................... [RUN]
[0m01:04:48.334118 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.top_selling_products, now model.dbt_test.users)
[0m01:04:48.334739 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m01:04:48.338826 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m01:04:48.340710 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m01:04:48.344187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:49.157112 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m01:04:49.159555 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`
    );
  
[0m01:04:49.831356 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:af44d7cf-e5f1-4c4a-916f-0da286f47fef&page=queryresults
[0m01:04:53.825299 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfabb2b280>]}
[0m01:04:53.827394 [info ] [Thread-1  ]: 8 of 9 OK created sql table model dbt_test.users ............................... [[32mCREATE TABLE (100.0k rows, 15.1 MiB processed)[0m in 5.49s]
[0m01:04:53.829042 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m01:04:53.830141 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m01:04:53.831286 [info ] [Thread-1  ]: 9 of 9 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m01:04:53.832649 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m01:04:53.833518 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m01:04:53.839641 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m01:04:53.840846 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m01:04:53.844903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:54.643007 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m01:04:54.645344 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m01:04:55.254512 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:be17a146-0407-45e9-b99f-a38684e6d5ca&page=queryresults
[0m01:04:57.921754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608ba160-0ccd-4635-996b-185ed52bbe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfabb2b280>]}
[0m01:04:57.923832 [info ] [Thread-1  ]: 9 of 9 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.09s]
[0m01:04:57.925595 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m01:04:57.928684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:57.929458 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m01:04:57.930531 [info ] [MainThread]: 
[0m01:04:57.931363 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 44.07 seconds (44.07s).
[0m01:04:57.934951 [debug] [MainThread]: Command end result
[0m01:04:57.979106 [info ] [MainThread]: 
[0m01:04:57.979691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:04:57.980086 [info ] [MainThread]: 
[0m01:04:57.980491 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:04:57.986826 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 46.51107, "process_user_time": 5.814273, "process_kernel_time": 0.501817, "process_mem_max_rss": "200323072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:04:57.987659 [debug] [MainThread]: Command `dbt run` succeeded at 01:04:57.987543 after 46.51 seconds
[0m01:04:57.988158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf602232e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa89b0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfab6cc820>]}
[0m01:04:57.988605 [debug] [MainThread]: Flushing usage events
[0m01:05:28.944013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9830cbb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98407b6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98407b64f0>]}


============================== 01:05:28.948908 | e1c53f9f-1225-424e-8f52-1fabb564d160 ==============================
[0m01:05:28.948908 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:05:28.949620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:05:29.941380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9840781400>]}
[0m01:05:29.996585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984143c1c0>]}
[0m01:05:29.997268 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m01:05:30.020472 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:05:30.192023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:05:30.192788 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/sales_product_category.sql
[0m01:05:30.445903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9833b56130>]}
[0m01:05:30.569459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9833b8f100>]}
[0m01:05:30.570044 [info ] [MainThread]: Found 9 models, 1 seed, 7 data tests, 471 macros
[0m01:05:30.570480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9833b56af0>]}
[0m01:05:30.572684 [info ] [MainThread]: 
[0m01:05:30.573334 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:05:30.578472 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m01:05:30.578967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:05:31.279221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m01:05:31.280844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:05:32.135837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9841469ca0>]}
[0m01:05:32.137930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:05:32.138836 [info ] [MainThread]: 
[0m01:05:32.144244 [debug] [Thread-1  ]: Began running node model.dbt_test.average_time_to_ship
[0m01:05:32.145516 [info ] [Thread-1  ]: 1 of 9 START sql table model dbt_test.average_time_to_ship ..................... [RUN]
[0m01:05:32.146724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.average_time_to_ship)
[0m01:05:32.147675 [debug] [Thread-1  ]: Began compiling node model.dbt_test.average_time_to_ship
[0m01:05:32.159492 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.average_time_to_ship"
[0m01:05:32.160502 [debug] [Thread-1  ]: Began executing node model.dbt_test.average_time_to_ship
[0m01:05:32.178529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:05:32.924156 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.average_time_to_ship"
[0m01:05:32.925159 [debug] [Thread-1  ]: On model.dbt_test.average_time_to_ship: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.average_time_to_ship"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`average_time_to_ship`
      
    
    

    OPTIONS()
    as (
      SELECT 
    AVG(TIMESTAMP_DIFF(shipped_at, created_at, HOUR)) AS avg_hours_to_ship
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items`
WHERE 
    status = 'Complete'
    AND shipped_at IS NOT NULL
    );
  
[0m01:05:33.656023 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:a3eab3c6-5d82-4b92-b050-4d1fe1b1acd3&page=queryresults
[0m01:05:35.966849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9841407b50>]}
[0m01:05:35.967786 [info ] [Thread-1  ]: 1 of 9 OK created sql table model dbt_test.average_time_to_ship ................ [[32mCREATE TABLE (1.0 rows, 4.1 MiB processed)[0m in 3.82s]
[0m01:05:35.968575 [debug] [Thread-1  ]: Finished running node model.dbt_test.average_time_to_ship
[0m01:05:35.969100 [debug] [Thread-1  ]: Began running node model.dbt_test.basicquery
[0m01:05:35.969757 [info ] [Thread-1  ]: 2 of 9 START sql table model dbt_test.basicquery ............................... [RUN]
[0m01:05:35.970384 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.average_time_to_ship, now model.dbt_test.basicquery)
[0m01:05:35.970836 [debug] [Thread-1  ]: Began compiling node model.dbt_test.basicquery
[0m01:05:35.973719 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.basicquery"
[0m01:05:35.974423 [debug] [Thread-1  ]: Began executing node model.dbt_test.basicquery
[0m01:05:35.977318 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:05:36.703167 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.basicquery"
[0m01:05:36.705954 [debug] [Thread-1  ]: On model.dbt_test.basicquery: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.basicquery"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`basicquery`
      
    
    

    OPTIONS()
    as (
      SELECT 
    oi.id AS order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.status,
    oi.created_at AS order_created_at,
    oi.sale_price,
    ii.product_name,
    ii.product_category,
    ii.product_brand,
    ii.cost AS product_cost,
    ii.product_retail_price,
    (oi.sale_price - ii.cost) AS profit
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
WHERE 
    oi.status = 'Complete'
    AND oi.created_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY)
ORDER BY 
    oi.created_at DESC
LIMIT 100
    );
  
[0m01:05:37.446006 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:932469e7-068b-44b5-9a6b-89da0a3f5c8c&page=queryresults
[0m01:05:40.005698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9841469ca0>]}
[0m01:05:40.006572 [info ] [Thread-1  ]: 2 of 9 OK created sql table model dbt_test.basicquery .......................... [[32mCREATE TABLE (100.0 rows, 57.8 MiB processed)[0m in 4.04s]
[0m01:05:40.007320 [debug] [Thread-1  ]: Finished running node model.dbt_test.basicquery
[0m01:05:40.007857 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m01:05:40.008539 [info ] [Thread-1  ]: 3 of 9 START sql table model dbt_test.customers ................................ [RUN]
[0m01:05:40.009254 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.basicquery, now model.dbt_test.customers)
[0m01:05:40.009756 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m01:05:40.012569 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m01:05:40.013303 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m01:05:40.016240 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:05:40.719129 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m01:05:40.720159 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m01:05:41.316191 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:6c012393-b886-4be0-882a-f7c4fb24828c&page=queryresults
[0m01:05:44.839933 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9833b56af0>]}
[0m01:05:44.842325 [info ] [Thread-1  ]: 3 of 9 OK created sql table model dbt_test.customers ........................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 4.83s]
[0m01:05:44.844284 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m01:05:44.845683 [debug] [Thread-1  ]: Began running node model.dbt_test.inventory_items
[0m01:05:44.846877 [info ] [Thread-1  ]: 4 of 9 START sql table model dbt_test.inventory_items .......................... [RUN]
[0m01:05:44.847963 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.inventory_items)
[0m01:05:44.848714 [debug] [Thread-1  ]: Began compiling node model.dbt_test.inventory_items
[0m01:05:44.854901 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.inventory_items"
[0m01:05:44.855706 [debug] [Thread-1  ]: Began executing node model.dbt_test.inventory_items
[0m01:05:44.858564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:05:45.741166 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.inventory_items"
[0m01:05:45.742656 [debug] [Thread-1  ]: On model.dbt_test.inventory_items: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.inventory_items"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`inventory_items`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.order_items`
    );
  
[0m01:05:46.349260 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:88764211-55bc-4d6f-ac77-bd7c104b024c&page=queryresults
[0m01:05:50.247120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9841469ca0>]}
[0m01:05:50.248923 [info ] [Thread-1  ]: 4 of 9 OK created sql table model dbt_test.inventory_items ..................... [[32mCREATE TABLE (182.0k rows, 13.0 MiB processed)[0m in 5.40s]
[0m01:05:50.250585 [debug] [Thread-1  ]: Finished running node model.dbt_test.inventory_items
[0m01:05:50.251818 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m01:05:50.252977 [info ] [Thread-1  ]: 5 of 9 START sql table model dbt_test.my_first_dbt_model ....................... [RUN]
[0m01:05:50.254019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.inventory_items, now model.dbt_test.my_first_dbt_model)
[0m01:05:50.255224 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m01:05:50.259980 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m01:05:50.260729 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m01:05:50.263723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:05:51.064585 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m01:05:51.066589 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:05:51.591838 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:ec8f3961-e66a-4fd0-a89b-b8e6e985d3d5&page=queryresults
[0m01:05:53.829179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9841a06d30>]}
[0m01:05:53.830042 [info ] [Thread-1  ]: 5 of 9 OK created sql table model dbt_test.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.58s]
[0m01:05:53.830776 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m01:05:53.831297 [debug] [Thread-1  ]: Began running node model.dbt_test.sales_product_category
[0m01:05:53.831931 [info ] [Thread-1  ]: 6 of 9 START sql table model dbt_test.sales_product_category ................... [RUN]
[0m01:05:53.832624 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.sales_product_category)
[0m01:05:53.833064 [debug] [Thread-1  ]: Began compiling node model.dbt_test.sales_product_category
[0m01:05:53.836046 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.sales_product_category"
[0m01:05:53.836874 [debug] [Thread-1  ]: Began executing node model.dbt_test.sales_product_category
[0m01:05:53.839712 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:05:54.612806 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.sales_product_category"
[0m01:05:54.614782 [debug] [Thread-1  ]: On model.dbt_test.sales_product_category: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.sales_product_category"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`sales_product_category`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_category,
    ii.product_name,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_category,
    ii.product_name
ORDER BY 
    total_sales DESC
    );
  
[0m01:05:55.360488 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:19e51f9e-9d41-4612-9513-4a285414be03&page=queryresults
[0m01:05:58.119590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9833b1a9d0>]}
[0m01:05:58.122257 [info ] [Thread-1  ]: 6 of 9 OK created sql table model dbt_test.sales_product_category .............. [[32mCREATE TABLE (28.4k rows, 37.4 MiB processed)[0m in 4.29s]
[0m01:05:58.123990 [debug] [Thread-1  ]: Finished running node model.dbt_test.sales_product_category
[0m01:05:58.125249 [debug] [Thread-1  ]: Began running node model.dbt_test.top_selling_products
[0m01:05:58.127283 [info ] [Thread-1  ]: 7 of 9 START sql table model dbt_test.top_selling_products ..................... [RUN]
[0m01:05:58.128784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.sales_product_category, now model.dbt_test.top_selling_products)
[0m01:05:58.129780 [debug] [Thread-1  ]: Began compiling node model.dbt_test.top_selling_products
[0m01:05:58.142743 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.top_selling_products"
[0m01:05:58.143754 [debug] [Thread-1  ]: Began executing node model.dbt_test.top_selling_products
[0m01:05:58.147017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:05:58.917891 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.top_selling_products"
[0m01:05:58.921958 [debug] [Thread-1  ]: On model.dbt_test.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.top_selling_products"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`top_selling_products`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_name,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_name
ORDER BY 
    total_sales DESC
LIMIT 10
    );
  
[0m01:05:59.667220 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:f3b0ed66-cf49-4c4f-92d0-6a5b18c20d46&page=queryresults
[0m01:06:02.558279 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9841407b50>]}
[0m01:06:02.559975 [info ] [Thread-1  ]: 7 of 9 OK created sql table model dbt_test.top_selling_products ................ [[32mCREATE TABLE (10.0 rows, 31.6 MiB processed)[0m in 4.43s]
[0m01:06:02.561447 [debug] [Thread-1  ]: Finished running node model.dbt_test.top_selling_products
[0m01:06:02.563450 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m01:06:02.564748 [info ] [Thread-1  ]: 8 of 9 START sql table model dbt_test.users .................................... [RUN]
[0m01:06:02.566367 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.top_selling_products, now model.dbt_test.users)
[0m01:06:02.567501 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m01:06:02.574392 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m01:06:02.578542 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m01:06:02.602371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:06:03.325340 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m01:06:03.327461 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`
    );
  
[0m01:06:03.947707 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:d5e94389-1073-4390-91de-30f586f7fbf9&page=queryresults
[0m01:06:08.269016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9833b56af0>]}
[0m01:06:08.270885 [info ] [Thread-1  ]: 8 of 9 OK created sql table model dbt_test.users ............................... [[32mCREATE TABLE (100.0k rows, 15.1 MiB processed)[0m in 5.70s]
[0m01:06:08.274441 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m01:06:08.277628 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m01:06:08.278922 [info ] [Thread-1  ]: 9 of 9 START sql table model dbt_test.my_second_dbt_model ...................... [RUN]
[0m01:06:08.282260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m01:06:08.283358 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m01:06:08.292341 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m01:06:08.295488 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m01:06:08.300398 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:06:09.009263 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m01:06:09.010959 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m01:06:09.609610 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:6641ba61-e9f8-4be8-b912-f661e6ca647b&page=queryresults
[0m01:06:11.986659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c53f9f-1225-424e-8f52-1fabb564d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98505c23d0>]}
[0m01:06:11.989405 [info ] [Thread-1  ]: 9 of 9 OK created sql table model dbt_test.my_second_dbt_model ................. [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 3.71s]
[0m01:06:11.991733 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m01:06:11.996307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:11.997176 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m01:06:11.999373 [info ] [MainThread]: 
[0m01:06:12.000426 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 41.42 seconds (41.42s).
[0m01:06:12.004725 [debug] [MainThread]: Command end result
[0m01:06:12.049760 [info ] [MainThread]: 
[0m01:06:12.050396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:06:12.050919 [info ] [MainThread]: 
[0m01:06:12.051423 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:06:12.056025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 43.190784, "process_user_time": 5.661214, "process_kernel_time": 0.339357, "process_mem_max_rss": "202481664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:06:12.056960 [debug] [MainThread]: Command `dbt run` succeeded at 01:06:12.056840 after 43.19 seconds
[0m01:06:12.057490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9830cbb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984143c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9831bce4f0>]}
[0m01:06:12.057949 [debug] [MainThread]: Flushing usage events
[0m01:17:23.342725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f091232e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f18866d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f18866400>]}


============================== 01:17:23.348364 | 6d2d2ddb-9403-4bb8-82bc-40c9b57ed189 ==============================
[0m01:17:23.348364 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:17:23.349100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:17:24.668067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f188272e0>]}
[0m01:17:24.724913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f190d1880>]}
[0m01:17:24.725632 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m01:17:24.759214 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:17:24.938261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:17:24.938940 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/order_items.sql
[0m01:17:25.200193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f192d4130>]}
[0m01:17:25.327506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f192e5580>]}
[0m01:17:25.328107 [info ] [MainThread]: Found 10 models, 1 seed, 7 data tests, 471 macros
[0m01:17:25.328541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f192dc850>]}
[0m01:17:25.330744 [info ] [MainThread]: 
[0m01:17:25.331424 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:17:25.336751 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m01:17:25.337373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:26.057891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m01:17:26.058897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:26.776986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0945a4c0>]}
[0m01:17:26.778634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:26.779332 [info ] [MainThread]: 
[0m01:17:26.784667 [debug] [Thread-1  ]: Began running node model.dbt_test.average_time_to_ship
[0m01:17:26.785738 [info ] [Thread-1  ]: 1 of 10 START sql table model dbt_test.average_time_to_ship .................... [RUN]
[0m01:17:26.786632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.average_time_to_ship)
[0m01:17:26.787278 [debug] [Thread-1  ]: Began compiling node model.dbt_test.average_time_to_ship
[0m01:17:26.799143 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.average_time_to_ship"
[0m01:17:26.799973 [debug] [Thread-1  ]: Began executing node model.dbt_test.average_time_to_ship
[0m01:17:26.819509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:27.631339 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.average_time_to_ship"
[0m01:17:27.632548 [debug] [Thread-1  ]: On model.dbt_test.average_time_to_ship: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.average_time_to_ship"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`average_time_to_ship`
      
    
    

    OPTIONS()
    as (
      SELECT 
    AVG(TIMESTAMP_DIFF(shipped_at, created_at, HOUR)) AS avg_hours_to_ship
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items`
WHERE 
    status = 'Complete'
    AND shipped_at IS NOT NULL
    );
  
[0m01:17:28.410372 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:09e6287c-3281-419d-a2d5-eda4fefbef29&page=queryresults
[0m01:17:30.910152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f190d6e50>]}
[0m01:17:30.911192 [info ] [Thread-1  ]: 1 of 10 OK created sql table model dbt_test.average_time_to_ship ............... [[32mCREATE TABLE (1.0 rows, 4.1 MiB processed)[0m in 4.12s]
[0m01:17:30.911990 [debug] [Thread-1  ]: Finished running node model.dbt_test.average_time_to_ship
[0m01:17:30.912520 [debug] [Thread-1  ]: Began running node model.dbt_test.basicquery
[0m01:17:30.913220 [info ] [Thread-1  ]: 2 of 10 START sql table model dbt_test.basicquery .............................. [RUN]
[0m01:17:30.913895 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.average_time_to_ship, now model.dbt_test.basicquery)
[0m01:17:30.914366 [debug] [Thread-1  ]: Began compiling node model.dbt_test.basicquery
[0m01:17:30.917245 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.basicquery"
[0m01:17:30.917969 [debug] [Thread-1  ]: Began executing node model.dbt_test.basicquery
[0m01:17:30.920869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:31.689961 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.basicquery"
[0m01:17:31.691793 [debug] [Thread-1  ]: On model.dbt_test.basicquery: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.basicquery"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`basicquery`
      
    
    

    OPTIONS()
    as (
      SELECT 
    oi.id AS order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.status,
    oi.created_at AS order_created_at,
    oi.sale_price,
    ii.product_name,
    ii.product_category,
    ii.product_brand,
    ii.cost AS product_cost,
    ii.product_retail_price,
    (oi.sale_price - ii.cost) AS profit
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
WHERE 
    oi.status = 'Complete'
    AND oi.created_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY)
ORDER BY 
    oi.created_at DESC
LIMIT 100
    );
  
[0m01:17:32.303553 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:15bd5e30-0934-4fab-8145-3c12800b92f4&page=queryresults
[0m01:17:35.034250 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1939ea30>]}
[0m01:17:35.037975 [info ] [Thread-1  ]: 2 of 10 OK created sql table model dbt_test.basicquery ......................... [[32mCREATE TABLE (100.0 rows, 57.8 MiB processed)[0m in 4.12s]
[0m01:17:35.040664 [debug] [Thread-1  ]: Finished running node model.dbt_test.basicquery
[0m01:17:35.042257 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m01:17:35.043981 [info ] [Thread-1  ]: 3 of 10 START sql table model dbt_test.customers ............................... [RUN]
[0m01:17:35.045359 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.basicquery, now model.dbt_test.customers)
[0m01:17:35.046468 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m01:17:35.053929 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m01:17:35.056565 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m01:17:35.062580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:35.889567 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m01:17:35.893969 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m01:17:36.547317 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:7a43aae4-36fd-4fd7-8909-333c6a662b22&page=queryresults
[0m01:17:40.397643 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ec849a3d0>]}
[0m01:17:40.400629 [info ] [Thread-1  ]: 3 of 10 OK created sql table model dbt_test.customers .......................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 5.35s]
[0m01:17:40.402663 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m01:17:40.404187 [debug] [Thread-1  ]: Began running node model.dbt_test.inventory_items
[0m01:17:40.405976 [info ] [Thread-1  ]: 4 of 10 START sql table model dbt_test.inventory_items ......................... [RUN]
[0m01:17:40.407543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.inventory_items)
[0m01:17:40.408596 [debug] [Thread-1  ]: Began compiling node model.dbt_test.inventory_items
[0m01:17:40.420898 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.inventory_items"
[0m01:17:40.422549 [debug] [Thread-1  ]: Began executing node model.dbt_test.inventory_items
[0m01:17:40.427685 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:41.099078 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.inventory_items"
[0m01:17:41.103119 [debug] [Thread-1  ]: On model.dbt_test.inventory_items: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.inventory_items"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`inventory_items`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.order_items`
    );
  
[0m01:17:41.824503 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:4ef55675-ccac-4d91-ab58-ed4682682b05&page=queryresults
[0m01:17:45.616542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1871a2e0>]}
[0m01:17:45.618666 [info ] [Thread-1  ]: 4 of 10 OK created sql table model dbt_test.inventory_items .................... [[32mCREATE TABLE (182.0k rows, 13.0 MiB processed)[0m in 5.21s]
[0m01:17:45.620145 [debug] [Thread-1  ]: Finished running node model.dbt_test.inventory_items
[0m01:17:45.621106 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m01:17:45.622316 [info ] [Thread-1  ]: 5 of 10 START sql table model dbt_test.my_first_dbt_model ...................... [RUN]
[0m01:17:45.623849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.inventory_items, now model.dbt_test.my_first_dbt_model)
[0m01:17:45.624850 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m01:17:45.634544 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m01:17:45.636982 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m01:17:45.642624 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:46.348227 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m01:17:46.351951 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:17:46.908944 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:bfc9f9ab-cf18-48ff-8232-1155694caae1&page=queryresults
[0m01:17:49.372911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1942f070>]}
[0m01:17:49.374513 [info ] [Thread-1  ]: 5 of 10 OK created sql table model dbt_test.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.75s]
[0m01:17:49.376200 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m01:17:49.377683 [debug] [Thread-1  ]: Began running node model.dbt_test.order_items
[0m01:17:49.379035 [info ] [Thread-1  ]: 6 of 10 START sql table model dbt_test.order_items ............................. [RUN]
[0m01:17:49.380345 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.order_items)
[0m01:17:49.381290 [debug] [Thread-1  ]: Began compiling node model.dbt_test.order_items
[0m01:17:49.386859 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.order_items"
[0m01:17:49.388147 [debug] [Thread-1  ]: Began executing node model.dbt_test.order_items
[0m01:17:49.393683 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.order_items"
[0m01:17:49.395111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:49.397964 [debug] [Thread-1  ]: On model.dbt_test.order_items: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.order_items"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`order_items`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.order_items`
    );
  
[0m01:17:50.530229 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:15b3f1fb-b4ed-407b-b075-28a9a0759f65&page=queryresults
[0m01:17:54.045714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1942f070>]}
[0m01:17:54.047658 [info ] [Thread-1  ]: 6 of 10 OK created sql table model dbt_test.order_items ........................ [[32mCREATE TABLE (182.0k rows, 13.0 MiB processed)[0m in 4.67s]
[0m01:17:54.049961 [debug] [Thread-1  ]: Finished running node model.dbt_test.order_items
[0m01:17:54.051520 [debug] [Thread-1  ]: Began running node model.dbt_test.sales_product_category
[0m01:17:54.053249 [info ] [Thread-1  ]: 7 of 10 START sql table model dbt_test.sales_product_category .................. [RUN]
[0m01:17:54.054529 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.order_items, now model.dbt_test.sales_product_category)
[0m01:17:54.055595 [debug] [Thread-1  ]: Began compiling node model.dbt_test.sales_product_category
[0m01:17:54.066980 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.sales_product_category"
[0m01:17:54.068571 [debug] [Thread-1  ]: Began executing node model.dbt_test.sales_product_category
[0m01:17:54.073742 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:54.758698 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.sales_product_category"
[0m01:17:54.762961 [debug] [Thread-1  ]: On model.dbt_test.sales_product_category: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.sales_product_category"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`sales_product_category`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_category,
    ii.product_name,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_category,
    ii.product_name
ORDER BY 
    total_sales DESC
    );
  
[0m01:17:55.399344 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:fa6807dc-8f30-49ed-a65f-53521cc0d696&page=queryresults
[0m01:17:58.116709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ec84d3820>]}
[0m01:17:58.119091 [info ] [Thread-1  ]: 7 of 10 OK created sql table model dbt_test.sales_product_category ............. [[32mCREATE TABLE (28.4k rows, 37.4 MiB processed)[0m in 4.06s]
[0m01:17:58.120638 [debug] [Thread-1  ]: Finished running node model.dbt_test.sales_product_category
[0m01:17:58.121784 [debug] [Thread-1  ]: Began running node model.dbt_test.top_selling_products
[0m01:17:58.123091 [info ] [Thread-1  ]: 8 of 10 START sql table model dbt_test.top_selling_products .................... [RUN]
[0m01:17:58.124328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.sales_product_category, now model.dbt_test.top_selling_products)
[0m01:17:58.125294 [debug] [Thread-1  ]: Began compiling node model.dbt_test.top_selling_products
[0m01:17:58.132798 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.top_selling_products"
[0m01:17:58.134462 [debug] [Thread-1  ]: Began executing node model.dbt_test.top_selling_products
[0m01:17:58.139633 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:58.844580 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.top_selling_products"
[0m01:17:58.847704 [debug] [Thread-1  ]: On model.dbt_test.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.top_selling_products"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`top_selling_products`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_name,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_name
ORDER BY 
    total_sales DESC
LIMIT 10
    );
  
[0m01:17:59.434492 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:564516a0-cbac-4598-8a25-e842243e68cb&page=queryresults
[0m01:18:02.512478 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ec84d3820>]}
[0m01:18:02.515362 [info ] [Thread-1  ]: 8 of 10 OK created sql table model dbt_test.top_selling_products ............... [[32mCREATE TABLE (10.0 rows, 31.6 MiB processed)[0m in 4.39s]
[0m01:18:02.517389 [debug] [Thread-1  ]: Finished running node model.dbt_test.top_selling_products
[0m01:18:02.518723 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m01:18:02.520084 [info ] [Thread-1  ]: 9 of 10 START sql table model dbt_test.users ................................... [RUN]
[0m01:18:02.521340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.top_selling_products, now model.dbt_test.users)
[0m01:18:02.522364 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m01:18:02.530502 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m01:18:02.531698 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m01:18:02.536159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:18:03.440887 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m01:18:03.444729 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`
    );
  
[0m01:18:04.002324 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:886dcff9-3ff9-4757-8a72-00c50ef6d1ab&page=queryresults
[0m01:18:07.495056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f193bec10>]}
[0m01:18:07.497169 [info ] [Thread-1  ]: 9 of 10 OK created sql table model dbt_test.users .............................. [[32mCREATE TABLE (100.0k rows, 15.1 MiB processed)[0m in 4.97s]
[0m01:18:07.499329 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m01:18:07.500626 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m01:18:07.502047 [info ] [Thread-1  ]: 10 of 10 START sql table model dbt_test.my_second_dbt_model .................... [RUN]
[0m01:18:07.507335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m01:18:07.508668 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m01:18:07.516947 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m01:18:07.518656 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m01:18:07.523877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:18:08.349174 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m01:18:08.352989 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m01:18:09.062109 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:c33615c2-70b7-4d1b-8677-0749bd1c55dc&page=queryresults
[0m01:18:11.628203 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2d2ddb-9403-4bb8-82bc-40c9b57ed189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ec84c8ca0>]}
[0m01:18:11.630559 [info ] [Thread-1  ]: 10 of 10 OK created sql table model dbt_test.my_second_dbt_model ............... [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.12s]
[0m01:18:11.631940 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m01:18:11.634498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:11.635282 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m01:18:11.636196 [info ] [MainThread]: 
[0m01:18:11.637044 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 46.30 seconds (46.30s).
[0m01:18:11.642172 [debug] [MainThread]: Command end result
[0m01:18:11.688641 [info ] [MainThread]: 
[0m01:18:11.689267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:11.689682 [info ] [MainThread]: 
[0m01:18:11.690095 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:18:11.692500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 48.44594, "process_user_time": 6.103409, "process_kernel_time": 0.48701, "process_mem_max_rss": "200314880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:18:11.693308 [debug] [MainThread]: Command `dbt run` succeeded at 01:18:11.693193 after 48.45 seconds
[0m01:18:11.693803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f091232e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0c057610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f191b2280>]}
[0m01:18:11.694262 [debug] [MainThread]: Flushing usage events
[0m01:32:04.843684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88fcb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a306d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a306400>]}


============================== 01:32:04.849012 | 8328a3e8-57a5-46c1-8897-650db628aea0 ==============================
[0m01:32:04.849012 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:32:04.849724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tszeyenthen/dbt-test/dbt_test/logs', 'debug': 'False', 'profiles_dir': '/Users/tszeyenthen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:32:06.140321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd89291ca0>]}
[0m01:32:06.199685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a13ec70>]}
[0m01:32:06.200524 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m01:32:06.232096 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:32:06.429912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:32:06.430697 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/inventory_items.sql
[0m01:32:06.693959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c176130>]}
[0m01:32:06.821930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c175040>]}
[0m01:32:06.822594 [info ] [MainThread]: Found 10 models, 1 seed, 7 data tests, 471 macros
[0m01:32:06.823028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c189d00>]}
[0m01:32:06.825223 [info ] [MainThread]: 
[0m01:32:06.825975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:32:06.831409 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-test-427409'
[0m01:32:06.832045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:07.628555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-test-427409, now list_dbt-test-427409_dbt_test)
[0m01:32:07.630704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:08.423271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c175070>]}
[0m01:32:08.425356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:32:08.426882 [info ] [MainThread]: 
[0m01:32:08.432033 [debug] [Thread-1  ]: Began running node model.dbt_test.average_time_to_ship
[0m01:32:08.433411 [info ] [Thread-1  ]: 1 of 10 START sql table model dbt_test.average_time_to_ship .................... [RUN]
[0m01:32:08.434692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt-test-427409_dbt_test, now model.dbt_test.average_time_to_ship)
[0m01:32:08.435713 [debug] [Thread-1  ]: Began compiling node model.dbt_test.average_time_to_ship
[0m01:32:08.450808 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.average_time_to_ship"
[0m01:32:08.452087 [debug] [Thread-1  ]: Began executing node model.dbt_test.average_time_to_ship
[0m01:32:08.475416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:32:09.162936 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.average_time_to_ship"
[0m01:32:09.164203 [debug] [Thread-1  ]: On model.dbt_test.average_time_to_ship: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.average_time_to_ship"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`average_time_to_ship`
      
    
    

    OPTIONS()
    as (
      SELECT 
    AVG(TIMESTAMP_DIFF(shipped_at, created_at, HOUR)) AS avg_hours_to_ship
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items`
WHERE 
    status = 'Complete'
    AND shipped_at IS NOT NULL
    );
  
[0m01:32:09.872985 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:0efebe9e-dcc8-4303-b241-401ca56a4caf&page=queryresults
[0m01:32:12.569172 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8b81fb80>]}
[0m01:32:12.570208 [info ] [Thread-1  ]: 1 of 10 OK created sql table model dbt_test.average_time_to_ship ............... [[32mCREATE TABLE (1.0 rows, 4.1 MiB processed)[0m in 4.13s]
[0m01:32:12.571021 [debug] [Thread-1  ]: Finished running node model.dbt_test.average_time_to_ship
[0m01:32:12.571581 [debug] [Thread-1  ]: Began running node model.dbt_test.basicquery
[0m01:32:12.572256 [info ] [Thread-1  ]: 2 of 10 START sql table model dbt_test.basicquery .............................. [RUN]
[0m01:32:12.572892 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.average_time_to_ship, now model.dbt_test.basicquery)
[0m01:32:12.573355 [debug] [Thread-1  ]: Began compiling node model.dbt_test.basicquery
[0m01:32:12.576367 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.basicquery"
[0m01:32:12.578107 [debug] [Thread-1  ]: Began executing node model.dbt_test.basicquery
[0m01:32:12.581131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:32:13.459984 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.basicquery"
[0m01:32:13.462765 [debug] [Thread-1  ]: On model.dbt_test.basicquery: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.basicquery"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`basicquery`
      
    
    

    OPTIONS()
    as (
      SELECT 
    oi.id AS order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    oi.status,
    oi.created_at AS order_created_at,
    oi.sale_price,
    ii.product_name,
    ii.product_category,
    ii.product_brand,
    ii.cost AS product_cost,
    ii.product_retail_price,
    (oi.sale_price - ii.cost) AS profit
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
WHERE 
    oi.status = 'Complete'
    AND oi.created_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY)
ORDER BY 
    oi.created_at DESC
LIMIT 100
    );
  
[0m01:32:14.030096 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:d7e8f244-eaf2-4d57-a7a0-9a06bac52a93&page=queryresults
[0m01:32:16.633346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c1bf6d0>]}
[0m01:32:16.635528 [info ] [Thread-1  ]: 2 of 10 OK created sql table model dbt_test.basicquery ......................... [[32mCREATE TABLE (100.0 rows, 57.8 MiB processed)[0m in 4.06s]
[0m01:32:16.636850 [debug] [Thread-1  ]: Finished running node model.dbt_test.basicquery
[0m01:32:16.637788 [debug] [Thread-1  ]: Began running node model.dbt_test.customers
[0m01:32:16.639259 [info ] [Thread-1  ]: 3 of 10 START sql table model dbt_test.customers ............................... [RUN]
[0m01:32:16.640445 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.basicquery, now model.dbt_test.customers)
[0m01:32:16.641232 [debug] [Thread-1  ]: Began compiling node model.dbt_test.customers
[0m01:32:16.646273 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.customers"
[0m01:32:16.648389 [debug] [Thread-1  ]: Began executing node model.dbt_test.customers
[0m01:32:16.652772 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:32:17.555345 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.customers"
[0m01:32:17.558028 [debug] [Thread-1  ]: On model.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.customers"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select id,
        first_name,
        last_name
    from `bigquery-public-data.thelook_ecommerce.users`
),

orders as (
    select order_id,
        user_id,
        created_at,
        status
    from `bigquery-public-data.thelook_ecommerce.orders`
),

customer_orders as (
    select user_id,
        min(created_at) as first_order,
        max(created_at) as most_recent_order,
        count(order_id) as number_of_orders
    from orders
    group by user_id
),

final as (
    select
        customers.id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders
    from customers
    left join customer_orders
    on customers.id = customer_orders.user_id
)

select * from final
    );
  
[0m01:32:18.177601 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:06a371d2-7bf1-490c-b6be-545c2d540caf&page=queryresults
[0m01:32:21.470464 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c226430>]}
[0m01:32:21.472326 [info ] [Thread-1  ]: 3 of 10 OK created sql table model dbt_test.customers .......................... [[32mCREATE TABLE (100.0k rows, 5.2 MiB processed)[0m in 4.83s]
[0m01:32:21.473869 [debug] [Thread-1  ]: Finished running node model.dbt_test.customers
[0m01:32:21.475215 [debug] [Thread-1  ]: Began running node model.dbt_test.inventory_items
[0m01:32:21.476990 [info ] [Thread-1  ]: 4 of 10 START sql table model dbt_test.inventory_items ......................... [RUN]
[0m01:32:21.478809 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.customers, now model.dbt_test.inventory_items)
[0m01:32:21.479871 [debug] [Thread-1  ]: Began compiling node model.dbt_test.inventory_items
[0m01:32:21.488493 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.inventory_items"
[0m01:32:21.489576 [debug] [Thread-1  ]: Began executing node model.dbt_test.inventory_items
[0m01:32:21.492683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:32:22.210612 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.inventory_items"
[0m01:32:22.213690 [debug] [Thread-1  ]: On model.dbt_test.inventory_items: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.inventory_items"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`inventory_items`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.inventory_items`
    );
  
[0m01:32:22.720944 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:997551fc-204a-43f3-9bb6-cfae40858955&page=queryresults
[0m01:32:29.656358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd480a99a0>]}
[0m01:32:29.659351 [info ] [Thread-1  ]: 4 of 10 OK created sql table model dbt_test.inventory_items .................... [[32mCREATE TABLE (491.2k rows, 77.7 MiB processed)[0m in 8.18s]
[0m01:32:29.662165 [debug] [Thread-1  ]: Finished running node model.dbt_test.inventory_items
[0m01:32:29.664267 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m01:32:29.666259 [info ] [Thread-1  ]: 5 of 10 START sql table model dbt_test.my_first_dbt_model ...................... [RUN]
[0m01:32:29.668416 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.inventory_items, now model.dbt_test.my_first_dbt_model)
[0m01:32:29.669693 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m01:32:29.679939 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m01:32:29.681555 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m01:32:29.686639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:32:30.562123 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m01:32:30.566630 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:32:31.124855 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:f7652e3a-d440-4612-bb28-fb12f6c6d8b8&page=queryresults
[0m01:32:33.382898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c213250>]}
[0m01:32:33.385781 [info ] [Thread-1  ]: 5 of 10 OK created sql table model dbt_test.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.71s]
[0m01:32:33.387717 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m01:32:33.389665 [debug] [Thread-1  ]: Began running node model.dbt_test.order_items
[0m01:32:33.391627 [info ] [Thread-1  ]: 6 of 10 START sql table model dbt_test.order_items ............................. [RUN]
[0m01:32:33.393387 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.order_items)
[0m01:32:33.394365 [debug] [Thread-1  ]: Began compiling node model.dbt_test.order_items
[0m01:32:33.401082 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.order_items"
[0m01:32:33.402504 [debug] [Thread-1  ]: Began executing node model.dbt_test.order_items
[0m01:32:33.407355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:32:34.122340 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.order_items"
[0m01:32:34.123883 [debug] [Thread-1  ]: On model.dbt_test.order_items: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.order_items"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`order_items`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.order_items`
    );
  
[0m01:32:35.183013 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:73bbee6a-eaf2-4ba0-8f93-c8f72a807544&page=queryresults
[0m01:32:38.654349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c25fee0>]}
[0m01:32:38.656897 [info ] [Thread-1  ]: 6 of 10 OK created sql table model dbt_test.order_items ........................ [[32mCREATE TABLE (182.0k rows, 13.0 MiB processed)[0m in 5.26s]
[0m01:32:38.658451 [debug] [Thread-1  ]: Finished running node model.dbt_test.order_items
[0m01:32:38.659540 [debug] [Thread-1  ]: Began running node model.dbt_test.sales_product_category
[0m01:32:38.660720 [info ] [Thread-1  ]: 7 of 10 START sql table model dbt_test.sales_product_category .................. [RUN]
[0m01:32:38.661776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.order_items, now model.dbt_test.sales_product_category)
[0m01:32:38.662569 [debug] [Thread-1  ]: Began compiling node model.dbt_test.sales_product_category
[0m01:32:38.670329 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.sales_product_category"
[0m01:32:38.671202 [debug] [Thread-1  ]: Began executing node model.dbt_test.sales_product_category
[0m01:32:38.674482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:32:39.350917 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.sales_product_category"
[0m01:32:39.354113 [debug] [Thread-1  ]: On model.dbt_test.sales_product_category: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.sales_product_category"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`sales_product_category`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_category,
    ii.product_name,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_category,
    ii.product_name
ORDER BY 
    total_sales DESC
    );
  
[0m01:32:40.083191 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:cf5e7711-f90b-45ce-9eec-ad8ade7dd0ff&page=queryresults
[0m01:32:42.947431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c25fee0>]}
[0m01:32:42.949753 [info ] [Thread-1  ]: 7 of 10 OK created sql table model dbt_test.sales_product_category ............. [[32mCREATE TABLE (28.4k rows, 37.4 MiB processed)[0m in 4.29s]
[0m01:32:42.953373 [debug] [Thread-1  ]: Finished running node model.dbt_test.sales_product_category
[0m01:32:42.955360 [debug] [Thread-1  ]: Began running node model.dbt_test.top_selling_products
[0m01:32:42.957484 [info ] [Thread-1  ]: 8 of 10 START sql table model dbt_test.top_selling_products .................... [RUN]
[0m01:32:42.959267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.sales_product_category, now model.dbt_test.top_selling_products)
[0m01:32:42.960535 [debug] [Thread-1  ]: Began compiling node model.dbt_test.top_selling_products
[0m01:32:42.968774 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.top_selling_products"
[0m01:32:42.970286 [debug] [Thread-1  ]: Began executing node model.dbt_test.top_selling_products
[0m01:32:42.975608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:32:43.640581 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.top_selling_products"
[0m01:32:43.644576 [debug] [Thread-1  ]: On model.dbt_test.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.top_selling_products"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`top_selling_products`
      
    
    

    OPTIONS()
    as (
      SELECT 
    ii.product_name,
    COUNT(oi.id) AS total_orders,
    SUM(oi.sale_price) AS total_sales
FROM 
    `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN 
    `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
GROUP BY 
    ii.product_name
ORDER BY 
    total_sales DESC
LIMIT 10
    );
  
[0m01:32:44.254694 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:279ad6a6-ae3c-4151-b137-398a7ce0fd0c&page=queryresults
[0m01:32:47.112437 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c25fee0>]}
[0m01:32:47.114973 [info ] [Thread-1  ]: 8 of 10 OK created sql table model dbt_test.top_selling_products ............... [[32mCREATE TABLE (10.0 rows, 31.6 MiB processed)[0m in 4.15s]
[0m01:32:47.117263 [debug] [Thread-1  ]: Finished running node model.dbt_test.top_selling_products
[0m01:32:47.118365 [debug] [Thread-1  ]: Began running node model.dbt_test.users
[0m01:32:47.119543 [info ] [Thread-1  ]: 9 of 10 START sql table model dbt_test.users ................................... [RUN]
[0m01:32:47.121310 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.top_selling_products, now model.dbt_test.users)
[0m01:32:47.122310 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users
[0m01:32:47.129608 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users"
[0m01:32:47.131797 [debug] [Thread-1  ]: Began executing node model.dbt_test.users
[0m01:32:47.137829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:32:48.144916 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users"
[0m01:32:48.147433 [debug] [Thread-1  ]: On model.dbt_test.users: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`users`
      
    
    

    OPTIONS()
    as (
      SELECT *
FROM `bigquery-public-data.thelook_ecommerce.users`
    );
  
[0m01:32:48.758023 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:88417e32-3486-4e39-8786-310f6690af6a&page=queryresults
[0m01:32:51.696624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c25fee0>]}
[0m01:32:51.699017 [info ] [Thread-1  ]: 9 of 10 OK created sql table model dbt_test.users .............................. [[32mCREATE TABLE (100.0k rows, 15.1 MiB processed)[0m in 4.58s]
[0m01:32:51.703617 [debug] [Thread-1  ]: Finished running node model.dbt_test.users
[0m01:32:51.705578 [debug] [Thread-1  ]: Began running node model.dbt_test.my_second_dbt_model
[0m01:32:51.707524 [info ] [Thread-1  ]: 10 of 10 START sql table model dbt_test.my_second_dbt_model .................... [RUN]
[0m01:32:51.709818 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_test.users, now model.dbt_test.my_second_dbt_model)
[0m01:32:51.711087 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m01:32:51.721524 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m01:32:51.723262 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m01:32:51.728558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:32:52.477797 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m01:32:52.480957 [debug] [Thread-1  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  
    

    create or replace table `dbt-test-427409`.`dbt_test`.`my_second_dbt_model`
      
    
    

    OPTIONS()
    as (
      -- Use the `ref` function to select from other models

select *
from `dbt-test-427409`.`dbt_test`.`my_first_dbt_model`
where id = 1
    );
  
[0m01:32:53.167456 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-test-427409&j=bq:US:9a016a7d-1f84-4864-9ab1-1b4718f7c4bd&page=queryresults
[0m01:32:55.746597 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8328a3e8-57a5-46c1-8897-650db628aea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd68e34be0>]}
[0m01:32:55.747496 [info ] [Thread-1  ]: 10 of 10 OK created sql table model dbt_test.my_second_dbt_model ............... [[32mCREATE TABLE (1.0 rows, 8.0 Bytes processed)[0m in 4.04s]
[0m01:32:55.748272 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m01:32:55.749762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:55.750244 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m01:32:55.750747 [info ] [MainThread]: 
[0m01:32:55.751231 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 48.92 seconds (48.92s).
[0m01:32:55.753713 [debug] [MainThread]: Command end result
[0m01:32:55.797375 [info ] [MainThread]: 
[0m01:32:55.797971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:32:55.798373 [info ] [MainThread]: 
[0m01:32:55.798774 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:32:55.801379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 51.05382, "process_user_time": 6.170031, "process_kernel_time": 0.46583, "process_mem_max_rss": "200704000", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:32:55.802096 [debug] [MainThread]: Command `dbt run` succeeded at 01:32:55.801991 after 51.05 seconds
[0m01:32:55.802561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88fcb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c175040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd893c56a0>]}
[0m01:32:55.803005 [debug] [MainThread]: Flushing usage events
